<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>AutoJS | wenke</title><meta name="keywords" content="autojs"><meta name="author" content="wenke"><meta name="copyright" content="wenke"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="autojspro基于控件控件属性className 类名。类名表示一个控件的类型packageName 包名。包名表示控件所在的应用包名bounds 控件在屏幕上的范围。drawingOrder 控件在父控件的绘制顺序。indexInParent 控件在父控件的位置。clickable 控件是否可点击。longClickable 控件是否可长按。checkable 控件是否可勾选。checked">
<meta property="og:type" content="article">
<meta property="og:title" content="AutoJS">
<meta property="og:url" content="https://wenkex.gitee.io/2022/010827358.html">
<meta property="og:site_name" content="wenke">
<meta property="og:description" content="autojspro基于控件控件属性className 类名。类名表示一个控件的类型packageName 包名。包名表示控件所在的应用包名bounds 控件在屏幕上的范围。drawingOrder 控件在父控件的绘制顺序。indexInParent 控件在父控件的位置。clickable 控件是否可点击。longClickable 控件是否可长按。checkable 控件是否可勾选。checked">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/wenkex/blogimage/raw/master/infinity-3610308.jpg">
<meta property="article:published_time" content="2022-01-08T09:17:39.000Z">
<meta property="article:modified_time" content="2022-01-08T09:17:39.000Z">
<meta property="article:author" content="wenke">
<meta property="article:tag" content="autojs">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/wenkex/blogimage/raw/master/infinity-3610308.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://wenkex.gitee.io/2022/010827358"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?d103aef22d2746c3d56e2dae461c4699";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="stylesheet" href="/wenke" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"距离上次更新已经过了","messageNext":"天， 文章内容可能已过期，请留意"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":1000,"languages":{"author":"作者: wenke","link":"链接: ","source":"来源: wenke","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'AutoJS',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-01-08 17:17:39'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.0.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="wenke" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://gitee.com/wenkex/blogimage/raw/master/favicon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">35</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">31</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-book-open"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/box/"><i class="fa-fw fas fa-tags"></i><span> 聚合</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-heart"></i><span> 相册</span></a></div><div class="menus_item"><a class="site-page" href="/contact/"><i class="fa-fw fas fa-list"></i><span> 留言板</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://gitee.com/wenkex/blogimage/raw/master/infinity-3610308.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">wenke</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-book-open"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/box/"><i class="fa-fw fas fa-tags"></i><span> 聚合</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-heart"></i><span> 相册</span></a></div><div class="menus_item"><a class="site-page" href="/contact/"><i class="fa-fw fas fa-list"></i><span> 留言板</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">AutoJS</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-01-08T09:17:39.000Z" title="发表于 2022-01-08 17:17:39">2022-01-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-01-08T09:17:39.000Z" title="更新于 2022-01-08 17:17:39">2022-01-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%87%AA%E5%8A%A8%E5%8C%96/">自动化</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">26.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>104分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="AutoJS"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="autojspro"><a href="#autojspro" class="headerlink" title="autojspro"></a>autojspro</h1><h1 id="基于控件"><a href="#基于控件" class="headerlink" title="基于控件"></a>基于控件</h1><h2 id="控件属性"><a href="#控件属性" class="headerlink" title="控件属性"></a>控件属性</h2><p>className 类名。类名表示一个控件的类型<br>packageName 包名。包名表示控件所在的应用包名<br>bounds 控件在屏幕上的范围。<br>drawingOrder 控件在父控件的绘制顺序。<br>indexInParent 控件在父控件的位置。<br>clickable 控件是否可点击。<br>longClickable 控件是否可长按。<br>checkable 控件是否可勾选。<br>checked 控件是否可已勾选。<br>scrollable 控件是否可滑动。<br>selected 控件是否已选择。<br>editable 控件是否可编辑。<br>visibleToUser 控件是否可见。<br>enabled 控件是否已启用。<br>depth 控件的布局深度。<br>fullId:    app包名:id/对应的id名称  ，内容一样要写在id里，例如id(“fullld的内容”)</p>
<h2 id="UiSelector控件选择器"><a href="#UiSelector控件选择器" class="headerlink" title="UiSelector控件选择器"></a>UiSelector控件选择器</h2><p>我们使用UiSelector选择器筛选出所需要的控件，筛选的依据就是通过控件的各种属性选取屏幕上的控件<br>通常用一个唯一的属性来定位一个控件<br>depth-desc-id-classname等控件的常规的唯一属性<br>findone.parent().child(xx)等控件的父子依存顺序关系</p>
<h3 id="findOne-timeout"><a href="#findOne-timeout" class="headerlink" title=".findOne(timeout)"></a>.findOne(timeout)</h3><p>根据当前的选择器所确定的筛选条件，对屏幕上的控件进行搜索，直到屏幕上出现满足条件的一个控件为止，并返回该控件；如果在timeout毫秒的时间内没有找到符合条件的控件，则终止搜索并返回null。</p>
<h3 id="find"><a href="#find" class="headerlink" title=".find()"></a>.find()</h3><p>找到所有满足条件的控件集合并返回。这个搜索只进行一次，并不保证一定会找到，因而会出现返回的控件集合为空的情况</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 可以通过empty()函数判断找到的是否为空。例如：</span></span><br><span class="line"><span class="keyword">var</span> c = className(<span class="string">"AbsListView"</span>).find();</span><br><span class="line"><span class="keyword">if</span>(!c.empty()){</span><br><span class="line">    toast(<span class="string">"找到啦"</span>);</span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line">    toast(<span class="string">"没找到╭(╯^╰)╮"</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="findOnce-i"><a href="#findOnce-i" class="headerlink" title=".findOnce(i)"></a>.findOnce(i)</h3><p>.untilFind()<br> .exists()<br>.waitFor()<br>.filter(f)</p>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>algorithm(algorithm)  指定选择器的搜索算法。 广度优先在控件所在层次较低时，或者布局的层次不多时，通常能更快找到控件</p>
<p>(text,desc,id,className,packageName)都可以像下面一样创建选择器<br>textContains(str)  “text需要包含字符串str”的筛选条件。<br>textStartsWith(prefix)<br>textEndsWith(suffix)<br>textMatches(reg)</p>
<p>UiSelector.untilFind()<br>UiSelector.exists()<br>UiSelector.waitFor()</p>
<h3 id="UiSelector-filter-f"><a href="#UiSelector-filter-f" class="headerlink" title="UiSelector.filter(f)"></a>UiSelector.filter(f)</h3><p>f {Function} 过滤函数，参数为UiObject，返回值为boolean<br>为当前选择器附加自定义的过滤条件。</p>
<h2 id="UiObject控件对象"><a href="#UiObject控件对象" class="headerlink" title="UiObject控件对象"></a>UiObject控件对象</h2><p>UiObject表示一个控件，可以通过这个对象获取到控件的属性，也可以对控件进行点击、长按等操作。</p>
<p>获取一个UiObject通常通过选择器的findOne(), findOnce()等函数，也可以通过UiCollection来获取，或者通过UiObject.child(), UiObject.parent()等函数来获取一个控件的子控件或父控件。</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">text("微信").findOne()  //返回一个控件对象，想要操作这个控件，其属性必须为true</span><br></pre></td></tr></tbody></table></figure>


<p>click(text[, i])<br>text {string} 要点击的文本<br>i {number} 如果相同的文本在屏幕中出现多次，则i表示要点击第几个文本, i从0开始计算</p>
<p>click() 点击。点击一个控件，前提是这个控件的clickable属性为true<br>longClick() 长按。长按一个控件，前提是这个控件的longClickable属性为true<br>setText() 设置文本，用于编辑框控件设置文本。<br>scrollForward();<br>scrollBackward() 滑动。滑动一个控件(列表等), 前提是这个控件的scrollable属性为true<br>exits() 判断控件是否存在<br>waitFor() 等待控件出现</p>
<h3 id="bounds-坐标"><a href="#bounds-坐标" class="headerlink" title="bounds()坐标"></a>bounds()坐标</h3><p>返回控件在屏幕上的范围，其值是一个Rect对象。</p>
<p>如果一个控件本身无法通过click()点击，那么我们可以利用bounds()函数获取其坐标，再利用坐标点击。总体来说，基于坐标来确定要操作的控件比较简单，核心是确定要操作的控件的坐标即可。Auto.JS里可以直接获取控件的坐标，每一个控件包含其“.bounds()”属性，bounds()其实表示的是一个范围矩阵。此处还是以右下角的“+”号按钮为例，查看控件属性信息，包含“.bounds()”属性如下图：</p>
<p>bounds()属性是四个坐标值，其分别为(left, top, right, buttom)<br>    left：控件左边缘与屏幕左边的距离<br>    top：控件上边缘与屏幕上边的距离<br>    right：控件右边缘与屏幕左边的距离<br>    buttom ： 控件下边缘与屏幕上边的距离</p>
<p>因此，在获得控件的坐标bounds()属性后，就可以对控件执行基于坐标的操作，常见的操作有：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">bounds().left：长方形左边界的x坐标</span><br><span class="line">bounds().right：长方形右边界的x坐标</span><br><span class="line">bounds().top：长方形上边界的y坐标</span><br><span class="line">bounds().bottom：长方形下边界的y坐标</span><br><span class="line">bounds().centerX()：长方形中点x坐标</span><br><span class="line">bounds().centerY()：长方形中点y坐标</span><br><span class="line">bounds().width()：长方形宽度也就是控件宽度</span><br><span class="line">bounds().height()：长方形高度也就是控件高度</span><br><span class="line">click(x,y)：坐标(x,y)处执行点击操作  <span class="comment">//注意:安卓7以下点击需要root权限且函数为Tap(x,y)</span></span><br><span class="line">bounds(left, right, top, bottom).clickable().click()：点击该长方形区域</span><br></pre></td></tr></tbody></table></figure>









<h2 id="基于控件属性确定控件"><a href="#基于控件属性确定控件" class="headerlink" title="基于控件属性确定控件"></a>基于控件属性确定控件</h2><p>通过查看这些属性，我们不难发现有其中一项属性desc(“更多选项”)，很可能是不和其他控件相同的，也就是此控件属性具有唯一性，能唯一的确定此控件，这个属性就是我们要找的。因此，我们想要对其进行操作只需要：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(desc(<span class="string">"更多选项"</span>).exists())</span><br><span class="line">{</span><br><span class="line">    sleep(<span class="number">1000</span>);</span><br><span class="line">    desc(<span class="string">"更多选项"</span>).findonce().click();    </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>上述代码执行后，在该界面时，desc(“更多选项”)首先会被查找(findonce)，查找后执行点击(click)，从而【⋮】按钮也就被点击了。总结下无非就是我们找到了此按钮的唯一控件属性desc(“更多选项”)从而再对其操作，仅此而已。</p>
<p>另外，加上“.exist()”是为了增加程序鲁棒性，万一控件不存在或者没找到，则程序不会执行，否则对不存在(或没找到)的控件操作会抛出异常。基于此，往往要判定控件存在与否后再进行操作，而“.exist()”返回的是一个布尔值，方便后续进行判断和操作。另外一个常用的操作就是加上“while(!)”死循环等待控件出现，如：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//当"更多选项"不存在等价于此按钮还没出现</span></span><br><span class="line"><span class="keyword">while</span>(!desc(<span class="string">"更多选项"</span>).exists())</span><br><span class="line">{</span><br><span class="line">    <span class="comment">//继续循环等待，直到按钮出现</span></span><br><span class="line">    sleep(<span class="number">1000</span>);</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">//执行到这里说明"更多选项"存在了，对该按钮执行点击操作</span></span><br><span class="line">desc(<span class="string">"更多选项"</span>).findonce().click();</span><br><span class="line"><span class="keyword">return</span>;</span><br></pre></td></tr></tbody></table></figure>
<p>当分析了很多控件后不难发现，控件的文本信息往往是以desc或text属性来呈现的，比如一个该按钮名为”更多选项”，其控件的desc属性或text属性就是其按钮名字，确定其名字也就确定了此控件，针对此按钮具体来说，就是其desc属性是”更多选项”。（此处要说的意思就是要具体问题具体分析，文本信息不是desc就是text，如果是desc属性就操作desc，是text属性就操作text）但是，往往就有时候我们只知道包含的部分desc或text，这时候可用这四个函数来确定：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//descContains即desc包含部分信息即可匹配</span></span><br><span class="line"><span class="keyword">if</span>(descContains(<span class="string">"选项"</span>).exists())</span><br><span class="line">{</span><br><span class="line">    <span class="comment">//需要执行的操作</span></span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">//descStartsWith即desc以此信息开头即可匹配</span></span><br><span class="line"><span class="keyword">if</span>(descStartsWith(<span class="string">"更多"</span>).exists())</span><br><span class="line">{</span><br><span class="line">    <span class="comment">//需要执行的操作</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>同理，text也有对应的两个函数,比如一个按钮text属性为(“我的学习积分”)/</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//textContains即text包含部分信息即可匹配</span></span><br><span class="line"><span class="keyword">if</span>(textContains(<span class="string">"学习积分"</span>).exists())</span><br><span class="line">{</span><br><span class="line">    <span class="comment">//需要执行的操作</span></span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">//textStartsWith即text以此信息开头即可匹配</span></span><br><span class="line"><span class="keyword">if</span>(textStartsWith(<span class="string">"我的"</span>).exists())</span><br><span class="line">{</span><br><span class="line">    <span class="comment">//需要执行的操作</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>当然，更多情况是desc和text属性并不能唯一确定要操作的控件，我们往往用其他属性(常用的有className、id、depth等)一起叠加使用来尽可能的使之唯一，比如：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//往往是诸多控件属性一起才可唯一确定待操作的控件</span></span><br><span class="line"><span class="keyword">var</span> myObject = className(“XXX”).depth(xx).id(“XXX”).text(“XXX”).findone();</span><br><span class="line">myObject.click();</span><br></pre></td></tr></tbody></table></figure>
<p> 需要注意的是：在不同的Android系统上，同一版本的app的控件属性可能会变化。同样，app版本更新后，控件属性、布局也可能发生变化，所以，若要对不同版本不同系统具有兼容性，应尽可能选择不变化的控件属性。</p>
<h2 id="基于控件父子关系确定控件"><a href="#基于控件父子关系确定控件" class="headerlink" title="基于控件父子关系确定控件"></a>基于控件父子关系确定控件</h2><p>有时候，控件属性是变化的、随机的，这时候我们便不能通过控件的本身固有属性如id，className，depth等来唯一的确定出需要的控件，这时候我们可以通过控件之间的上下级关系(也叫父子关系)来确定出需要操作的控件。</p>
<p>首先需要了解的是控件间的依存关系，还是以之前的app界面为例，我们这次来分析右下角的的“+”号按钮，和之前一样利用Auto.JS分析控件布局，我们点击右下角的“+”号按钮，点击[在布局层次中查看]，便可以查看当前控件在整个布局层次中的上下级关系(父子关系)，如图1.6所示，不难发现，从上到下，左侧五颜六色的竖棍丨就代表着其层级关系，竖棍丨越多也就越处于底层，该“+”号按钮控件名为“ImageButton”，对应着拥有8根竖棍丨，所以其是在第八级。</p>
<p>另外，和“ImageButton”平级的控件是图1.6所示的8.2—“ImageView”控件，“ImageButton”的父控件也就是它的上级控件是图1.6所示的7.3—“android.view.View”控件，所以我们可以建立以下关系：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">8.1</span>中“ImageButton”的parent() = <span class="number">7.3</span>中“android.view.View”</span><br><span class="line"></span><br><span class="line"><span class="number">7.3</span>中“android.view.View”的child(<span class="number">0</span>) = <span class="number">8.1</span>中“ImageButton”</span><br><span class="line"></span><br><span class="line"><span class="number">7.3</span>中“android.view.View”的child(<span class="number">1</span>) = <span class="number">8.2</span>中“ImageView”</span><br><span class="line"></span><br><span class="line"><span class="number">7.3</span>中“android.view.View”的parent() = <span class="number">6</span>中“android.view.View”</span><br><span class="line"></span><br><span class="line"><span class="number">6</span>中“android.view.View”的child(<span class="number">0</span>)  = <span class="number">7.1</span>中“LinearLayout”</span><br><span class="line"></span><br><span class="line"><span class="number">6</span>中“android.view.View”的child(<span class="number">1</span>)  = <span class="number">7.2</span>中“android.view.View”</span><br><span class="line"></span><br><span class="line"><span class="number">6</span>中“android.view.View”的child(<span class="number">2</span>)  = <span class="number">7.3</span>中“android.view.View”</span><br></pre></td></tr></tbody></table></figure>

<p> 建立了以上隶属关系，我们就可以通过唯一确定任意其中一个不变的固定控件，便可通过控件间的隶属关系来确定我们想要的控件，从而规避了我们要找的控件属性动态变化这一情况。</p>
<p> <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://gitee.com/xi_fan/img/raw/master/image-20211112113703418.png" alt="图1.5 点击[在布局层次中查看]"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://gitee.com/xi_fan/img/raw/master/image-20211112113725776.png" alt="图1.6 控件的布局层次分析1"></p>
<p> 在这里，我们假定以之前右上角的【⋮】按钮为固定控件(因为”更多选项”这几个字基本不会变化)，通过【⋮】按钮来和控件间的父子关系来确定出右下角的“+”号按钮。</p>
<p>首先分析右上角的【⋮】按钮的层级关系，如图1.7所示，【⋮】按钮位于第10级，它的父级parent是图1.7所示的9.3—“android.support.v7.widget.LinearLayoutCompat”，9.3的父级是8—“android.view.View”,以此类推，发现我们想要操作的控件也就是“ImageButton”控件(8.1)和右上角的【⋮】按钮即“ImageView”控件(10)关系是：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">“ImageView”控件(<span class="number">10</span>)是从<span class="number">7.1</span>—“LinearLayout”继承下来的；</span><br><span class="line"></span><br><span class="line">“ImageButton”控件(<span class="number">8.1</span>)是从<span class="number">7.3</span>—“android.view.View”继承下来的；</span><br><span class="line"></span><br><span class="line">   而<span class="number">7.1</span>和<span class="number">7.3</span>是平级关系，拥有共同的父级<span class="number">6</span>—“android.view.View”</span><br></pre></td></tr></tbody></table></figure>


<p>图1.7 控件的布局层次分析2</p>
<p>明白了这一点，我们便可通过【⋮】按钮(10)来确定右下角的“+”号按钮(8.1)，如下所示：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//首先，通过desc属性确定出【⋮】按钮(图1.7所示的10)</span></span><br><span class="line"><span class="comment">//属性.findone()首先找到一个控件，再在此基础上加.parent等</span></span><br><span class="line"><span class="keyword">var</span> moreButton = desc(<span class="string">"更多选项"</span>).findone();   </span><br><span class="line"></span><br><span class="line"><span class="comment">//其次，找到【⋮】按钮和右下角“+”号按钮共同的父级parent</span></span><br><span class="line"><span class="comment">//在这里是一层层往上找是为了方便理解，实际操作可一步到位</span></span><br><span class="line"><span class="keyword">var</span> 9_3Supportv7 = moreButton.parent();                             <span class="comment">//找到图1.7所示的9.3控件</span></span><br><span class="line"><span class="keyword">var</span> 8viewView = moreButton.parent().parent();                       <span class="comment">//找到图1.7所示的8控件</span></span><br><span class="line"><span class="keyword">var</span> 7_1LinearLayout = moreButton.parent().parent().parent();        <span class="comment">//找到图1.7所示的7.1控件</span></span><br><span class="line"><span class="keyword">var</span> 6viewView = moreButton.parent().parent().parent().parent();     <span class="comment">//找到图1.7所示的6控件</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//最后，通过共同的父级parent找到右下角“+”号按钮</span></span><br><span class="line"><span class="comment">//在这里是一层层往下找是为了方便理解，实际操作可一步到位</span></span><br><span class="line"><span class="keyword">var</span> 7_3viewView = 6viewView.child(<span class="number">2</span>);                               <span class="comment">//找到图1.7所示的7.3控件</span></span><br><span class="line"><span class="keyword">var</span> plusButton = 6viewView.child(<span class="number">2</span>).child(<span class="number">0</span>);                       <span class="comment">//找到图1.7所示的8.1控件（也就是+号按钮）</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//所以，如果一步到位，总结如下：</span></span><br><span class="line"><span class="keyword">var</span> plusButton = moreButton.parent().parent().parent().parent().child(<span class="number">2</span>).child(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//再对+号按钮进行点击</span></span><br><span class="line">plusButton.click();</span><br></pre></td></tr></tbody></table></figure>
<p> 此处例子里的的两个控件【⋮】按钮(10)和右下角的“+”号按钮(8.1)之间相差了很多层，因此显着有些复杂，在实际情况中，我们往往不需要跨越这么多的层级来确定控件，一般情况下不会那么复杂。实际上，父子关系嵌套两三层往往即可确定出另一控件。最后，在这里需要注意的是，确定控件时要加上“.findone()”，此方法调用后会返回所有符合条件的控件集合。因此，首先要找到一个不容易变化的或容易找的控件“.findone()”后再在此基础上进行“.parent()”“.child(index)”操作找到另一控件。</p>
<h2 id="滑动"><a href="#滑动" class="headerlink" title="滑动"></a>滑动</h2><p>当然，基于坐标的操作不仅有click()操作，常用的还有swipe()滑动操作，gesture()手势滑动操作等，具体可查看官方文档，在这里仅对swipe()，gesture()这两个函数进行介绍。</p>
<p>swipe(x1,y1,x2,y2,time)：(x1,y1)代表起始点坐标，(x2,y2)代表终点坐标，time代表滑动所需要的时间</p>
<p>//注意：安卓7以下的滑动需要root权限，且函数名变为Swipe(x1,y1,x2,y2,time)</p>
<p>gesture(time,[x1,y1],[x2,y2],[x3,y3]…)：time同，(x1,y1)是起始点坐标，(x2,y2)是途径点坐标，最后一个坐标是终点</p>
<p>下面以一个某APP注册时的滑动验证为例(为防止被人恶意利用，在此打上码。再次声明，此处做仅举例用，所有代码仅供学习交流！)，如图2.0所示，当我们输入手机号点击注册时，此时需要将滑块拖动到指定位置处才可以发送验证码从而进行下一步的注册。在这里，我们将想要拖动的滑块称为控件①，想要拖到的目标处称为控件②。那么，如果想要实现一个自动化拖动首先就要确定的是控件①和控件②的坐标，又因为其坐标每次都是随机的，所以只需要根据两个控件的特有属性唯一确定出控件①和控件②，再每次获取其坐标即可。</p>
<p>通过对两个控件的属性分析，如图2.1所示，我们不难发现，控件①和控件②的indexInParent()不同，因此可通过此分别唯一的定位出两个控件，确定控件后，我们再调用swipe()或gesture()函数来执行滑动，从而实现自动滑动的操作。</p>
<p>具体实现代码如下：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//首先判断是否进入了"滑动验证"界面</span></span><br><span class="line"><span class="keyword">if</span>(text(<span class="string">"滑动验证"</span>).exists())</span><br><span class="line">{</span><br><span class="line">    sleep(<span class="number">2000</span>);</span><br><span class="line">    <span class="comment">//判断控件1是否存在</span></span><br><span class="line">    <span class="keyword">if</span>(className(<span class="string">"android.widget.Button"</span>).depth(<span class="number">8</span>).indexInParent(<span class="number">1</span>).exists())</span><br><span class="line">    {   </span><br><span class="line">        <span class="comment">//控件1存在，获取其坐标bounds()属性</span></span><br><span class="line">        <span class="keyword">var</span> Button1 = className(<span class="string">"android.widget.Button"</span>).depth(<span class="number">8</span>).indexInParent(<span class="number">1</span>).findOne().bounds();</span><br><span class="line">        sleep(<span class="number">500</span>);</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">"Button1的坐标为:"</span>+ Button1);</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">//判断控件2是否存在</span></span><br><span class="line">    <span class="keyword">if</span>(className(<span class="string">"android.widget.Button"</span>).depth(<span class="number">8</span>).indexInParent(<span class="number">3</span>).exists())</span><br><span class="line">    {</span><br><span class="line">	<span class="keyword">var</span> Button2 = className(<span class="string">"android.widget.Button"</span>).depth(<span class="number">8</span>).indexInParent(<span class="number">3</span>).findOne().bounds();</span><br><span class="line">	sleep(<span class="number">500</span>);</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">"Button2的坐标为:"</span>+ Button2);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//两个控件的坐标都获取到后，执行swipe或gesture操作</span></span><br><span class="line">    sleep(<span class="number">2000</span>);</span><br><span class="line">    <span class="comment">//swipe(x1,y1,x2,y2,[time])</span></span><br><span class="line">    swipe(Button1.left, Button1.top, Button2.left, Button2.top, [random(<span class="number">500</span>,<span class="number">1200</span>)]);</span><br><span class="line">    sleep(<span class="number">2000</span>);</span><br><span class="line">    <span class="comment">//gesture(time,[x1,y1],[x2,y2])</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Swipe完成！"</span>);</span><br><span class="line">    gesture(random(<span class="number">500</span>,<span class="number">1200</span>), [Button1.left, Button1.top], [Button2.left, Button2.top]);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"gesture完成！"</span>);</span><br><span class="line">    <span class="comment">//结束</span></span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>







<ul>
<li>find()函数会找出所有满足条件的控件并返回一个控件集合,之后可以对控件集合进行操作</li>
</ul>
<p>var findAssemble = textContains(“2020-07-15”).find();     //找到所有包含”2020-07-15”的控件集合findAssemble </p>
<ul>
<li>findone()函数会对屏幕上的控件进行搜索，直到屏幕上出现满足条件的一个控件为止，并返回该控件</li>
</ul>
<p>如果找不到控件，当屏幕内容发生变化时会重新寻找，直至找到<br>注意：如果findone不加限制时间且屏幕上一直没有出现所描述的控件，则该函数会阻塞，直到找到为止</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> findoneAssem1 = textContains(<span class="string">"2020-07-15"</span>).findone();     <span class="comment">//找到一个包含"2020-07-15"的控件findoneAssem1</span></span><br><span class="line"><span class="keyword">var</span> findoneAssem2 = textContains(<span class="string">"2020-07-15"</span>).findone(<span class="number">500</span>); <span class="comment">//在500毫秒内找到一个包含"2020-07-15"的控件findoneAssem，若找不到，终止搜索返回null</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><p>findonce(i)函数会根据当前所确定的筛选条件，对屏幕上的控件进行搜索，并返回第 i + 1 个符合条件的控件</p>
<p>  如果没有找到符合条件的控件，或者符合条件的控件个数 &lt; i, 则返回null</p>
</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> findonce1 = textContains(<span class="string">"2020-07-15"</span>).findonce(<span class="number">0</span>);     <span class="comment">//搜索第一个包含"2020-07-15"的控件findonce1</span></span><br><span class="line"><span class="keyword">var</span> findonce2 = textContains(<span class="string">"2020-07-15"</span>).findonce(<span class="number">1</span>);     <span class="comment">//搜索第二个包含"2020-07-15"的控件findonce2</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="滑动-1"><a href="#滑动-1" class="headerlink" title="滑动"></a>滑动</h2><p>在很多时候，我们经常会见到className名为“.ListView”的控件，实际上其往往是充当装在很多list的集合，以此控件为例，我们可以实现对此控件的上下滑动，</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//scrollForward()函数会对控件执行向前滑动的操作，并返回是否操作成功</span></span><br><span class="line"><span class="comment">//scrollBackward()函数会对控件执行向后滑动的操作，并返回是否操作成功</span></span><br><span class="line"><span class="keyword">var</span> listView = ClassName(“ListView”).id(XXX).findone();</span><br><span class="line">ListView.scrollForward();         <span class="comment">//向前滑动</span></span><br><span class="line">ListView.scrollBackward();        <span class="comment">//向后滑动</span></span><br></pre></td></tr></tbody></table></figure>
<p> 在此只是以“.ListView”的控件进行举例，实际使用过程中，只要控件是可上下滑动的，都可以调用函数“scrollForward()”和“scrollBackward()”来实现对控件的滑动操作。</p>
<h1 id="基于坐标"><a href="#基于坐标" class="headerlink" title="基于坐标"></a>基于坐标</h1><h2 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h2><p>屏幕坐标系，屏幕左上角为原点（0，0），向右为x轴正向，向下为y轴正向,单位为px</p>
<h2 id="gestures"><a href="#gestures" class="headerlink" title="gestures"></a>gestures</h2><p>gestures([delay1, duration1, [x1, y1], [x2, y2], …], [delay2, duration2, [x3, y3], [x4, y4], …], …)</p>
<p>同时模拟多个手势。每个手势的参数为[delay, duration, 坐标], delay为延迟多久(毫秒)才执行该手势；duration为手势执行时长；坐标为手势经过的点的坐标。</p>
<p>其中delay参数可以省略，默认为0。</p>
<p>例如手指捏合：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 三指下滑截屏</span></span><br><span class="line">gestures(</span><br><span class="line">    [<span class="number">0</span>, <span class="number">500</span>, [<span class="number">230</span>, <span class="number">452</span>], [<span class="number">230</span>, <span class="number">1000</span>]],</span><br><span class="line">    [<span class="number">0</span>, <span class="number">500</span>, [<span class="number">500</span>, <span class="number">452</span>], [<span class="number">500</span>, <span class="number">1000</span>]],</span><br><span class="line">    [<span class="number">0</span>, <span class="number">500</span>, [<span class="number">755</span>, <span class="number">452</span>], [<span class="number">755</span>, <span class="number">1000</span>]]</span><br><span class="line">);</span><br></pre></td></tr></tbody></table></figure>
<h2 id="屏幕缩放"><a href="#屏幕缩放" class="headerlink" title="屏幕缩放"></a>屏幕缩放</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// serScreenMetrics(width,height)	//aj自带屏幕缩放函数</span></span><br><span class="line"><span class="comment">// var h = device.height	获取屏幕高度px</span></span><br><span class="line"><span class="comment">// var w = device.width	获取屏幕宽度px</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//屏幕缩放函数 适配多机型</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clicks</span>(<span class="params">x,y</span>)</span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line"><span class="comment">//注意,测试机型为1080*2340,你可以根据自己的机型修改</span></span><br><span class="line">x1=device.width/<span class="number">1080</span>   <span class="comment">//屏幕宽度，单位像素</span></span><br><span class="line">y1=device.height/<span class="number">2340</span>   <span class="comment">//屏幕高度，单位像素</span></span><br><span class="line"></span><br><span class="line">click(x*x1,y*y1)</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>




















<h1 id="Autojs-本地验证（一机一码）"><a href="#Autojs-本地验证（一机一码）" class="headerlink" title="Autojs 本地验证（一机一码）"></a>Autojs 本地验证（一机一码）</h1><h2 id="1、一机一码的实现原理"><a href="#1、一机一码的实现原理" class="headerlink" title="1、一机一码的实现原理"></a>1、一机一码的实现原理</h2><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">机器码：设备的唯一标识</span><br><span class="line"></span><br><span class="line">注册机：用于激活设备，生成激活码。</span><br><span class="line"></span><br><span class="line">激活码：用于激活设备</span><br></pre></td></tr></tbody></table></figure>



<h2 id="2、一机一码UI界面的开发"><a href="#2、一机一码UI界面的开发" class="headerlink" title="2、一机一码UI界面的开发"></a>2、一机一码UI界面的开发</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"ui"</span>;</span><br><span class="line">ui.layout(</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">vertical</span> <span class="attr">padding</span>=<span class="string">'10'</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">horizontal</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">text</span>=<span class="string">"机器码："</span>/&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"machineCode"</span> <span class="attr">w</span>=<span class="string">'*'</span>/&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">horizontal</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">horizontal</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">text</span>=<span class="string">"激活码："</span>/&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"activationCode"</span> <span class="attr">w</span>=<span class="string">'*'</span>/&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">horizontal</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">'activation'</span> <span class="attr">text</span>=<span class="string">"激活"</span>/&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">vertical</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">ui.activation.on(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{</span><br><span class="line">    alert(<span class="string">'激活成功！'</span>);</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>



<h2 id="3、注册机UI界面的开发"><a href="#3、注册机UI界面的开发" class="headerlink" title="3、注册机UI界面的开发"></a>3、注册机UI界面的开发</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"ui"</span>;</span><br><span class="line">ui.layout(</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">vertical</span> <span class="attr">padding</span>=<span class="string">'10'</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">horizontal</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">text</span>=<span class="string">"机器码："</span>/&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"machineCode"</span> <span class="attr">w</span>=<span class="string">'*'</span>/&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">horizontal</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">'activation'</span> <span class="attr">text</span>=<span class="string">"生成激活码"</span>/&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">text</span>=<span class="string">"激活码："</span> <span class="attr">textColor</span>=<span class="string">"red"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">id</span>=<span class="string">'activationCode'</span> <span class="attr">text</span>=<span class="string">'未生成'</span>/&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">vertical</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">ui.activation.on(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{</span><br><span class="line">    ui.activationCode.setText(<span class="string">'123456'</span>)</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>



<h2 id="4、获取手机唯一标识"><a href="#4、获取手机唯一标识" class="headerlink" title="4、获取手机唯一标识"></a>4、获取手机唯一标识</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// var uuid = device.fingerprint;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> imei = device.getIMEI()</span><br><span class="line"></span><br><span class="line">toast(imei)</span><br></pre></td></tr></tbody></table></figure>



<h2 id="5、完成第一个脚本注册机验证"><a href="#5、完成第一个脚本注册机验证" class="headerlink" title="5、完成第一个脚本注册机验证"></a>5、完成第一个脚本注册机验证</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">脚本端</span><br><span class="line"></span><br><span class="line"><span class="string">"ui"</span>;</span><br><span class="line">ui.layout(</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">vertical</span> <span class="attr">padding</span>=<span class="string">'10'</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">horizontal</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">text</span>=<span class="string">"机器码："</span>/&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"machineCode"</span> <span class="attr">w</span>=<span class="string">'*'</span> <span class="attr">text</span>=<span class="string">''</span>/&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">horizontal</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">horizontal</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">text</span>=<span class="string">"激活码："</span>/&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"activationCode"</span> <span class="attr">w</span>=<span class="string">'*'</span>/&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">horizontal</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">'activation'</span> <span class="attr">text</span>=<span class="string">"激活"</span>/&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">vertical</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> uuid = device.fingerprint;</span><br><span class="line"></span><br><span class="line">ui.machineCode.setText(uuid)</span><br><span class="line"></span><br><span class="line">ui.activation.on(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{</span><br><span class="line"></span><br><span class="line">    <span class="comment">//取算法得到的值</span></span><br><span class="line">    <span class="keyword">var</span> res = ui.machineCode.text() +<span class="string">"aaa"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// log(typeof(ui.activationCode.text()))</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// log(typeof(res.toString()))</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(ui.activationCode.text() === res.toString()){</span><br><span class="line">        alert(<span class="string">'激活成功！'</span>);</span><br><span class="line">    }<span class="keyword">else</span>{</span><br><span class="line">        alert(<span class="string">'激活失败！'</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// alert('激活成功！');</span></span><br><span class="line">})</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">注册机端</span><br><span class="line"></span><br><span class="line"><span class="string">"ui"</span>;</span><br><span class="line">ui.layout(</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">vertical</span> <span class="attr">padding</span>=<span class="string">'10'</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">horizontal</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">text</span>=<span class="string">"机器码："</span>/&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"machineCode"</span> <span class="attr">w</span>=<span class="string">'*'</span>/&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">horizontal</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">'activation'</span> <span class="attr">text</span>=<span class="string">"生成激活码"</span>/&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">text</span>=<span class="string">"激活码："</span> <span class="attr">textColor</span>=<span class="string">"red"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">id</span>=<span class="string">'activationCode'</span> <span class="attr">text</span>=<span class="string">'未生成'</span>/&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">vertical</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">//算法是  uuid+"aaa" </span></span><br><span class="line"></span><br><span class="line">ui.activation.on(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> machineCode = ui.machineCode.text();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> activationCode = machineCode + <span class="string">'aaa'</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// toast(activationCode)</span></span><br><span class="line"></span><br><span class="line">    ui.activationCode.setText(activationCode.toString())</span><br><span class="line"></span><br><span class="line">    setClip(activationCode.toString())</span><br><span class="line"></span><br><span class="line">    toast(<span class="string">'激活码已复制'</span>)</span><br><span class="line">})</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>



<h2 id="6、对手机唯一标识符进行加密"><a href="#6、对手机唯一标识符进行加密" class="headerlink" title="6、对手机唯一标识符进行加密"></a>6、对手机唯一标识符进行加密</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">md5</span>(<span class="params">string</span>)</span>{</span><br><span class="line">	<span class="keyword">var</span> res=java.math.BigInteger(<span class="number">1</span>,java.security.MessageDigest.getInstance(<span class="string">"MD5"</span>).digest(java.lang.String(string).getBytes())).toString(<span class="number">16</span>);</span><br><span class="line">	<span class="keyword">while</span>(res.length&lt;<span class="number">32</span>)res=<span class="string">"0"</span>+res;</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h2 id="7、增加时间验证"><a href="#7、增加时间验证" class="headerlink" title="7、增加时间验证"></a>7、增加时间验证</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//格式化时间</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dateFormat</span>(<span class="params">thisDate, fmt</span>) </span>{</span><br><span class="line">    <span class="keyword">var</span> o = {</span><br><span class="line">        <span class="string">"M+"</span>: thisDate.getMonth() + <span class="number">1</span>,</span><br><span class="line">        <span class="string">"d+"</span>: thisDate.getDate(),</span><br><span class="line">        <span class="string">"h+"</span>: thisDate.getHours(),</span><br><span class="line">        <span class="string">"m+"</span>: thisDate.getMinutes(),</span><br><span class="line">        <span class="string">"s+"</span>: thisDate.getSeconds(),</span><br><span class="line">        <span class="string">"q+"</span>: <span class="built_in">Math</span>.floor((thisDate.getMonth() + <span class="number">3</span>) / <span class="number">3</span>),</span><br><span class="line">        <span class="string">"S"</span>: thisDate.getMilliseconds()</span><br><span class="line">    };</span><br><span class="line">    <span class="keyword">if</span> (<span class="regexp">/(y+)/</span>.test(fmt))</span><br><span class="line">        fmt = fmt.replace(<span class="built_in">RegExp</span>.$1, (thisDate.getFullYear() + <span class="string">""</span>).substr(<span class="number">4</span> - <span class="built_in">RegExp</span>.$1.length));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> k <span class="keyword">in</span> o)</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"("</span> + k + <span class="string">")"</span>).test(fmt))</span><br><span class="line">            fmt = fmt.replace(<span class="built_in">RegExp</span>.$1, (<span class="built_in">RegExp</span>.$1.length == <span class="number">1</span>) ? (o[k]) : ((<span class="string">"00"</span> + o[k]).substr((<span class="string">""</span> + o[k]).length)));</span><br><span class="line">    <span class="keyword">return</span> fmt;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h2 id="8、增加时间验证（二）"><a href="#8、增加时间验证（二）" class="headerlink" title="8、增加时间验证（二）"></a>8、增加时间验证（二）</h2><h2 id="9、开发日卡、月卡、年卡功能"><a href="#9、开发日卡、月卡、年卡功能" class="headerlink" title="9、开发日卡、月卡、年卡功能"></a>9、开发日卡、月卡、年卡功能</h2><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;horizontal&gt;</span><br><span class="line">    &lt;text textSize="16sp"&gt;充值类型&lt;/text&gt;</span><br><span class="line">    &lt;spinner id="sp1" entries="月卡|年卡" textColor="red"/&gt;</span><br><span class="line">&lt;/horizontal&gt;</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ui.sp1.getSelectedItemPosition();</span><br></pre></td></tr></tbody></table></figure>



<h2 id="10、激活码限制脚本运行"><a href="#10、激活码限制脚本运行" class="headerlink" title="10、激活码限制脚本运行"></a>10、激活码限制脚本运行</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validTime</span>(<span class="params">ntime</span>) </span>{</span><br><span class="line">    <span class="keyword">if</span> (toTime() &lt; ntime || IntTime() &lt; ntime) {</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">toTime</span>(<span class="params"></span>) </span>{</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> java.text.SimpleDateFormat(<span class="string">"yyyyMMddHHmmss"</span>).format(<span class="keyword">new</span> <span class="built_in">Date</span>());</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">IntTime</span>(<span class="params"></span>) </span>{</span><br><span class="line">    <span class="keyword">try</span> {</span><br><span class="line">        <span class="keyword">var</span> recode_suning = http.get(<span class="string">"http://quan.suning.com/getSysTime.do"</span>);</span><br><span class="line">        <span class="keyword">var</span> suningTime = recode_suning.body.json();</span><br><span class="line">        <span class="keyword">return</span> suningTime.sysTime1;</span><br><span class="line">    } <span class="keyword">catch</span> (e) {}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h2 id="11、保存激活状态到本地"><a href="#11、保存激活状态到本地" class="headerlink" title="11、保存激活状态到本地"></a>11、保存激活状态到本地</h2><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var storage = storages.create('activation');</span><br></pre></td></tr></tbody></table></figure>



<h2 id="12、解决时间验证bug方法"><a href="#12、解决时间验证bug方法" class="headerlink" title="12、解决时间验证bug方法"></a>12、解决时间验证bug方法</h2><h2 id="13、完善激活码交互逻辑"><a href="#13、完善激活码交互逻辑" class="headerlink" title="13、完善激活码交互逻辑"></a>13、完善激活码交互逻辑</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">dialogs.build({</span><br><span class="line">        <span class="attr">title</span>: <span class="string">"机器码："</span>,</span><br><span class="line">        <span class="attr">content</span>: uuid,</span><br><span class="line">        <span class="attr">negative</span>: <span class="string">"输入激活码"</span>,</span><br><span class="line">        <span class="attr">positive</span>: <span class="string">"复制机器码"</span></span><br><span class="line">    }).on(<span class="string">"positive"</span>, <span class="function">()=&gt;</span>{</span><br><span class="line">      setClip(uuid);</span><br><span class="line">      toast(<span class="string">"机器码已复制"</span>);</span><br><span class="line">    }).on(<span class="string">"negative"</span>, <span class="function">()=&gt;</span>{</span><br><span class="line">        rawInput(<span class="string">"请输入激活码"</span>, <span class="string">""</span>, 激活码 =&gt; {</span><br><span class="line">            </span><br><span class="line">       });</span><br><span class="line">    }).show();</span><br></pre></td></tr></tbody></table></figure>



<h2 id="14、封装验证激活码函数-一"><a href="#14、封装验证激活码函数-一" class="headerlink" title="14、封装验证激活码函数(一)"></a>14、封装验证激活码函数(一)</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//验证激活码</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validateCode</span>(<span class="params">uuid,activation</span>)</span>{</span><br><span class="line">    <span class="comment">//取算法得到的值</span></span><br><span class="line">    <span class="keyword">var</span> res = uuid +<span class="string">"aaa"</span>;</span><br><span class="line">    <span class="comment">//解密激活码</span></span><br><span class="line">    <span class="keyword">var</span> res2 = activation.split(<span class="string">'&amp;'</span>);</span><br><span class="line">    <span class="keyword">var</span> activationCode = res2[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">var</span> timestamp = res2[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取未来的格式化时间</span></span><br><span class="line">    <span class="keyword">var</span> timestamp2 = dateFormat(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">parseInt</span>(timestamp)), <span class="string">"yyyyMMddhhmmss"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(activationCode === res.toString() &amp;&amp; validTime(timestamp2)){</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    }<span class="keyword">else</span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h2 id="15、封装验证激活码函数-二"><a href="#15、封装验证激活码函数-二" class="headerlink" title="15、封装验证激活码函数(二)"></a>15、封装验证激活码函数(二)</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//验证激活码</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validateCode</span>(<span class="params">uuid,activation</span>)</span>{</span><br><span class="line">    <span class="comment">//取算法得到的值</span></span><br><span class="line">    <span class="keyword">var</span> res = uuid +<span class="string">"aaa"</span>;</span><br><span class="line">    <span class="comment">//解密激活码</span></span><br><span class="line">    <span class="keyword">var</span> res2 = activation.split(<span class="string">'&amp;'</span>);</span><br><span class="line">    <span class="keyword">var</span> activationCode = res2[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">var</span> timestamp = res2[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取未来的格式化时间</span></span><br><span class="line">    <span class="keyword">var</span> timestamp2 = dateFormat(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">parseInt</span>(timestamp)), <span class="string">"yyyyMMddhhmmss"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(activationCode === res.toString()){</span><br><span class="line">        <span class="keyword">if</span>(validTime(timestamp2)){</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        }</span><br><span class="line">    }<span class="keyword">else</span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h2 id="16、封装注册机加密函数"><a href="#16、封装注册机加密函数" class="headerlink" title="16、封装注册机加密函数"></a>16、封装注册机加密函数</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//算法函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encrypt</span>(<span class="params">machineCode,timestamp</span>)</span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> activationCode = machineCode + <span class="string">'aaa&amp;'</span>+timestamp;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> activationCode;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h2 id="17、升级加密复杂度（一）"><a href="#17、升级加密复杂度（一）" class="headerlink" title="17、升级加密复杂度（一）"></a>17、升级加密复杂度（一）</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> 加密字符串<span class="number">1</span> = md5(uuid+timestamp);</span><br><span class="line"><span class="keyword">var</span> 加密时间 = ((timestamp-<span class="number">0</span>+<span class="number">10000</span>)*<span class="number">903</span>)/<span class="number">100000</span>;</span><br><span class="line"><span class="keyword">var</span> 加密字符串<span class="number">2</span> = md5((md5(<span class="string">"litikj"</span> +加密字符串<span class="number">1</span> +<span class="string">"litikj"</span>)+<span class="string">"litikj"</span>) +加密时间 +md5(uuid)+<span class="string">"112233"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> 激活码 = 加密字符串<span class="number">1</span>+<span class="string">"&amp;"</span>+加密时间+<span class="string">"&amp;"</span>+加密字符串<span class="number">2</span></span><br></pre></td></tr></tbody></table></figure>



<h2 id="18、升级加密复杂度（二）"><a href="#18、升级加密复杂度（二）" class="headerlink" title="18、升级加密复杂度（二）"></a>18、升级加密复杂度（二）</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//验证激活码</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validateCode</span>(<span class="params">uuid,activation</span>)</span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> codeArr = activation.split(<span class="string">"&amp;"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> str1 = codeArr[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> encryptTime = codeArr[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> str2 = codeArr[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> timestamp = (<span class="built_in">Number</span>(encryptTime) * <span class="number">100000</span>) / <span class="number">903</span> -<span class="number">10000</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//格式化时间</span></span><br><span class="line">    <span class="keyword">var</span> timestamp2 = dateFormat(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">parseInt</span>(timestamp)), <span class="string">"yyyyMMddhhmmss"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//判断激活码是否有效</span></span><br><span class="line">    <span class="keyword">if</span>(str1 === md5(uuid+timestamp) &amp;&amp; str2 === md5((md5(<span class="string">"litikj"</span> +md5(uuid+timestamp) +<span class="string">"litikj"</span>)+<span class="string">"litikj"</span>) +encryptTime +md5(uuid)+<span class="string">"112233"</span>)){</span><br><span class="line">        <span class="comment">//算法一样</span></span><br><span class="line">        <span class="keyword">if</span>(validTime(timestamp2)){</span><br><span class="line">            <span class="comment">//时间正常</span></span><br><span class="line">            ui.end.setText(<span class="string">'到期时间:'</span>);</span><br><span class="line">            ui.time.setText(dateFormat(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">parseInt</span>(timestamp)), <span class="string">'yyyy年MM月dd日 hh:mm:ss'</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">            <span class="comment">//时间过期</span></span><br><span class="line">            ui.end.setText(<span class="string">'时间过期:'</span>);</span><br><span class="line">            ui.time.setText(dateFormat(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">parseInt</span>(timestamp)), <span class="string">'yyyy年MM月dd日 hh:mm:ss'</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        }</span><br><span class="line">    }<span class="keyword">else</span>{</span><br><span class="line">        <span class="comment">//算法不一样</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h2 id="19、增加运行脚本时的验证方法"><a href="#19、增加运行脚本时的验证方法" class="headerlink" title="19、增加运行脚本时的验证方法"></a>19、增加运行脚本时的验证方法</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span>{</span><br><span class="line">    <span class="keyword">if</span>(storage.get(<span class="string">'activation'</span>)){</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">var</span> res = validateCode(uuid,storage.get(<span class="string">'activation'</span>))</span><br><span class="line">       </span><br><span class="line">        <span class="keyword">switch</span>(res){</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                    scriptStatus = <span class="literal">false</span>; </span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                    scriptStatus = <span class="literal">true</span>; </span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                    scriptStatus = <span class="literal">false</span>;    </span><br><span class="line">                    <span class="keyword">break</span>;         </span><br><span class="line">        }</span><br><span class="line">        </span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h2 id="20、给脚本添加一机一码功能（一）"><a href="#20、给脚本添加一机一码功能（一）" class="headerlink" title="20、给脚本添加一机一码功能（一）"></a>20、给脚本添加一机一码功能（一）</h2><h2 id="21、给脚本添加一机一码功能（二）"><a href="#21、给脚本添加一机一码功能（二）" class="headerlink" title="21、给脚本添加一机一码功能（二）"></a>21、给脚本添加一机一码功能（二）</h2><h1 id="如何写游戏脚本"><a href="#如何写游戏脚本" class="headerlink" title="如何写游戏脚本"></a>如何写游戏脚本</h1><h2 id="触摸模拟"><a href="#触摸模拟" class="headerlink" title="触摸模拟"></a>触摸模拟</h2><ul>
<li><p><code>sleep(n)</code>：暂停运行n毫秒，游戏脚本中最常出现的一个命令；有一些操作必须给它一定的缓冲时间才能正确运行完成。</p>
</li>
<li><p>随机数： <code>random(min,max)</code>指定区间、<code>random()</code>范围是[0,1)；点击坐标时常设置一个随机偏移，防止被检测到（每次都点同一个点还是太明显了）</p>
</li>
<li><p>分辨率适配问题，<code>setScreenMetrics(1080, 1920);</code>、表示脚本适合的屏幕宽高为1080x1920（编脚本时基于的设备），如果在别的分辨率手机上运行则会自动放缩光标。听上去很好的一个功能，一般游戏脚本必加这一行，但具体效果如何我没有测试过。</p>
</li>
<li><p><code>click(x,y)</code>：点击坐标（无需root权限），返回是否成功，点击过程大约150ms，可能被其他事件中断。更长时间的点击如<code>longClick(x,y)</code>、持续600ms。</p>
</li>
<li><p><code>press(x,y,duartion)</code>：按住坐标，一般超过500ms才被系统认为是长按。</p>
</li>
<li><p><code>swipe(x1,y1,x2,y2,duration)</code>： 从(x1,y1)滑动到(x2,y2)，持续duration。</p>
</li>
<li><p><code>RootAutomator</code><br>  上面的几个触摸操作都是免root的，而基于RootAutomator对象的触摸需要root权限，优点是执行没有延迟，明显比click要快。</p>
</li>
</ul>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var ra=new RootAutomator(); //初始化一个对象</span><br><span class="line">ra.tap(x,y,id); //id代表不同“手指”，用于多点触摸，不需要时可省略该参数</span><br><span class="line">ra.swipe(x1,y1,x2,y2,duration,id)</span><br><span class="line">ra.press(x,y,duration,id)</span><br><span class="line">// 这些命令组合在一起就能完成复杂的操作了~</span><br><span class="line">ra.touchDown(x,y,id)</span><br><span class="line">ra.touchMove(x,y,id)</span><br><span class="line">ra.touchUp(id)</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>模拟按键；（返回bool值）</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(back()){};    <span class="comment">//按下返回键</span></span><br><span class="line">home()  <span class="comment">//返回桌面</span></span><br><span class="line">还有一些需要root权限的，开头字母大写:</span><br><span class="line"><span class="comment">//Home()、Back()、Power()、Menu()、OK()、KeyCode()...</span></span><br></pre></td></tr></tbody></table></figure>



<h2 id="colors"><a href="#colors" class="headerlink" title="colors"></a>colors</h2><p>颜色常用十六进制值或RGB值来表示，如蓝色可表示为<code>#0000FF</code>或<code>(0,0,255)</code>，一般都是<code>#</code>后面带6位十六进制数，分别表示R、G、B，但Autojs是8位，前面多了一个<code>A(Alpha)</code>、表示透明度，即ARGB。</p>
<ul>
<li>Autojs通过一个16进制整数或一个字符串表示一个颜色，两者可以互相转换</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myBlue=colors.toString(color.BLUE); <span class="comment">//返回#ff0000ff,colors.BLUE代表蓝色，后面必须大写。</span></span><br><span class="line"><span class="keyword">var</span> numBlue=colors.parseColor(<span class="string">"#ff0000ff"</span>); <span class="comment">//返回-16776961,至于为什么是这个数我也不清楚，平时还是用字符串表示比较好。</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>colors对象里还有一些判断两个颜色的相似度、返回A、R、G、B通道值的函数，平时也基本上用不上；颜色的用途主要体现在后面的多点找色上。</li>
</ul>
<h2 id="images"><a href="#images" class="headerlink" title="images"></a>images</h2><p>游戏脚本的灵魂所在，images主要有图片处理、找图、找色几个部分；想让脚本识别游戏的某个区域、如果该区域的位置是固定的，通过构造多点比色比较快，而如果位置不固定则常用找图的方式，虽然占用资源比较多但准确性有保障。</p>
<ul>
<li>images对象使用完后必须回收，防止内存泄漏。</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> img=images.read(<span class="string">"./name.png"</span>);  <span class="comment">//读取图片，错误时返回null</span></span><br><span class="line"><span class="comment">//var img=images.load(url); //从网址获取图片</span></span><br><span class="line"><span class="comment">//...图片操作后回收</span></span><br><span class="line">img.recycle();</span><br><span class="line"><span class="comment">// 例外：captureScreen()返回的图片无需回收</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>mages对象能对图像进行复制、保存、Base64编码解码、剪切、调整大小、放缩、旋转、拼接、灰度化、阈值化、颜色控件转换、二值化、模糊与平滑处理、滤波…（强是很强大，就是基本上用不上）</li>
<li>获取截图权限：在找图找色之前往往要先获取当前屏幕的截图，这个截图一般是临时的、不会保存到文件（也可以设置保存）。 截图之前要向系统<strong>申请一次</strong>截图权限：</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!requestScreenCapture()){    <span class="comment">//可指定参数true（横屏截图） 或者 false（竖屏截图）</span></span><br><span class="line">    toast(<span class="string">"请求截图失败"</span>);</span><br><span class="line">    exit();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>请求截图: <code>captureScreen</code></li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在此之前记住要请求一次截图权限</span></span><br><span class="line"><span class="keyword">var</span> img=captureScreen();    <span class="comment">//可以指定保存路径path</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>颜色获取，很重要的一个函数，后面多点找色时可以先用它获取参数值。</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取某点的ARGB颜色值</span></span><br><span class="line"><span class="keyword">var</span> color=images.pixel(img,<span class="number">100</span>,<span class="number">200</span>);    <span class="comment">//img是之前创建的images对象</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>区域找色（一种颜色）；<code>findColor</code>、<code>findColorInRegion</code>、<code>findColorEquals</code></li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//首先说下region和threshold这两个参数，后面的找色函数options里都要用到：</span></span><br><span class="line"><span class="comment">//region、找色区域，默认全图、指定[x,y]代表左上角点，从(x,y)到右下角；指定[x,y,width,height]则代表从(x,y)到(x+width,y+height)。</span></span><br><span class="line"><span class="comment">//threshold、相似度临界值，0~255，默认为4；similarity=1-threshold/255，可以算出默认相似度达到了0.98，觉得太严了可以适当增大threshold</span></span><br><span class="line"><span class="keyword">var</span> point = images.findColor(img, <span class="string">"#ff0000"</span>, { <span class="attr">region</span>: [<span class="number">100</span>, <span class="number">200</span>], <span class="attr">threshold</span>: <span class="number">10</span> });</span><br><span class="line"><span class="comment">//如果找到则返回一个点，如：{463.0, 1242.0}；找不到返回null。</span></span><br><span class="line"><span class="comment">//这里颜色值是6位，8位也行不过会忽略A通道（透明度）。</span></span><br><span class="line"><span class="comment">// findColorInRegion，功能和findColor一样，只是优化了下参数表示。</span></span><br><span class="line"><span class="keyword">var</span> point=images.findColorInRegion(img,<span class="string">"#ff0000"</span>,<span class="number">100</span>,<span class="number">200</span>,<span class="number">1080</span>,<span class="number">1920</span>,<span class="number">10</span>);</span><br><span class="line"><span class="comment">// findColorEquals，要求颜色完全相等，相当于findColor的threshold参数设为0</span></span><br><span class="line"><span class="keyword">var</span> point=images.findColorEquals(img,<span class="string">"#ff0000"</span>,<span class="number">100</span>,<span class="number">200</span>,<span class="number">1080</span>,<span class="number">1920</span>);</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>多点找色：<code>findMultiColors</code>，先定位第一个点的颜色、根据(x,y)偏移获取并对比第二个点的颜色…以此类推，命令很麻烦，通常需要写一个函数来构造颜色列。</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> point = images.findMultiColors(img, <span class="string">"#ff949fc7"</span>,    <span class="comment">//第一个点</span></span><br><span class="line">    [[<span class="number">60</span>, <span class="number">60</span>, <span class="string">"#ffe6efe6"</span>], <span class="comment">//颜色Array，</span></span><br><span class="line">    [<span class="number">60</span>, -<span class="number">60</span>, <span class="string">"#ffeef3e6"</span>],</span><br><span class="line">    [-<span class="number">60</span>, <span class="number">60</span>, <span class="string">"#ffe6efe6"</span>],</span><br><span class="line">    [-<span class="number">60</span>, -<span class="number">60</span>, <span class="string">"#ffeef3e6"</span>]],</span><br><span class="line">    { <span class="attr">region</span>: [<span class="number">1548</span>, <span class="number">803</span>, <span class="number">140</span>, <span class="number">140</span>] })  <span class="comment">//指定区域</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>检测某坐标颜色：前几个命令都是根据颜色找坐标，这个是给坐标、比较颜色</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(images.detectsColor(img,<span class="string">"#fed9a8"</span>,<span class="number">100</span>,<span class="number">200</span>,<span class="number">16</span>,<span class="string">"diff"</span>)){}</span><br><span class="line"><span class="comment">//最后两个参数可省略，代表threshold和匹配算法；x=100,y=200</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>找图：有时候找颜色会匹配到一些奇怪的地方去，还得用找图来实现，有<code>images.findImage</code>、<code>images.findImageInRegion</code>、<code>images.matchTemplate</code>。</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> temp1=images.read(pathToImage);</span><br><span class="line"><span class="keyword">var</span> point=images.findImage(img,temp1,{ <span class="attr">region</span>: [<span class="number">100</span>, <span class="number">200</span>], <span class="attr">threshold</span>: <span class="number">10</span> });</span><br><span class="line"><span class="comment">//同样findImageInRegion只是优化了下参数排列</span></span><br><span class="line"><span class="comment">//matchTemplate可以同时返回找到的多个位置，通过max控制最大的结果数量</span></span><br><span class="line"><span class="keyword">var</span> result=images.matchTemplate(img,temp1,{ <span class="attr">region</span>: [<span class="number">100</span>, <span class="number">200</span>], <span class="attr">threshold</span>: <span class="number">10</span> ,<span class="attr">max</span>:<span class="number">5</span>});</span><br><span class="line"><span class="comment">//返回类型是一个MatchingResult对象，有point和similarity这两个数据成员。</span></span><br></pre></td></tr></tbody></table></figure>



<h2 id="脚本结构管理"><a href="#脚本结构管理" class="headerlink" title="脚本结构管理"></a>脚本结构管理</h2><h3 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h3><p>在一个文件里通过<code>module.exports =...;</code>把某个对象导出，从而可以在另一个文件通过<code>var name=require('file.js');</code>导入；相当于把整个文件当做一个函数，把exports的东西当做返回值。感觉用起来也不太方便，我选择不用这个功能。</p>
<h3 id="Threads"><a href="#Threads" class="headerlink" title="Threads"></a>Threads</h3><ul>
<li>启动一个子线程，<code>threads.start</code>：</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//启动一个无限循环的线程</span></span><br><span class="line"><span class="keyword">var</span> thread = threads.start(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{  <span class="comment">//用thread对象可以控制线程运行状态，如果不需要操作可以改为：</span></span><br><span class="line"><span class="comment">//threads.start(function(){</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">true</span>){</span><br><span class="line">        log(<span class="string">"子线程运行中..."</span>);</span><br><span class="line">        sleep(<span class="number">1000</span>);</span><br><span class="line">    }</span><br><span class="line">});</span><br><span class="line">sleep(<span class="number">5000</span>);</span><br><span class="line">thread.interrupt();</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><p><code>threads.shutDownAll()</code>： 停止所有通过<code>threads.start()</code>启动的子线程</p>
</li>
<li><p>等待线程开始执行（一般start后需要一段时间）：<code>thread.waitFor();</code>（这里thread是前面创建的thread变量）</p>
</li>
<li><p>等待线程执行完成：<code>thread.join();</code>，参数可以指定一个等待时间</p>
</li>
<li><p>中断线程运行：<code>thread.interrupt();</code></p>
</li>
<li><p>注意多线程中的变量问题，涉及到<strong>线程安全</strong>，文档里说的很详细</p>
</li>
<li><p>线程间的通信与传递变量，通过<code>var connect = threads.disposable();</code>实现；发送结果：<code>connect.setAndNotify(s);</code>，接收结果：<code>connect.blockedGet(s);</code></p>
</li>
</ul>
<h2 id="交互界面"><a href="#交互界面" class="headerlink" title="交互界面"></a>交互界面</h2><h3 id="Events、Dialogs、Console"><a href="#Events、Dialogs、Console" class="headerlink" title="Events、Dialogs、Console"></a>Events、Dialogs、Console</h3><ul>
<li>Events模块主要用来监听按键、触摸、通知等，但放在单线程里可能会因为程序其他部分而无法及时执行，造成非预期的结果，常常和多线程<code>Threads</code>模块一起使用，如音量键关闭脚本的例子：</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">auto();</span><br><span class="line">threads.start(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{ <span class="comment">//在子线程中调用observeKey()从而使按键事件处理在子线程执行</span></span><br><span class="line">    events.observeKey();    <span class="comment">//启用按键监听</span></span><br><span class="line">    events.on(<span class="string">"key_down"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">keyCode, events</span>)</span>{</span><br><span class="line">    <span class="comment">//常用事件有key、key_down、key_up、exit、toast、notification、touch(触摸某点)</span></span><br><span class="line">        <span class="keyword">if</span>(keyCode == keys.volume_up){  <span class="comment">//音量上键关闭脚本</span></span><br><span class="line">            exit();</span><br><span class="line">        }</span><br><span class="line">    });</span><br><span class="line">});</span><br><span class="line">events.on(<span class="string">"exit"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{   <span class="comment">//脚本停止运行时会触发exit事件</span></span><br><span class="line">    toast(<span class="string">"脚本已结束"</span>);</span><br><span class="line">});</span><br><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>){</span><br><span class="line">    log(<span class="string">"脚本运行中..."</span>);</span><br><span class="line">    sleep(<span class="number">2000</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>Dialogs</li>
</ul>
<p>这部分提供对话框支持，但由于是弹出一个全屏的消息提示框，实际体验是并不太能用上；如果脚本和用户的交互性比较强的话可以考虑一下。</p>
<ul>
<li>Console</li>
</ul>
<p>控制台的作用更像是用于调试，但一般Windows下用VSCode写脚本也不需要在控制台上显示吧，所以这部分给人的感觉也是很鸡肋…不过<code>console</code>的UI是固定的，也可以悬浮、最小化；有时不想设计UI的时候可以偷懒直接拿<code>console</code>过来凑合用用。</p>
<h3 id="Floaty、UI"><a href="#Floaty、UI" class="headerlink" title="Floaty、UI"></a>Floaty、UI</h3><p>界面设计这部分内容相当多，而且官方文档也有很多写得很简略（甚至一笔带过），要想真正从零开始设计出一个实用好看的UI出来还是有难度的；我是建议去网上多找几个模板文件运行运行，在别人的基础上修改起来就快多了，看不懂的地方再去翻翻文档解决。一般UI设计好后再和程序一对接（通过UI各组件的id），就可以打包做成apk了~</p>
<h1 id="写一个注册机"><a href="#写一个注册机" class="headerlink" title="写一个注册机"></a>写一个注册机</h1><p>实战加密解密</p>
<p>我们再测试下解密 看能不能解开 </p>
<p>唯一 = device.getIMEI()</p>
<p>我们来回忆一下：</p>
<p>加密1 加密2——-固定加密</p>
<p>加密3 ————随机加密</p>
<p>解密2  解密3——解密使用</p>
<p>开始加密，可以用 加密2 加密3，随便用，都可以</p>
<p>但是你需要记住 加密的次数和加密顺序</p>
<p>——-3次——-加密2——–加密2——–加密3</p>
<p>看结果</p>
<p>?wv1%yv%4rv%0v%S0v%7vJ%5v%8Sw%3w%Uxw%9vW%vv%55v%yy%7j5</p>
<p>我们在我们自己的脚本中，开始写解密，相反的顺序</p>
<p>———-解密3———解密2——–解密2——3次—-</p>
<p>得到</p>
<p>358811051254785</p>
<p>我们测试下 运行 这个函数 </p>
<p>358811051254785</p>
<p>完美了，继续</p>
<p>运行到这里了 我们可以得到  一个   “加密结果3”</p>
<p>需要让对方把这个值 发给我们 这样操作</p>
<p>setClip(加密结果3);</p>
<p>toast (“已经复制到右键了，请发给我”);</p>
<p>演示一下，运行一下，他发给我们的是这个</p>
<p>?wvl%yv%4gv%0v%p0v%7vr%5v%8Hw%3w%dxw%9vk%vv%5hv%yy%7j5</p>
<p>说明，我们的方法是对的。继续</p>
<p>对方发给我们之后 我们运行解密 结果也出来了。</p>
<p>还是这个数字。358811051254785。那当然还是它了。</p>
<p>那么，我们就这样，什么也不干就发给他吗？？？<br>不，，，，，，，，稍微有点常识的看一眼都知道，这可能就是手机的某个参数。</p>
<p>这时候，有小白就会问了，这不是没有意义吗？！错。大错特错。<br>你看看对方发给我们的是什么，每次都不一样，他也迷糊，是吧。<br>。。。。。。我们可以把提示代码抹去，虽然他每次都复制了，但是对方不知道呀，嘿嘿。你只需要第一次告诉对方，复制右键发给我们。嘿嘿。</p>
<p>为了彻底迷惑对方，我们再继续对“唯一”进行多次混合加密。这里必须用固定加密。。嘿嘿。</p>
<p>我们在我们自己的脚本中，也复制一模一样的，运行，</p>
<p>得到 “加密结果10”—-这个就是我们要发给对方的验证码了</p>
<p>最后，我们把代码完善下，能删除的log都删了</p>
<p>ok了</p>
<p>需要特别说明的 就是 你发给对方的脚本中 只能有加密函数<br>别傻了胡痴地 把解密函数 也给对方发过去。嘿嘿。</p>
<p>这个只是在脚本上加密解密。还有网络加密解密。如果，有感兴趣的，以后可以出一个教程。非常简单的。因为网站都已经给我们现成的auto.js封装好的啊。只需要随便改一点点东西，就可以使用了。</p>
<p>代码发到下面了</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(auto.service==<span class="literal">null</span>){auto.waitFor();};</span><br><span class="line">sleep(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">唯一 = device.getIMEI()</span><br><span class="line"></span><br><span class="line">加密结果<span class="number">1</span> = 加密<span class="number">2</span>(唯一)</span><br><span class="line">加密结果<span class="number">2</span> = 加密<span class="number">2</span>(加密结果<span class="number">1</span>)</span><br><span class="line">加密结果<span class="number">3</span> = 加密<span class="number">3</span>(加密结果<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">setClip(加密结果<span class="number">3</span>);</span><br><span class="line"><span class="comment">//toast ("已经复制到右键了，请发给我");</span></span><br><span class="line"></span><br><span class="line">sleep(<span class="number">90000</span>)</span><br><span class="line"></span><br><span class="line">加密结果<span class="number">4</span> = 加密<span class="number">2</span>(唯一)</span><br><span class="line">加密结果<span class="number">5</span> = 加密<span class="number">2</span>(加密结果<span class="number">4</span>)</span><br><span class="line">加密结果<span class="number">6</span> = 加密<span class="number">1</span>(加密结果<span class="number">5</span>)</span><br><span class="line">加密结果<span class="number">7</span> = 加密<span class="number">1</span>(加密结果<span class="number">6</span>)</span><br><span class="line">加密结果<span class="number">8</span> = 加密<span class="number">2</span>(加密结果<span class="number">7</span>)</span><br><span class="line">加密结果<span class="number">9</span> = 加密<span class="number">1</span>(加密结果<span class="number">8</span>)</span><br><span class="line">加密结果<span class="number">10</span> = 加密<span class="number">2</span>(加密结果<span class="number">9</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> 对方输入框里的 = rawInput(<span class="string">"请输入验证码"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (对方输入框里的 == 加密结果<span class="number">10</span>) {</span><br><span class="line">    log(<span class="string">"验证码正确"</span>)</span><br><span class="line">    <span class="comment">//开始干活喽</span></span><br><span class="line">} <span class="keyword">else</span> {</span><br><span class="line">    log(<span class="string">"验证码错误"</span>);</span><br><span class="line">    exit();</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 固定加密</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> 加密1(<span class="params">string</span>) </span>{</span><br><span class="line">    <span class="keyword">return</span> java.math.BigInteger(<span class="number">1</span>, java.security.MessageDigest.getInstance(<span class="string">"MD5"</span>)</span><br><span class="line">        .digest(java.lang.String(string).getBytes())).toString(<span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// 固定加密</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> 加密2(<span class="params">code</span>) </span>{</span><br><span class="line">    <span class="keyword">var</span> c = <span class="built_in">String</span>.fromCharCode(code.charCodeAt(<span class="number">0</span>) + code.length);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; code.length; i++) {</span><br><span class="line">        c += <span class="built_in">String</span>.fromCharCode(code.charCodeAt(i) + code.charCodeAt(i - <span class="number">1</span>));</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">escape</span>(c);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 随机加密</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> 加密3(<span class="params">stringW</span>) </span>{</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> str = stringW + <span class="string">"?"</span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> ranWs = random(<span class="number">1</span>, <span class="number">6</span>);</span><br><span class="line">    <span class="keyword">var</span> str1 = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; str.length; i++) {</span><br><span class="line">        str1 = str1 + str[i];</span><br><span class="line">        <span class="keyword">if</span> (i % ranWs == <span class="number">0</span>) {</span><br><span class="line">            str1 = str1 + ranLetter();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    log(str1)</span><br><span class="line">    str1 = ranWs + str1;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    str1 = str1.split(<span class="string">""</span>).reverse();</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> x = <span class="number">0</span>; x &lt; str1.length; x++) {</span><br><span class="line">        str1[x] = charDh(str1[x]);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> str1.join(<span class="string">""</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ranLetter</span>(<span class="params"></span>) </span>{</span><br><span class="line">    <span class="keyword">var</span> arr = [<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>, <span class="string">"f"</span>, <span class="string">"g"</span>, <span class="string">"h"</span>, <span class="string">"i"</span>, <span class="string">"j"</span>, <span class="string">"k"</span>, <span class="string">"l"</span>, <span class="string">"m"</span>, <span class="string">"n"</span>, <span class="string">"o"</span>, <span class="string">"p"</span>, <span class="string">"q"</span>, <span class="string">"r"</span>, <span class="string">"s"</span>, <span class="string">"t"</span>, <span class="string">"u"</span>, <span class="string">"v"</span>, <span class="string">"w"</span>, <span class="string">"x"</span>, <span class="string">"y"</span>, <span class="string">"z"</span>];</span><br><span class="line">    <span class="keyword">var</span> ran = random(<span class="number">0</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">if</span> (ran == <span class="number">0</span>) {</span><br><span class="line">        <span class="keyword">return</span> random(<span class="number">0</span>, <span class="number">9</span>);</span><br><span class="line">    } <span class="keyword">else</span> <span class="keyword">if</span> (ran == <span class="number">1</span>) {</span><br><span class="line">        <span class="keyword">return</span> arr[random(<span class="number">0</span>, arr.length - <span class="number">1</span>)];</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="keyword">return</span> arr[random(<span class="number">0</span>, arr.length - <span class="number">1</span>)].toUpperCase();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">charDh</span>(<span class="params">cha</span>) </span>{</span><br><span class="line">    <span class="keyword">var</span> arr = [<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>, <span class="string">"f"</span>, <span class="string">"g"</span>, <span class="string">"h"</span>, <span class="string">"i"</span>, <span class="string">"j"</span>, <span class="string">"k"</span>, <span class="string">"l"</span>, <span class="string">"m"</span>, <span class="string">"n"</span>, <span class="string">"o"</span>, <span class="string">"p"</span>, <span class="string">"q"</span>, <span class="string">"r"</span>, <span class="string">"s"</span>, <span class="string">"t"</span>, <span class="string">"u"</span>, <span class="string">"v"</span>, <span class="string">"w"</span>, <span class="string">"x"</span>, <span class="string">"y"</span>, <span class="string">"z"</span>, <span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="string">"E"</span>, <span class="string">"F"</span>, <span class="string">"G"</span>, <span class="string">"H"</span>, <span class="string">"J"</span>, <span class="string">"K"</span>, <span class="string">"L"</span>, <span class="string">"M"</span>, <span class="string">"N"</span>, <span class="string">"O"</span>, <span class="string">"P"</span>, <span class="string">"Q"</span>, <span class="string">"R"</span>, <span class="string">"S"</span>, <span class="string">"T"</span>, <span class="string">"U"</span>, <span class="string">"V"</span>, <span class="string">"W"</span>, <span class="string">"X"</span>, <span class="string">"Y"</span>, <span class="string">"Z"</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> jw = <span class="number">0</span>; jw &lt; arr.length; jw++) {</span><br><span class="line">        <span class="keyword">if</span> (cha == arr[jw]) {</span><br><span class="line">            <span class="keyword">return</span> arr[arr.length - <span class="number">1</span> - jw];</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> cha;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//解密</span></span><br><span class="line"><span class="keyword">var</span> b = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">解密结果<span class="number">3</span> = 解密<span class="number">3</span>(b)</span><br><span class="line"></span><br><span class="line">解密结果<span class="number">2</span> = 解密<span class="number">2</span>(解密结果<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">解密结果<span class="number">1</span> = 解密<span class="number">2</span>(解密结果<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//log(解密结果1)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//解密结果1  就是对方手机的IMEI 也就是“唯一”</span></span><br><span class="line"></span><br><span class="line">加密结果<span class="number">4</span> = 加密<span class="number">2</span>(解密结果<span class="number">1</span>)</span><br><span class="line">加密结果<span class="number">5</span> = 加密<span class="number">2</span>(加密结果<span class="number">4</span>)</span><br><span class="line">加密结果<span class="number">6</span> = 加密<span class="number">1</span>(加密结果<span class="number">5</span>)</span><br><span class="line">加密结果<span class="number">7</span> = 加密<span class="number">1</span>(加密结果<span class="number">6</span>)</span><br><span class="line">加密结果<span class="number">8</span> = 加密<span class="number">2</span>(加密结果<span class="number">7</span>)</span><br><span class="line">加密结果<span class="number">9</span> = 加密<span class="number">1</span>(加密结果<span class="number">8</span>)</span><br><span class="line">加密结果<span class="number">10</span> = 加密<span class="number">2</span>(加密结果<span class="number">9</span>)</span><br><span class="line"></span><br><span class="line">log(加密结果<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> 解密2(<span class="params">code</span>) </span>{</span><br><span class="line">    code = <span class="built_in">unescape</span>(code);</span><br><span class="line">    <span class="keyword">var</span> c = <span class="built_in">String</span>.fromCharCode(code.charCodeAt(<span class="number">0</span>) - code.length);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; code.length; i++) {</span><br><span class="line">        c += <span class="built_in">String</span>.fromCharCode(code.charCodeAt(i) - c.charCodeAt(i - <span class="number">1</span>));</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> 解密3(<span class="params">stringJ</span>) </span>{</span><br><span class="line">    <span class="keyword">var</span> str2 = stringJ.split(<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> x = <span class="number">0</span>; x &lt; str2.length; x++) {</span><br><span class="line">        str2[x] = charDh(str2[x]);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    str2 = str2.reverse().join(<span class="string">""</span>);</span><br><span class="line">    log(str2)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> tt = <span class="built_in">parseInt</span>(str2[<span class="number">0</span>]);</span><br><span class="line">    str2 = str2.substring(<span class="number">1</span>, str2.length - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">var</span> str3 = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> y = <span class="number">0</span>; y &lt; str2.length; y++) {</span><br><span class="line">        <span class="keyword">if</span> ((y - <span class="number">1</span>) % (tt + <span class="number">1</span>) != <span class="number">0</span>) {</span><br><span class="line">            str3 = str3 + str2[y];</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (str3[str3.length - <span class="number">1</span>] == <span class="string">"?"</span>) {</span><br><span class="line">        str3 = str3.substring(<span class="number">0</span>, str3.length - <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> str3;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">charDh</span>(<span class="params">cha</span>) </span>{</span><br><span class="line">    <span class="keyword">var</span> arr = [<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>, <span class="string">"f"</span>, <span class="string">"g"</span>, <span class="string">"h"</span>, <span class="string">"i"</span>, <span class="string">"j"</span>, <span class="string">"k"</span>, <span class="string">"l"</span>, <span class="string">"m"</span>, <span class="string">"n"</span>, <span class="string">"o"</span>, <span class="string">"p"</span>, <span class="string">"q"</span>, <span class="string">"r"</span>, <span class="string">"s"</span>, <span class="string">"t"</span>, <span class="string">"u"</span>, <span class="string">"v"</span>, <span class="string">"w"</span>, <span class="string">"x"</span>, <span class="string">"y"</span>, <span class="string">"z"</span>, <span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="string">"E"</span>, <span class="string">"F"</span>, <span class="string">"G"</span>, <span class="string">"H"</span>, <span class="string">"J"</span>, <span class="string">"K"</span>, <span class="string">"L"</span>, <span class="string">"M"</span>, <span class="string">"N"</span>, <span class="string">"O"</span>, <span class="string">"P"</span>, <span class="string">"Q"</span>, <span class="string">"R"</span>, <span class="string">"S"</span>, <span class="string">"T"</span>, <span class="string">"U"</span>, <span class="string">"V"</span>, <span class="string">"W"</span>, <span class="string">"X"</span>, <span class="string">"Y"</span>, <span class="string">"Z"</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> jw = <span class="number">0</span>; jw &lt; arr.length; jw++) {</span><br><span class="line">        <span class="keyword">if</span> (cha == arr[jw]) {</span><br><span class="line">            <span class="keyword">return</span> arr[arr.length - <span class="number">1</span> - jw];</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> cha;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> 加密1(<span class="params">string</span>) </span>{</span><br><span class="line">    <span class="keyword">return</span> java.math.BigInteger(<span class="number">1</span>, java.security.MessageDigest.getInstance(<span class="string">"MD5"</span>)</span><br><span class="line">        .digest(java.lang.String(string).getBytes())).toString(<span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> 加密2(<span class="params">code</span>) </span>{</span><br><span class="line">    <span class="keyword">var</span> c = <span class="built_in">String</span>.fromCharCode(code.charCodeAt(<span class="number">0</span>) + code.length);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; code.length; i++) {</span><br><span class="line">        c += <span class="built_in">String</span>.fromCharCode(code.charCodeAt(i) + code.charCodeAt(i - <span class="number">1</span>));</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">escape</span>(c);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> 加密3(<span class="params">stringW</span>) </span>{</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> str = stringW + <span class="string">"?"</span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> ranWs = random(<span class="number">1</span>, <span class="number">6</span>);</span><br><span class="line">    <span class="keyword">var</span> str1 = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; str.length; i++) {</span><br><span class="line">        str1 = str1 + str[i];</span><br><span class="line">        <span class="keyword">if</span> (i % ranWs == <span class="number">0</span>) {</span><br><span class="line">            str1 = str1 + ranLetter();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    log(str1)</span><br><span class="line">    str1 = ranWs + str1;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    str1 = str1.split(<span class="string">""</span>).reverse();</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> x = <span class="number">0</span>; x &lt; str1.length; x++) {</span><br><span class="line">        str1[x] = charDh(str1[x]);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> str1.join(<span class="string">""</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ranLetter</span>(<span class="params"></span>) </span>{</span><br><span class="line">    <span class="keyword">var</span> arr = [<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>, <span class="string">"f"</span>, <span class="string">"g"</span>, <span class="string">"h"</span>, <span class="string">"i"</span>, <span class="string">"j"</span>, <span class="string">"k"</span>, <span class="string">"l"</span>, <span class="string">"m"</span>, <span class="string">"n"</span>, <span class="string">"o"</span>, <span class="string">"p"</span>, <span class="string">"q"</span>, <span class="string">"r"</span>, <span class="string">"s"</span>, <span class="string">"t"</span>, <span class="string">"u"</span>, <span class="string">"v"</span>, <span class="string">"w"</span>, <span class="string">"x"</span>, <span class="string">"y"</span>, <span class="string">"z"</span>];</span><br><span class="line">    <span class="keyword">var</span> ran = random(<span class="number">0</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">if</span> (ran == <span class="number">0</span>) {</span><br><span class="line">        <span class="keyword">return</span> random(<span class="number">0</span>, <span class="number">9</span>);</span><br><span class="line">    } <span class="keyword">else</span> <span class="keyword">if</span> (ran == <span class="number">1</span>) {</span><br><span class="line">        <span class="keyword">return</span> arr[random(<span class="number">0</span>, arr.length - <span class="number">1</span>)];</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="keyword">return</span> arr[random(<span class="number">0</span>, arr.length - <span class="number">1</span>)].toUpperCase();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>





<h1 id="常用功能封装"><a href="#常用功能封装" class="headerlink" title="常用功能封装"></a>常用功能封装</h1><h2 id="调用云文件"><a href="#调用云文件" class="headerlink" title="调用云文件"></a>调用云文件</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//导入模块</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> 导入常用函数模块(<span class="params"></span>) </span>{</span><br><span class="line">  <span class="keyword">var</span> url =</span><br><span class="line">    <span class="string">"https://raw.githubusercontent.com/snailuncle/autojsCommonFunctions/master/autojsCommonFunctions.js"</span>;</span><br><span class="line">  <span class="keyword">var</span> r = http.get(url);</span><br><span class="line">  log(<span class="string">"code = "</span> + r.statusCode);</span><br><span class="line">  <span class="keyword">var</span> html = r.body.bytes();</span><br><span class="line">  files.writeBytes(<span class="string">"./autojsCommonFunctions.js"</span>, html);</span><br><span class="line">  <span class="keyword">var</span> common = <span class="built_in">require</span>(<span class="string">"./autojsCommonFunctions.js"</span>);</span><br><span class="line">  <span class="keyword">return</span> common;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">var</span> common = 导入常用函数模块();</span><br><span class="line">log(common);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">33</span>; i++) {</span><br><span class="line">  common.闪光弹(<span class="string">"fire in the hole"</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h2 id="调起apk安装"><a href="#调起apk安装" class="headerlink" title="调起apk安装"></a>调起apk安装</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> apkfile = files.path(APK包位置这里这么写是为了可以用相对路径);</span><br><span class="line">app.viewFile(apkfile)</span><br></pre></td></tr></tbody></table></figure>
<h2 id="蚂蚁森林"><a href="#蚂蚁森林" class="headerlink" title="蚂蚁森林"></a>蚂蚁森林</h2><h3 id="暴力点击能量球"><a href="#暴力点击能量球" class="headerlink" title="暴力点击能量球"></a>暴力点击能量球</h3><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CollectEnergy</span>(<span class="params"></span>)</span>{</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'开始收集能量'</span>)</span><br><span class="line">    <span class="comment">// 能量球半径为140</span></span><br><span class="line">    <span class="comment">// 第一个为初始y坐标(screen_height*0.225=540),第二个为末尾y坐标screen_height*0.396=950</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> row = <span class="number">540</span>; row &lt; <span class="number">950</span>; row += <span class="number">140</span>){</span><br><span class="line">        <span class="comment">// 第一个为初始x(140)(screen_width*0.13),第二个为末尾x坐标(930)(screen_width*0.86)</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> col = <span class="number">140</span>; col &lt; <span class="number">930</span>; col += <span class="number">140</span>) {</span><br><span class="line">            click(col, row);</span><br><span class="line">            sleep(<span class="number">10</span>);</span><br><span class="line">            <span class="comment">// log(col, row)</span></span><br><span class="line">    }</span><br><span class="line">    toastLog(<span class="string">"能量收集完成"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>



<h2 id="读取json"><a href="#读取json" class="headerlink" title="读取json"></a>读取json</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> files === <span class="string">'undefined'</span>) {</span><br><span class="line">    <span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line">    <span class="keyword">var</span> files = {</span><br><span class="line">        <span class="attr">read</span>: <span class="function"><span class="keyword">function</span>(<span class="params">path</span>)</span>{</span><br><span class="line">            <span class="keyword">return</span> fs.readFileSync(path,{<span class="attr">encoding</span>:<span class="string">"utf-8"</span>}).toString();</span><br><span class="line">        },</span><br><span class="line">        <span class="attr">write</span>: <span class="function"><span class="keyword">function</span>(<span class="params">path,text</span>)</span>{</span><br><span class="line">            <span class="keyword">return</span> fs.writeFile(path,text,<span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>{</span><br><span class="line">                <span class="keyword">if</span>(err) <span class="keyword">throw</span> err;</span><br><span class="line">            });</span><br><span class="line">        }</span><br><span class="line">    };</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readJSON</span>(<span class="params">fileName</span>)</span>{</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> fileName==<span class="string">"string"</span>){</span><br><span class="line">        <span class="keyword">var</span> strList = fileName.split(<span class="string">"."</span>);</span><br><span class="line">        <span class="keyword">if</span>(strList[strList.length-<span class="number">1</span>].toLowerCase()==<span class="string">"json"</span>){</span><br><span class="line">            <span class="keyword">var</span> data = files.read(fileName);</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">JSON</span>.parse(data);</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">            <span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">"not JSON File"</span>)</span><br><span class="line">        }</span><br><span class="line">    }<span class="keyword">else</span>{</span><br><span class="line">        <span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">"not file name"</span>)</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">writeJSON</span>(<span class="params">fileName,data</span>)</span>{</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> fileName == <span class="string">"string"</span>){</span><br><span class="line">        <span class="keyword">try</span>{</span><br><span class="line">            files.write(fileName,<span class="built_in">JSON</span>.stringify(data));</span><br><span class="line">        }<span class="keyword">catch</span>(e){</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"Hava Error!!"</span>)</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="built_in">console</span>.log(readJSON(<span class="string">"project.json"</span>));</span><br></pre></td></tr></tbody></table></figure>


<h2 id="获取设备唯一标识"><a href="#获取设备唯一标识" class="headerlink" title="获取设备唯一标识"></a>获取设备唯一标识</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// var uuid = device.fingerprint;</span></span><br><span class="line"><span class="comment">// toastLog(uuid)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用device.getAndroidId()代替device.getIMEI().这是因为安卓10以上限制了获取imei码</span></span><br><span class="line"><span class="keyword">var</span> imei = device.getAndroidId()</span><br><span class="line">toast(imei)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// md5加密函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">md5</span>(<span class="params">string</span>)</span>{</span><br><span class="line">	<span class="keyword">var</span> res=java.math.BigInteger(<span class="number">1</span>,java.security.MessageDigest.getInstance(<span class="string">"MD5"</span>).digest(java.lang.String(string).getBytes())).toString(<span class="number">16</span>);</span><br><span class="line">	<span class="keyword">while</span>(res.length&lt;<span class="number">32</span>)res=<span class="string">"0"</span>+res;</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<h2 id="强制结束app进程的功能"><a href="#强制结束app进程的功能" class="headerlink" title="强制结束app进程的功能"></a>强制结束app进程的功能</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">forceCloseApp</span>(<span class="params">appName</span>) </span>{</span><br><span class="line">    <span class="keyword">var</span> packageName = getPackageName(appName);</span><br><span class="line">    app.openAppSetting(packageName);<span class="comment">//打开app的详细信息</span></span><br><span class="line">    <span class="keyword">if</span> (text(<span class="string">"强行停止"</span>).findOne().enabled()) {<span class="comment">//判断强制停止按钮是否可点击，可点击（enabled值为true）则表示在运行，不可点击（enabled值为false）就代表未运行。</span></span><br><span class="line">        text(<span class="string">"强行停止"</span>).findOne().click();</span><br><span class="line">        text(<span class="string">"确定"</span>).findOne().click();</span><br><span class="line">    }</span><br><span class="line">    back();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>







<h2 id="提取文本中的数字的正则表达式"><a href="#提取文本中的数字的正则表达式" class="headerlink" title="提取文本中的数字的正则表达式"></a>提取文本中的数字的正则表达式</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//代码举例：</span></span><br><span class="line">timesText = id(<span class="string">"tv_remain_times"</span>).findOne().text();</span><br><span class="line">times = timesText.replace(<span class="regexp">/[^0-9]/ig</span>, <span class="string">""</span>);</span><br></pre></td></tr></tbody></table></figure>





<h2 id="安卓无障碍"><a href="#安卓无障碍" class="headerlink" title="安卓无障碍"></a>安卓无障碍</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">auto.service.performGlobalAction(<span class="number">9</span>);</span><br><span class="line"><span class="comment">//1 返回</span></span><br><span class="line"><span class="comment">//3 切换任务</span></span><br><span class="line"><span class="comment">//4 下拉通知栏</span></span><br><span class="line"><span class="comment">//5 展开通知栏</span></span><br><span class="line"><span class="comment">//6 长按电源键</span></span><br><span class="line"><span class="comment">//7 分屏模式</span></span><br><span class="line"><span class="comment">//8 锁屏</span></span><br><span class="line"><span class="comment">//9 截图</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="连续按两次返回键退出"><a href="#连续按两次返回键退出" class="headerlink" title="连续按两次返回键退出"></a>连续按两次返回键退出</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"ui"</span>;</span><br><span class="line">ui.layout(</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">vertical</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">button</span>&gt;</span>aaa<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">vertical</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">var</span> isCanFinish = <span class="literal">false</span>;</span><br><span class="line">ui.emitter.on(<span class="string">"back_pressed"</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> {</span><br><span class="line">  <span class="keyword">if</span> (!isCanFinish) {</span><br><span class="line">    toastLog(<span class="string">"连续按两次返回键退出"</span>);</span><br><span class="line">    isCanFinish = <span class="literal">true</span>;</span><br><span class="line">    isCanFinishTimeout = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> {</span><br><span class="line">      isCanFinish = <span class="literal">false</span>;</span><br><span class="line">    }, <span class="number">700</span>);</span><br><span class="line">    e.consumed = <span class="literal">true</span>;</span><br><span class="line">  } <span class="keyword">else</span> {</span><br><span class="line">    <span class="built_in">clearTimeout</span>(isCanFinishTimeout);</span><br><span class="line">    e.consumed = <span class="literal">false</span>;</span><br><span class="line">  }</span><br><span class="line">});</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<h2 id="信息提示"><a href="#信息提示" class="headerlink" title="信息提示"></a>信息提示</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">log()</span><br><span class="line">toast()</span><br><span class="line">toastLog()</span><br><span class="line">alert()</span><br></pre></td></tr></tbody></table></figure>


<h2 id="截图相关"><a href="#截图相关" class="headerlink" title="截图相关"></a>截图相关</h2><p><strong>用adb授予投影媒体权限</strong><br>● 重启后权限依然有效<br>● 授予这个权限以后 requestCaptureScreen就不会弹窗询问了<br><code>adb shell appops set org.autojs.autojspro PROJECT_MEDIA allow </code></p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 基于安卓无障碍截图保存</span></span><br><span class="line">auto.service.performGlobalAction(<span class="number">9</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 三指下滑截屏保存</span></span><br><span class="line">gestures(</span><br><span class="line">    [<span class="number">0</span>, <span class="number">500</span>, [<span class="number">230</span>, <span class="number">452</span>], [<span class="number">230</span>, <span class="number">1000</span>]],</span><br><span class="line">    [<span class="number">0</span>, <span class="number">500</span>, [<span class="number">500</span>, <span class="number">452</span>], [<span class="number">500</span>, <span class="number">1000</span>]],</span><br><span class="line">    [<span class="number">0</span>, <span class="number">500</span>, [<span class="number">755</span>, <span class="number">452</span>], [<span class="number">755</span>, <span class="number">1000</span>]]</span><br><span class="line">);</span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 自动获取截图权限</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetScreenCapture</span>(<span class="params"></span>)</span>{</span><br><span class="line"><span class="comment">// 开启一个线程</span></span><br><span class="line">    <span class="keyword">let</span> Thread = threads.start(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="keyword">if</span>(auto.service != <span class="literal">null</span>){  <span class="comment">//如果已经获得无障碍权限</span></span><br><span class="line">                <span class="comment">//由于系统间同意授权的文本不同，采用正则表达式</span></span><br><span class="line">                <span class="keyword">let</span> Allow = textMatches(<span class="regexp">/(允许|立即开始|统一)/</span>).findOne(<span class="number">10</span>*<span class="number">1000</span>);</span><br><span class="line">                <span class="keyword">if</span>(Allow){</span><br><span class="line">                    Allow.click();</span><br><span class="line">                }</span><br><span class="line">        }</span><br><span class="line">    });</span><br><span class="line">    <span class="keyword">if</span>(!requestScreenCapture()){</span><br><span class="line">        log(<span class="string">"请求截图权限失败"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    }<span class="keyword">else</span>{</span><br><span class="line">        Thread.interrupt()</span><br><span class="line">        log(<span class="string">"已获得截图权限"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p><strong>安卓高版本用无障碍截图</strong></p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> img = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (device.sdkInt &gt;= <span class="number">30</span>) {</span><br><span class="line">  </span><br><span class="line">  img = $automator.takeScreenshot();   <span class="comment">// 安卓11以上无障碍截图,需要回收</span></span><br><span class="line">} <span class="keyword">else</span> {</span><br><span class="line">  threads.start(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">    <span class="keyword">let</span> r = text(<span class="string">"立即开始"</span>).findOne(<span class="number">3000</span>);</span><br><span class="line">    r &amp;&amp; r.click();</span><br><span class="line">  });</span><br><span class="line">  images.requestScreenCapture();</span><br><span class="line">  img = images.captureScreen();</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>



<h2 id="上下滑动翻页"><a href="#上下滑动翻页" class="headerlink" title="上下滑动翻页"></a>上下滑动翻页</h2><p><strong>swipe()函数滑动在autojs4.1与pro不一致</strong><br>swipe(x1, y1, x2, y2, duration)</p>
<p>duration {number} 滑动时长，单位毫秒<br>模拟从坐标(x1, y1)滑动到坐标(x2, y2)，并返回是否成功。只有滑动操作执行完成时脚本才会继续执行。<br>Auto.JS上下滑动可以是对整个屏幕的滑动或对某特定控件的滑动，对整个屏幕滑动</p>
<p>swipe(device.width / 2, device.height - 100, device.width / 2, 200, 5);<br>swipe(device.width/2, device.height/2, device.width/2, device.height/6, 10)  //划到底部</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//调用</span></span><br><span class="line">Slide(<span class="string">"up"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Slide</span>(<span class="params">upordown</span>)</span>{</span><br><span class="line">    <span class="keyword">var</span> h=device.height;               <span class="comment">//屏幕高</span></span><br><span class="line">    <span class="keyword">var</span> w=device.width;                <span class="comment">//屏幕宽</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> x=device.width/<span class="number">2</span>;                     <span class="comment">//横坐标2分之1处</span></span><br><span class="line">    <span class="keyword">var</span> h1=(device.height/<span class="number">6</span>)*<span class="number">3.5</span>;             <span class="comment">//纵坐标6分之3.5处，</span></span><br><span class="line">    <span class="keyword">var</span> h2=(h/<span class="number">6</span>);                      <span class="comment">//纵坐标6分之1处</span></span><br><span class="line">    <span class="keyword">if</span>(upordown==<span class="string">"up"</span>){</span><br><span class="line">        swipe(x, h1, x, h2, <span class="number">400</span>);          <span class="comment">//完美上滑向下翻页(从纵坐标6分之5处拖到纵坐标6分之1处)</span></span><br><span class="line">    }<span class="keyword">else</span>{ </span><br><span class="line">        swipe(x, h2, x, h1, <span class="number">400</span>);          <span class="comment">//完美下滑向上翻页(从纵坐标6分之1处拖到纵坐标6分之5处)</span></span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="重复执行几次"><a href="#重复执行几次" class="headerlink" title="重复执行几次"></a>重复执行几次</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (!descEndsWith(<span class="string">"扫一扫"</span>).exists() &amp;&amp; i&lt;=<span class="number">5</span>){</span><br><span class="line">    i++;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">if</span>(i&gt;=<span class="number">5</span>){}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(n!=<span class="number">0</span>){</span><br><span class="line">    <span class="keyword">if</span>(){</span><br><span class="line"> </span><br><span class="line">    }<span class="keyword">else</span>{</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    n--;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h2 id="黑屏跑脚本-省电"><a href="#黑屏跑脚本-省电" class="headerlink" title="黑屏跑脚本(省电)"></a>黑屏跑脚本(省电)</h2><p>原理很简单,就是去创建一个黑色的悬浮窗,在oled屏幕上,就不会发光,降低功<br>耗.兼容任何脚本</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> 息屏(<span class="params"></span>) </span>{</span><br><span class="line">    <span class="keyword">var</span> h = confirm(<span class="string">"是否要进入息屏挂机模式吗？可按下音量上键停止辅助。并不能锁定屏幕！！！通知栏会正常显示（oled屏可用)"</span>);</span><br><span class="line">    <span class="keyword">if</span>(h){</span><br><span class="line">    <span class="keyword">var</span> w = floaty.rawWindow(</span><br><span class="line">        <span class="xml"><span class="tag">&lt;<span class="name">frame</span> <span class="attr">gravity</span>=<span class="string">"center"</span> <span class="attr">bg</span>=<span class="string">"#000000"</span>/&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line">    w.setSize(-<span class="number">1</span>, -<span class="number">1</span>);</span><br><span class="line">    w.setTouchable(<span class="literal">true</span>);</span><br><span class="line">    <span class="comment">//保持脚本运行</span></span><br><span class="line">    <span class="built_in">setInterval</span>(<span class="function">()=&gt;</span>{}, <span class="number">1000</span>);</span><br><span class="line">    }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">息屏()</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h2 id="一键启动无障碍"><a href="#一键启动无障碍" class="headerlink" title="一键启动无障碍"></a>一键启动无障碍</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">importClass(android.content.Context);</span><br><span class="line">importClass(android.provider.Settings);</span><br><span class="line"><span class="built_in">console</span>.show()</span><br><span class="line"><span class="keyword">try</span> {</span><br><span class="line">    <span class="keyword">var</span> enabledServices = Settings.Secure.getString(context.getContentResolver(), Settings.Secure.ENABLED_ACCESSIBILITY_SERVICES);</span><br><span class="line">    <span class="comment">//把要用的辅助服务打开，获取到已开启的服务，写到Services变量(每个服务间要用英文冒号连接)</span></span><br><span class="line">    log(<span class="string">'当前已启用的辅助服务\n'</span>, enabledServices);   </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    由于Android的一些bug，有时候实际没有开启的服务仍会出现在已启用的里面，所有没办法通过判断得知服务是否开启</span></span><br><span class="line"><span class="comment">    像当前这样子会导致已开启服务里面有很多重复项目，建议直接写死不再每次重新获取</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   </span><br><span class="line">    <span class="comment">// hamibot,autojs,autojspro,绿去广告的无障碍</span></span><br><span class="line">    <span class="keyword">var</span> Services = enabledServices + <span class="string">":com.hamibot.hamibot/com.stardust.autojs.core.accessibility.AccessibilityService"</span>+</span><br><span class="line">    <span class="string">":org.autojs.autojs/com.stardust.autojs.core.accessibility.AccessibilityService"</span>+</span><br><span class="line">    <span class="string">":com.auto.greenskipad/com.auto.skip.service.NewTiaoGuoService"</span>+</span><br><span class="line">    <span class="string">":org.autojs.autojspro/com.stardust.autojs.core.accessibility.AccessibilityService"</span>;</span><br><span class="line">    </span><br><span class="line">    Settings.Secure.putString(context.getContentResolver(), Settings.Secure.ENABLED_ACCESSIBILITY_SERVICES, Services);</span><br><span class="line">    Settings.Secure.putString(context.getContentResolver(), Settings.Secure.ACCESSIBILITY_ENABLED, <span class="string">'1'</span>);</span><br><span class="line">    toastLog(<span class="string">"成功开启无障碍服务"</span>);</span><br><span class="line">} <span class="keyword">catch</span> (error) {</span><br><span class="line">    setClip(<span class="string">"adb shell pm grant org.autojs.autojspro android.permission.WRITE_SECURE_SETTINGS"</span>);  </span><br><span class="line">    <span class="comment">// setClip("adb shell pm grant :com.auto.greenskipad android.permission.WRITE_SECURE_SETTINGS");</span></span><br><span class="line">    toastLog(<span class="string">"\n请确保已给予 WRITE_SECURE_SETTINGS 权限\n\n授权代码已复制到剪贴板，请使用adb工具连接手机执行(重启不失效)\n\n"</span>, error);</span><br><span class="line">  </span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>



<h1 id="Bmob-后端云"><a href="#Bmob-后端云" class="headerlink" title="Bmob 后端云"></a>Bmob 后端云</h1><p>提供可靠的 Serverless 云服务 轻松拥有开发中需要的各种后端能力<br><a target="_blank" rel="noopener" href="https://www.bmob.cn/">Bmob官网</a><br><a target="_blank" rel="noopener" href="http://doc.bmob.cn/">文档</a></p>
<h1 id="点击的方法："><a href="#点击的方法：" class="headerlink" title="点击的方法："></a>点击的方法：</h1><h2 id="控件点击"><a href="#控件点击" class="headerlink" title="控件点击"></a>控件点击</h2><p>首先推荐的必然是控件点击，它的逻辑是只要能被侦测，就能被点击，无论它是躲在某个悬浮窗后面，还是躲在看不见的下滑栏的底部,即使是app在弹广告，依然可以无视掉。前提是找到控件的特殊属性</p>
<p>寻找控件建议不要用findOne()、waitFor()、exists()等一些会阻塞的方法，不然稍微出现一点其他事件就会阻塞，导致脚本莫名其妙的卡死，使用findOne(timeout)、findonce()时可以加个判断在不为null的时候再点击或其他操作，因为没找到返回null，直接click就会报错，脚本停止运行，要是是找的父或者子控件也写到判断里</p>
<p>bounds(813,883,1039,993).findOne().click();</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 包括控件点击和坐标点击</span></span><br><span class="line"><span class="comment"> * clickControl(element)</span></span><br><span class="line"><span class="comment"> * 参数填属性</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">a=className(<span class="string">"android.widget.TextView"</span>).text(<span class="string">"芭芭农场"</span>);</span><br><span class="line"></span><br><span class="line">clickControl(a)</span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">clickControl</span>(<span class="params">element,timeOut</span>) </span>{</span><br><span class="line">    <span class="keyword">if</span> (!timeOut) { timeOut = <span class="number">1000</span> }</span><br><span class="line">    <span class="keyword">let</span> clickResult = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (element == <span class="literal">null</span>) {</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">try</span> {</span><br><span class="line">        <span class="keyword">if</span> (element.exists()) {</span><br><span class="line">            toastLog(<span class="string">"准备click："</span> + element);</span><br><span class="line">            <span class="keyword">let</span> clickable = element.clickable();<span class="comment">//是否可以点击</span></span><br><span class="line">            <span class="keyword">if</span> (clickable) {</span><br><span class="line">                toastLog(<span class="string">"该控件可点击，尝试直接点击"</span>)</span><br><span class="line">                <span class="comment">// element.findOnce(timeOut).click();</span></span><br><span class="line">                clickResult = element.findOnce(timeOut).click();</span><br><span class="line">                sleep(random(<span class="number">500</span>, <span class="number">1000</span>));</span><br><span class="line">            } <span class="keyword">else</span>  {</span><br><span class="line">                toastLog(<span class="string">"尝试坐标点击"</span>)</span><br><span class="line">                <span class="keyword">let</span> b = element.findOnce(timeOut).bounds();</span><br><span class="line">                click(b.centerX(), b.centerY());</span><br><span class="line">                clickResult =click(b.centerX(), b.centerY());</span><br><span class="line">                sleep(random(<span class="number">500</span>, <span class="number">1000</span>));</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> clickResult;</span><br><span class="line">    } <span class="keyword">catch</span> (error) {</span><br><span class="line">        toast(<span class="string">"clickControl方法出现错误："</span> + error)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h2 id="层级结构"><a href="#层级结构" class="headerlink" title="层级结构"></a>层级结构</h2><p>其次仍然是控件点击的延申，层级点击，分为两种点击，通常用于app内的网页展示，表现可以具体参照jd，它的结构极其杂乱</p>
<p>写10多个child，找到它的那个拥有独一无二参数的上家，此时需要pc端控件查看，才能理清思路<br>另外一种 就是使用indexInParent().depth()去查找，如果怕重复，就可以换为find()，然后再一个个检查 下面是一个我在饿了么里面用到的一段代码：<br>sleep(3000); depth(‘15’).indexInParent(‘3’).waitFor(); log(‘页面加载完成\n等待5s’); sleep(5000);</p>
<p>let exb = depth(‘16’).indexInParent(‘0’).find(); for(i = 0; i &lt; exb.length; i++){ if(exb[i].bounds().centerX() &gt; dev_width/2) continue; if(exb[i].bounds().centerY() &gt; dev_hight/2) break; } exb[i].click();sleep(2000);</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//7.不断查找某控件父元素，并点击(解决模拟器和手机不查找元素不一致问题)</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">up_click</span>(<span class="params">x</span>) </span>{</span><br><span class="line">  <span class="keyword">if</span> (x &amp;&amp; x.clickable()) <span class="keyword">return</span> x.click();</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> ii = <span class="number">0</span>; ii &lt; <span class="number">6</span>; ii++) {</span><br><span class="line">      <span class="keyword">if</span> (!x) <span class="keyword">break</span></span><br><span class="line">      x = x.parent();</span><br><span class="line">      <span class="keyword">if</span> (x &amp;&amp; x.clickable()) <span class="keyword">return</span> x.click();</span><br><span class="line">      <span class="keyword">let</span> list_x = x.children();</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; list_x.length; i++) </span><br><span class="line">      {<span class="keyword">if</span> (list_x[i] &amp;&amp; list_x[i].clickable()) <span class="keyword">return</span> list_x[i].click()};}</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<h2 id="识图点击"><a href="#识图点击" class="headerlink" title="识图点击"></a>识图点击</h2><p>即便层级结构复杂，我也是不推荐识图点击，有个例外，就是1对1定制，只在有限的几个设备上用，那识图确实是个省力的活，<br>但是如果面向很多用户，并不推荐， 理由1 不同人的手机屏幕分辨率和尺寸不同，结果就是ppi不同，缩放不同，识图基本上是像素点对比的，所谓的容错也只是颜色的范围，这种问题同样出现在Windows中的pywinauto上 理由2 除了ppi不同导致图案大小不同，还会导致颜色色彩不同，是的，色彩，rgb值不一样。 修正方案：hamibot作者给的建议，只截取屏幕的一长条区域，进行颜色判定。</p>
<p>③找图找色特别消耗内存，所以在能用控件就用控件，找图找色在找到后要用recycle()来对创建的图像对象回收，提高脚本稳定，让脚本能持续运行更长时间，截图也需要一定的时间</p>
<p>④如果脚本有悬浮窗，使用找图要注意不要将要找的图遮挡<br>不要在循环里面读图，还有就是不要频繁操作大字符串<br>image对象创建后尽量在不使用时进行回收，同时避免循环创建大量图片。因为图片是一种占用内存比较大的资源</p>
<h3 id="核心函数"><a href="#核心函数" class="headerlink" title="核心函数"></a>核心函数</h3><p>images.matchTemplate(img, template, options)</p>
<p>作用：[v4.1.0新增]在大图片中搜索小图片，并返回搜索结果MatchingResult。该函数可以用于找图时找出多个位置，可以通过max参数控制最大的结果数量。也可以对匹配结果进行排序、求最值等操作。返回 {MatchingResult}</p>
<p>参数：<br>    img {Image} 大图片<br>    template {Image} 小图片（模板）<br>    options {Object} 找图选项：<br>        1.threshold {number} 图片相似度。取值范围为0~1的浮点数。默认值为0.9。<br>        2.region {Array} 找图区域。参见findColor函数关于region的说明。<br>        3.max {number} 找图结果最大数量，默认为5<br>        4.transparentMask {boolean} 是否使用透明模板找图。此选项开启后，传入的template参数可以是一个透明背景的图片对象用于匹配。此选项为 [Pro 8.0新增] 。<br>        5.level {number} 一般而言不必修改此参数。不加此参数时该参数会根据图片大小自动调整。找图算法是采用图像金字塔进行的, level参数表示金字塔的层次, level越大可能带来越高的找图效率，但也可能造成找图失败（图片因过度缩小而无法分辨）或返回错误位置。因此，除非您清楚该参数的意义并需要进行性能调优，否则不需要用到该参数。</p>
<h3 id="返回的MatchingResult对象"><a href="#返回的MatchingResult对象" class="headerlink" title="返回的MatchingResult对象"></a>返回的MatchingResult对象</h3><p>matches<br>    数组的元素是一个Match对象：<br>        point {Point} 匹配位置<br>        similarity {number} 相似度<br>points<br>first()<br>last()<br>leftmost()<br>topmost()<br>rightmost()<br>bottommost()<br>best()<br>worst()<br>sortBy(cmp)</p>
<h3 id="base64编码转换"><a href="#base64编码转换" class="headerlink" title="base64编码转换"></a>base64编码转换</h3><p>图片可以转为 base64 编码 直接写在脚本中 当做变量使用。。加快图片传输速度</p>
<p><a target="_blank" rel="noopener" href="https://tool.chinaz.com/tools/imgtobase">base64图片转换工具</a></p>
<h4 id="Base64"><a href="#Base64" class="headerlink" title="Base64"></a>Base64</h4><p>1.images.fromBase64(图片的Base64数据)<br>解码Base64数据并返回解码后的图片Image对象。如果base64无法解码则返回null。</p>
<p>2.images.toBase64(Image对象[, 图片格式, 图片质量])<br>返回 {string},把图片编码为base64数据并返回。</p>
<h4 id="bytes"><a href="#bytes" class="headerlink" title="bytes"></a>bytes</h4><p>images.fromBytes(bytes)<br>bytes {byte[]} 字节数组<br>解码字节数组bytes并返回解码后的图片Image对象。如果bytes无法解码则返回null。</p>
<p>images.toBytes(Image对象[, 图片格式, 图片质量])</p>
<p>返回 {byte[]}<br>把图片编码为字节数组并返回。</p>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 循环找图：区域0.0.1080.760搜索到第一次小图位置在50.300，点击后，然后在从100.300.1080.760开始第二次搜索到位置在55.600，点击后，然后在从105.600.1080.760开始下一个搜索。每个搜索点击后判断一下当前Y位置是否到了图标出现的最大位置，超出就退出循环找图(就是全屏找，找到第一个就从第一个位置加点距离开始找第二个。)</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//多张图判断</span></span><br><span class="line"><span class="keyword">var</span> findImgPoint = findImage(personHomeCapture, goldcoinTempl, {</span><br><span class="line">        <span class="attr">region</span>: findImgRegion,</span><br><span class="line">        <span class="attr">threshold</span>: <span class="number">0.9</span></span><br><span class="line">    }) ||</span><br><span class="line">    findImage(personHomeCapture, goldballTempl, {</span><br><span class="line">        <span class="attr">region</span>: findImgRegion</span><br><span class="line">    }) ||</span><br><span class="line">    findImage(personHomeCapture, yellowgirlTempl, {</span><br><span class="line">        <span class="attr">region</span>: findImgRegion,</span><br><span class="line">        <span class="attr">threshold</span>: <span class="number">0.9</span></span><br><span class="line">    }) ||</span><br><span class="line">    findImage(personHomeCapture, chivesTempl, {</span><br><span class="line">        <span class="attr">region</span>: findImgRegion</span><br><span class="line">    }) ||</span><br><span class="line">    findImage(personHomeCapture, pillowTempl, {</span><br><span class="line">        <span class="attr">region</span>: findImgRegion</span><br><span class="line">    });</span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//找图点击 </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">png_click</span>(<span class="params">num, pngbase64</span>)</span>{</span><br><span class="line">  <span class="keyword">while</span>(num--){</span><br><span class="line">      <span class="keyword">let</span> img = captureScreen();</span><br><span class="line">      <span class="keyword">let</span> temp1 = images.fromBase64(pngbase64);</span><br><span class="line">      <span class="keyword">let</span> pos = findImage(img, temp1);</span><br><span class="line">      <span class="keyword">if</span>(pos){<span class="keyword">return</span> click(pos.x, pos.y);} <span class="keyword">else</span> sleep(<span class="number">1000</span>);}</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">              </span><br><span class="line"><span class="built_in">require</span> (<span class="string">"./权限/获取截图权限"</span>)</span><br><span class="line"><span class="built_in">console</span>.show ()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">find_img_click</span>(<span class="params">imgpath, regions,thresholds </span>) </span>{</span><br><span class="line">    <span class="keyword">let</span> img1 = images.read( imgpath );</span><br><span class="line">    <span class="keyword">let</span> 缩放x = device.width / <span class="number">1080</span></span><br><span class="line">    <span class="keyword">let</span> 缩放y = device.height / <span class="number">2400</span></span><br><span class="line">    <span class="comment">//缩放后的图</span></span><br><span class="line">    <span class="keyword">let</span> img2 = images.scale(img1, 缩放x, 缩放y)</span><br><span class="line">    <span class="comment">// captureScreen()函数截全屏</span></span><br><span class="line">    <span class="keyword">let</span> result = images.matchTemplate( captureScreen(), img2, {</span><br><span class="line">        <span class="attr">max</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">region</span>: regions, <span class="comment">//区域</span></span><br><span class="line">        <span class="attr">threshold</span>: thresholds,</span><br><span class="line">    });</span><br><span class="line">    <span class="keyword">let</span> img_w = img2.getWidth()</span><br><span class="line">    <span class="keyword">let</span> img_h = img2.getHeight()</span><br><span class="line">    <span class="comment">//回收图片</span></span><br><span class="line">    img2.recycle();</span><br><span class="line">    <span class="keyword">if</span> (result != <span class="literal">null</span>) {</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; result.matches.length; i++) {</span><br><span class="line">            <span class="keyword">let</span> pp = result.matches[i].point</span><br><span class="line">            log(<span class="string">'所找图坐标是：'</span>+pp)</span><br><span class="line">            log(<span class="string">'所找图宽高为'</span>+img_w,img_h)</span><br><span class="line">            <span class="built_in">console</span>.warn(<span class="string">"找到"</span> + imgpath, pp.x, pp.y)</span><br><span class="line"></span><br><span class="line">            <span class="comment">//随机点击坐标</span></span><br><span class="line">            <span class="comment">// let a = pp.x+Math.floor(Math.random()*5)</span></span><br><span class="line">            <span class="comment">// let b = pp.y+Math.floor(Math.random()*5)</span></span><br><span class="line">            <span class="keyword">let</span> a = random(pp.x,pp.x+img_w)</span><br><span class="line">            <span class="keyword">let</span> b = random(pp.y,pp.y+img_h)</span><br><span class="line">            click( a,  b)</span><br><span class="line">            log(<span class="string">'随机点击范围内的坐标是:'</span>+ a+<span class="string">','</span>+ b)</span><br><span class="line">            <span class="built_in">console</span>.error(<span class="string">"点击--"</span> + imgpath)</span><br><span class="line">            sleep(<span class="number">200</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"===未找到"</span> + imgpath)</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用识图函数</span></span><br><span class="line">imgpath=<span class="string">'/sdcard/脚本/2.jpg'</span>   <span class="comment">//图片路径</span></span><br><span class="line">regions=[<span class="number">0</span>, <span class="number">0</span>, device.width, device.height]   <span class="comment">//识图范围</span></span><br><span class="line">thresholds=<span class="number">0.4</span>      <span class="comment">// 识别率要低一点</span></span><br><span class="line"></span><br><span class="line">find_img_click(imgpath,regions, <span class="number">0.75</span>)  </span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<h2 id="区域找色点击"><a href="#区域找色点击" class="headerlink" title="区域找色点击"></a>区域找色点击</h2><p>images.findColor(image, color, options) 在图片中寻找颜色color。找到时返回找到的点Point，找不到时返回null。<br>    image {Image} 图片</p>
<pre><code>color {number | string} 要寻找的颜色的RGB值。如果是一个整数，则以0xRRGGBB的形式代表RGB值（A通道会被忽略）；如果是字符串，则以"#RRGGBB"代表其RGB值。

options {Object} 选项
选项包括：
region {Array} 找色区域。是一个两个或四个元素的数组。(region[0], region[1])表示找色区域的左上角；region[2]*region[3]表示找色区域的宽高。{如果只有region只有两个元素，则找色区域为(region[0], region[1])到图片右下角。}{如果不指定region选项，则找色区域为整张图片。}
threshold {number} 找色时颜色相似度的临界值，范围为0 ~ 255（越小越相似，0为颜色相等，255为任何颜色都能匹配）。默认为4。threshold和浮点数相似度(0.0~1.0)的换算为 similarity = (255 - threshold) / 255.
该函数也可以作为全局函数使用。
</code></pre>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cs_click</span>(<span class="params">rgb, xr, yr, wr, hr</span>) </span>{</span><br><span class="line">  <span class="keyword">let</span> img = captureScreen()</span><br><span class="line">  <span class="keyword">let</span> point = findColor(img, rgb, {</span><br><span class="line">       <span class="attr">region</span>: [img.getWidth() * xr, img.getHeight() * yr, img.getWidth() * wr, img.getHeight() * hr], <span class="attr">threshold</span>: <span class="number">8</span> })</span><br><span class="line">      <span class="keyword">if</span> (point) {</span><br><span class="line">          point.x = img.getWidth() - point.x; point.y = img.getHeight() - point.y       </span><br><span class="line">          <span class="keyword">return</span> click(point.x, point.y);</span><br><span class="line">      }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置好友数，避免特殊情况一直循环</span></span><br><span class="line">friend_num=<span class="number">6</span>;</span><br><span class="line"><span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;friend_num;i++){</span><br><span class="line">    <span class="keyword">let</span> point = findColor(img, <span class="string">'#1fa071'</span>, {</span><br><span class="line">        <span class="attr">region</span>: [<span class="number">960</span>,<span class="number">400</span>,screen_width-<span class="number">960</span>,<span class="number">1450</span>], <span class="attr">threshold</span>: <span class="number">20</span> })</span><br><span class="line">       <span class="keyword">if</span> (point) {</span><br><span class="line">               </span><br><span class="line">        <span class="comment">//    click(point.x, point.y);</span></span><br><span class="line">           log(<span class="string">'进入好友'</span>+point.x, point.y)</span><br><span class="line">           CollectEnergy();</span><br><span class="line">           back()</span><br><span class="line">           sleep(<span class="number">500</span>)</span><br><span class="line">       }<span class="keyword">else</span>{</span><br><span class="line">           log(<span class="string">'好友能量收集完毕'</span>);</span><br><span class="line">           <span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<h2 id="多点找色点击"><a href="#多点找色点击" class="headerlink" title="多点找色点击"></a>多点找色点击</h2><p>images.findMultiColors(img, firstColor, colors[, options])<br>    img:要找色的图片<br>    firstColor {number | string} 第一个点的颜色<br>    colors {Array} 表示剩下的点相对于第一个点的位置和颜色的数组，数组的每个元素为[x, y, color]<br>    options {Object} 选项，包括：<br>        region {Array} 找色区域。是一个两个或四个元素的数组。<br>        (region[0], region[1])表示找色区域的左上角；region[2]*region[3]表示找色区域的宽高。如果只有region只有两个元素，则找色区域为(region[0], region[1])到图片右下角。如果不指定region选项，则找色区域为整张图片。<br>        threshold {number} 找色时颜色相似度的临界值，范围为0 -255（越小越相似，0为颜色相等，255为任何颜色都能匹配）。默认为4。threshold和浮点数相似度(0.0~1.0)的换算为 similarity = (255 - threshold) / 255.</p>
<p>多点找色,其过程如下：<br>在图片img中找到颜色firstColor的位置(x0, y0)<br>对于数组colors的每个元素[x, y, color]，检查图片img在位置(x + x0, y + y0)上的像素是否是颜色color，是的话返回(x0, y0)，否则继续寻找firstColor的位置，重新执行第1步<br>整张图片都找不到时返回null</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> point = images.findMultiColors(img, <span class="string">"#123456"</span>, [[<span class="number">10</span>, <span class="number">20</span>, <span class="string">"#ffffff"</span>], [<span class="number">30</span>, <span class="number">40</span>, <span class="string">"#000000"</span>]], </span><br><span class="line">{<span class="attr">region</span>: [<span class="number">0</span>, <span class="number">960</span>, device.width, device.height ]});</span><br><span class="line"></span><br><span class="line">toastLog(<span class="string">"x = "</span> + point.x + <span class="string">", y = "</span> + point.y);</span><br><span class="line">click (point.x, point.y)</span><br></pre></td></tr></tbody></table></figure>


<h2 id="ocr点击"><a href="#ocr点击" class="headerlink" title="ocr点击"></a>ocr点击</h2><p><a target="_blank" rel="noopener" href="https://www.yuque.com/yashujs/bfug6u/zxvf79">牙叔识别数字ocr</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/YY007H/article/details/124540297">基于PaddleOCR开发Auto.js Pro文字识别插件</a></p>
<h3 id="百度ocr"><a href="#百度ocr" class="headerlink" title="百度ocr"></a>百度ocr</h3><p>借用外部的ocr识别，拿到字的坐标<br><a target="_blank" rel="noopener" href="https://console.bce.baidu.com/ai/?fromai=1#/ai/ocr/app/list">百度ocr</a></p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//百度OCR 三连发</span></span><br><span class="line"><span class="comment">//ocr1 返回识图结果</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Baidu_ocr</span>(<span class="params">imgFile</span>)</span>{</span><br><span class="line">  log(<span class="string">"识图..."</span>);</span><br><span class="line">  <span class="keyword">var</span> imag64 = images.toBase64(imgFile, <span class="string">"png"</span>, <span class="number">100</span>);</span><br><span class="line">  <span class="keyword">var</span> API_Key=<span class="string">"自己的AK"</span>;</span><br><span class="line">  <span class="keyword">var</span> Secret_Key=<span class="string">"自己的SK"</span>;</span><br><span class="line">  <span class="keyword">var</span> getTokenUrl=<span class="string">"https://aip.baidubce.com/oauth/2.0/token"</span>;<span class="comment">//选择网络图片识别</span></span><br><span class="line">  <span class="keyword">var</span> token_Res = http.post(getTokenUrl, {</span><br><span class="line">      <span class="attr">grant_type</span>: <span class="string">"client_credentials"</span>,</span><br><span class="line">      <span class="attr">client_id</span>: API_Key,</span><br><span class="line">      <span class="attr">client_secret</span>: Secret_Key,</span><br><span class="line">  });</span><br><span class="line">  <span class="keyword">var</span> access_token=token_Res.body.json().access_token;</span><br><span class="line">  <span class="keyword">var</span> ocrUrl = <span class="string">"https://aip.baidubce.com/rest/2.0/ocr/v1/webimage_loc"</span>;</span><br><span class="line">  <span class="keyword">var</span> ocr_Res = http.post(ocrUrl, {</span><br><span class="line">      <span class="attr">headers</span>: {</span><br><span class="line">          <span class="string">"Content - Type"</span>: <span class="string">"application/x-www-form-urlencoded"</span></span><br><span class="line">      },</span><br><span class="line">      <span class="attr">access_token</span>: access_token,</span><br><span class="line">      <span class="attr">image</span>: imag64,</span><br><span class="line">      <span class="attr">language_type</span>:<span class="string">"CHN_ENG"</span><span class="comment">//可添加额外参数</span></span><br><span class="line">  });</span><br><span class="line">  sleep(<span class="number">1000</span>);</span><br><span class="line">  <span class="keyword">var</span> json = ocr_Res.body.json();</span><br><span class="line">  <span class="keyword">return</span> json.words_result;</span><br><span class="line">}</span><br><span class="line"><span class="comment">//OCR2 处理返回结果 并点击</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ocr_click</span>(<span class="params">target_words</span>) </span>{</span><br><span class="line">  <span class="keyword">var</span> imgScreen = captureScreen();</span><br><span class="line">  <span class="keyword">var</span> logOcr= Baidu_ocr(imgScreen);</span><br><span class="line">  <span class="keyword">var</span> target_nums = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; logOcr.length; i++){</span><br><span class="line">      <span class="keyword">if</span>(target_words == logOcr[i].words) {<span class="built_in">console</span>.log(<span class="string">'找到：'</span>+target_words);target_nums = i;<span class="keyword">break</span>;}</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">if</span>(!target_nums) {log(<span class="string">'未找到指定文字'</span>);<span class="keyword">return</span> <span class="literal">false</span>;}</span><br><span class="line">  <span class="keyword">let</span> postion = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line"></span><br><span class="line">  postion[<span class="number">1</span>] = logOcr[target_nums].location.top;</span><br><span class="line">  postion[<span class="number">0</span>] = logOcr[target_nums].location.left;</span><br><span class="line">  sleep(<span class="number">500</span>);</span><br><span class="line"></span><br><span class="line">  click(postion[<span class="number">0</span>], postion[<span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">return</span> postion;</span><br><span class="line">}</span><br><span class="line"><span class="comment">//ocr3.记录所有相同字的位置，目的是为了尽可能的少发送截图请求</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">list_ocr</span>(<span class="params">target_words</span>) </span>{</span><br><span class="line">  sleep(<span class="number">2000</span>);</span><br><span class="line">  <span class="keyword">let</span> img = captureScreen();</span><br><span class="line">  <span class="keyword">let</span> imgScreen = images.clip(img, <span class="number">0</span>, dev_hight/<span class="number">2</span>, dev_width, dev_hight/<span class="number">2</span>);</span><br><span class="line">  <span class="keyword">var</span> logOcr= Baidu_ocr(imgScreen);</span><br><span class="line">  <span class="keyword">let</span> nums_list = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line">  <span class="keyword">let</span> times = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; logOcr.length; i++){</span><br><span class="line">      <span class="keyword">if</span>(target_words == logOcr[i].words) nums_list[times++] = i;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">if</span>(!times) {log(<span class="string">'未找到指定文字'</span>);<span class="keyword">return</span> <span class="literal">false</span>;}</span><br><span class="line">    <span class="keyword">else</span> log(<span class="string">'找到'</span>+times+<span class="string">'个'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> postion = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line">  <span class="keyword">for</span>(k = <span class="number">0</span>; k &lt; times; k++){</span><br><span class="line">    postion[k]=<span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; times; i++){</span><br><span class="line">    postion[i][<span class="number">0</span>] = logOcr[nums_list[i]].location.left;</span><br><span class="line">    postion[i][<span class="number">1</span>] = logOcr[nums_list[i]].location.top;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> postion; </span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h3 id="浩然ocr"><a href="#浩然ocr" class="headerlink" title="浩然ocr"></a>浩然ocr</h3><p>ocrResult.frame<br>{List} 识别结果的位置<br>识别结果为一个任意四边形，返回的是长度为8的整形列表。 分别为四个顶点的横纵坐标，即[x1,y1,x2,y2,x3,y3,x4,y4]。<br>[左上，右上，右下，左下]</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">HaoranOcrClick(<span class="string">'订阅号'</span>)</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HaoranOcrClick</span>(<span class="params">target</span>) </span>{</span><br><span class="line">    <span class="keyword">let</span> ocr = $plugins.load(<span class="string">"com.hraps.ocr"</span>);</span><br><span class="line">    GetScreenCapture()</span><br><span class="line">    sleep(<span class="number">500</span>)</span><br><span class="line">    <span class="comment">//识别图片</span></span><br><span class="line">    results = ocr.detect(captureScreen().getBitmap(), <span class="number">1</span>)     <span class="comment">//缩放比率</span></span><br><span class="line">    <span class="built_in">console</span>.show()</span><br><span class="line">    <span class="built_in">console</span>.info(<span class="string">"过滤前结果数："</span> + results.size())</span><br><span class="line">    <span class="comment">//识别结果过滤</span></span><br><span class="line">    results = ocr.filterScore(results, <span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">0.5</span>)</span><br><span class="line">    <span class="comment">//输出最终结果</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; results.size(); i++) {</span><br><span class="line">        <span class="keyword">var</span> re = results.get(i)</span><br><span class="line">        <span class="keyword">let</span> t = re.text   <span class="comment">//识别出的文字</span></span><br><span class="line">        <span class="keyword">let</span> p = re.frame  <span class="comment">//位置</span></span><br><span class="line">        <span class="keyword">for</span> (j=<span class="number">0</span> ;j&lt;target.length;j++){    </span><br><span class="line">            <span class="comment">//判断每个字符都在识别结果内   </span></span><br><span class="line">            <span class="keyword">var</span> pan = re.text .includes(target[j])</span><br><span class="line">            <span class="keyword">if</span>(!pan){</span><br><span class="line">                log(<span class="string">'目标字符不在识别结果内'</span>);           </span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            }<span class="keyword">else</span>{</span><br><span class="line">                <span class="keyword">var</span> a=j+<span class="number">1</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            }  </span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span>(a==target.length){</span><br><span class="line">            <span class="keyword">let</span> x = p[<span class="number">0</span>] + (p[<span class="number">2</span>] - p[<span class="number">0</span>]) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">let</span> y = p[<span class="number">1</span>] + (p[<span class="number">5</span>] - p[<span class="number">1</span>]) / <span class="number">2</span>;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'全部找到文字准备点击：'</span> + t + <span class="string">"\n其中心坐标是"</span> + x, y);</span><br><span class="line">            click(x, y);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">    }      </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="坐标点击"><a href="#坐标点击" class="headerlink" title="坐标点击"></a>坐标点击</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>: 纯粹设置坐标点击</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">{*}</span> <span class="variable">x</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">{*}</span> <span class="variable">y</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">{*}</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CoordClick</span>(<span class="params">x,y</span>)</span>{</span><br><span class="line">    click(x+random(-<span class="number">20</span>,<span class="number">20</span>),y+random(-<span class="number">20</span>,<span class="number">20</span>))</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'成功点击'</span>+x,y )</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<h2 id="轮廓识别"><a href="#轮廓识别" class="headerlink" title="轮廓识别"></a>轮廓识别</h2><p>图色的高级版</p>
<h2 id="直接点击字符"><a href="#直接点击字符" class="headerlink" title="直接点击字符"></a>直接点击字符</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 直接点击字符</span></span><br><span class="line">click(<span class="string">"str"</span>,index);                   <span class="comment">//点击第index个字符"str"(因为有时str会出现多次，另外注意下标从0开始)</span></span><br></pre></td></tr></tbody></table></figure>
<h1 id="意图"><a href="#意图" class="headerlink" title="意图"></a>意图</h1><p><a target="_blank" rel="noopener" href="https://www.cr173.com/soft/824332.html">Activity管理器下载地址</a></p>
<h2 id="Scheme"><a href="#Scheme" class="headerlink" title="Scheme"></a>Scheme</h2><p>Android中的Scheme是一种页面跳转协议，和网站通过URL的形式访问一样，APP同样可以通过这种方式进行跳转<br>scheme地址，可以直接打开app的某个页面</p>
<h2 id="intent跳转"><a href="#intent跳转" class="headerlink" title="intent跳转"></a>intent跳转</h2><p><a target="_blank" rel="noopener" href="https://www.helloworld.net/p/1797278347">Autojs的intent使用</a><br>intent拦截者 simpleHook 两个软件抓意图<br><a target="_blank" rel="noopener" href="http://www.feiyunjs.com/1440.html">安卓APP通用的intent跳转协议，scheme地址寻找方法与auto.js调用</a><br>intent跳转只需要找到相关的参数，就可以直接打开指定的页面。<br><strong>前提</strong><br>如果APP里的页面，是不能分享的，那么基本可以认为这个页面是没有scheme地址的。</p>
<h2 id="使用intent打开新浪微博的用户任务中心scheme"><a href="#使用intent打开新浪微博的用户任务中心scheme" class="headerlink" title="使用intent打开新浪微博的用户任务中心scheme"></a>使用intent打开新浪微博的用户任务中心scheme</h2><p>首先在手机上手动进入新浪微博的任务中心。点击页面右上角的“…”，弹出分享卡片。点击“复制链接”。在电脑的浏览器里，打开这个链接.点击“我要领取”，进入新的页面。</p>
<p>查看页面的html代码，页面的body有这样一段：</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://c.weibo.cn?scheme=sinaweibo%3A%2F%2Fbrowser%3Furl%3Dhttps%253A%252F%252Fm.weibo.cn%252Fc%252Fcheckin%253Ffeaturecode%253Dfrom_sharingpage_to_mtask%2526luicode%253D20000061%2526lfid%253D180%26featurecode%3Dfrom_sharingpage_to_mtask%26luicode%3D20000061%26lfid%3D180&amp;directdownload=0"</span> <span class="attr">class</span>=<span class="string">"m-btn m-btn-block m-btn-orange download-btn-r"</span> <span class="attr">ontouchstart</span>=<span class="string">""</span>&gt;</span>去下载微博<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>这个url里，存在scheme这个关键字。我们把scheme后面的地址提取出来。<br><code>sinaweibo%3A%2F%2Fbrowser%3Furl%3Dhttps%253A%252F%252Fm.weibo.cn%252Fc%252Fcheckin%253Ffeaturecode%253Dfrom_sharingpage_to_mtask%2526luicode%253D20000061%2526lfid%253D180%26featurecode%3Dfrom_sharingpage_to_mtask%26luicode%3D20000061%26lfid%3D180&amp;directdownload=0</code><br>[]URL编码/解码工具(<a target="_blank" rel="noopener" href="https://tool.chinaz.com/tools/urlencode.aspx">https://tool.chinaz.com/tools/urlencode.aspx</a>)</p>
<p>选择“URL编码/解码”，将scheme地址，进行一次“UrlDecode解码”。可以看到开头部分的“%3A%2F%2F”已经被转换成了“://”</p>
<p>接下来使用auto.js的Intent（意图），来测试这个scheme地址。<br>auto.js提供了构建Intent的函数app.intent(), 启动Activity的函数app.startActivity(), 发送广播的函数app.sendBroadcast()。使用这些方法可以用来方便的调用其他应用。</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.startActivity({</span><br><span class="line">    <span class="attr">data</span>:<span class="string">"sinaweibo://browser?url=https%3A%2F%2Fm.weibo.cn%2Fc%2Fcheckin%3Ffeaturecode%3Dfrom_sharingpage_to_mtask%26luicode%3D20000061%26lfid%3D180&amp;featurecode=from_sharingpage_to_mtask&amp;luicode=20000061&amp;lfid=180&amp;directdownload=0"</span></span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>
<h2 id="app-intent"><a href="#app-intent" class="headerlink" title="app.intent()"></a>app.intent()</h2><p>构建Intent的函数</p>
<h2 id="启动服务-Service-："><a href="#启动服务-Service-：" class="headerlink" title="启动服务(Service)："></a>启动服务(Service)：</h2><p>Service 是一个不使用用户界面而在后台执行操作的组件。通过将 Intent 传递给 startService()，您可以启动服务执行一次性操作（例如，下载文件）。Intent 描述了要启动的服务，并携带了任何必要的数据。</p>
<h2 id="传递广播："><a href="#传递广播：" class="headerlink" title="传递广播："></a>传递广播：</h2><p>app.sendBroadcast()<br>广播是任何应用均可接收的消息。系统将针对系统事件（例如：系统启动或设备开始充电时）传递各种广播。通过将 Intent 传递给 sendBroadcast()、sendOrderedBroadcast() 或 sendStickyBroadcast()，您可以将广播传递给其他应用。</p>
<h2 id="直达应用内的某个页面——启动Activity"><a href="#直达应用内的某个页面——启动Activity" class="headerlink" title="直达应用内的某个页面——启动Activity"></a>直达应用内的某个页面——启动Activity</h2><p>Activity (应用程序活动)分割了应用中不同的界面和功能（例如微信的主界面、朋友圈、聊天窗口都是不同的Activity），通过Activity可以直接进入应用的特定界面，而不仅仅是启动应用</p>
<p>在Auto.js中，启动Activity有两种方法：</p>
<h3 id="用app-startActivity"><a href="#用app-startActivity" class="headerlink" title="用app.startActivity"></a>用app.startActivity</h3><p>app.startActivity()<br>启动活动(Activity)：<br> Activity 表示应用中的一个”屏幕”。</p>
<p>例如应用主入口都是一个Activity，应用的功能通常也以Activity的形式独立，例如微信的主界面、朋友圈、聊天窗口都是不同的Activity。通过将 Intent 传递给 startActivity()，您可以启动新的 Activity 实例。Intent 描述了要启动的 Activity，并携带了任何必要的数据。</p>
<p>但无论用哪种方法，启动Activity都离不开Intent这个工具</p>
<blockquote>
<p>Intent(意图)，Intent是一个消息传递对象，Android中提供了Intent来协助应用间的交互与通讯。</p>
</blockquote>
<p>其用途一般有三种：</p>
<ul>
<li>启动活动(Activity)：通过活动可以直达应用内的某个页面</li>
<li>通过startActivity(Intent)，可以隐式启动新的 Activity 实例，其中Intent 描述了要启动的 Activity</li>
<li>启动服务(Service)：不使用用户界面，而在后台执行操作的组件</li>
<li>通过 startService(Intent)可以启动Service，其中Intent 描述了要启动的服务Service</li>
<li>传递广播(Broadcast)： 广播是任何应用均可接收的消息，通过 sendBroadcast(Intent )可以将广播传递给其他应用</li>
</ul>
<blockquote>
<p>app.startActivity(options) 启动Activity</p>
</blockquote>
<p>在Auto.js中，提供了与Intent(意图) 相关的进阶函数startActivity和sendBroadcast，它们可完成app模块没有内置的应用交互功能</p>
<p>app.startActivity(options)根据options选项构造一个Intent对象，并启动相应的Activity</p>
<p>其中，options选项有：</p>
<ul>
<li>action {string} 要完成的动作，如”android.intent.action.SEND”</li>
<li>ps. 当action以”android.intent.action”开头时，可以省略前缀，直接用”SEND”</li>
<li>category {Array} 意图的类别，比较少用</li>
<li>packageName {string} 目标包名</li>
<li>className {string} 目标Activity或Service等组件的名称</li>
<li>type {string} 表示和该意图直接相关的数据的类型，如”text/plain”为纯文本类型</li>
<li>data {string}如要打开一个文件, action为”android.intent.action.VIEW”, data为”file:///sdcard/1.txt”。</li>
<li>extras {Object} 额外信息,如发送邮件时的邮件标题、邮件正文</li>
<li>flags {Array} intent的标识，字符串数组，例如[“activity_new_task”, “grant_read_uri_permission”]</li>
<li>root {Boolean} 是否以root权限启动、发送该intent</li>
</ul>
<blockquote>
<p>options(即intent的参数)如何获取？</p>
</blockquote>
<p>className（即Activity）、packageName通过Auto.js自带的布局分析获取<br>category、action等可以通过例如”intent记录”，”隐式启动”等应用拦截内部intent或者查询暴露的intent。<br>下载<br><a target="_blank" rel="noopener" href="https://www.coolapk.com/apk/xyz.hanks.launchactivity">https://www.coolapk.com/apk/xyz.hanks.launchactivity</a><br>其中拦截内部intent需要XPosed框架，或者可以通过反编译等手段获取参数。总之，没有简单直接的方法。<br>举个例子：</p>
<p>例如，在某界面用Auto.js查询到应用包名com.netease.buff，当前活动</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">com.netease.buff.userCenter.pushSetting.PushSettingsActivity</span><br><span class="line">又使用“隐式启动”应用查询到Intent为</span><br><span class="line">Intent {</span><br><span class="line">act=android.intent.action.MAIN</span><br><span class="line">cat=[android.intent.category.NOTIFICATION_PREFERENCES]</span><br><span class="line">flg=<span class="number">0x14000040</span></span><br><span class="line">cmp=com.netease.buff/.userCenter.pushSetting.PushSettingsActivity</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gotoOptions</span>(<span class="params"></span>) </span>{<span class="comment">//打开设置页面</span></span><br><span class="line">    app.startActivity({</span><br><span class="line">        <span class="attr">action</span>: <span class="string">"android.intent.action.MAIN"</span>,</span><br><span class="line">        <span class="attr">packageName</span>: <span class="string">"com.netease.buff"</span>,</span><br><span class="line">        <span class="attr">className</span>: <span class="string">"com.netease.buff.userCenter.pushSetting.PushSettingsActivity"</span>,</span><br><span class="line">        <span class="attr">category</span>: [android.intent.category.NOTIFICATION_PREFERENCES]</span><br><span class="line">    });</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">}</span><br><span class="line">gotoOptions();</span><br></pre></td></tr></tbody></table></figure>

<p>注意，此方法有一个限制和缺点，使用此方法，填入的action必须满足android.intent.action.XXX 的格式</p>
<p>例如有时，在“隐式启动”应用中，得到的intent信息如下：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Intent {</span><br><span class="line">act=DELIVERY</span><br><span class="line">flg=<span class="number">0x14000040</span></span><br><span class="line">cmp=com.netease.buff/.entry.SplashActivity</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>若继续将这里的DELIVERY 填入action，则会出错（因为上面介绍过，如果写action: “DELIVERY”，将会被startActivity自动补全为action: “android.intent.action.DELIVERY”，然而很明显没有这个action）</p>
<h3 id="用Shell命令（似乎后一种更简洁方便）"><a href="#用Shell命令（似乎后一种更简洁方便）" class="headerlink" title="用Shell命令（似乎后一种更简洁方便）"></a>用Shell命令（似乎后一种更简洁方便）</h3><p>我们另寻出路：因为给出了cmp（即component）参数，可尝试用用Shell命令启动Activity<br>打开应用或Activity的另一种方法是：通过AndroidStudio的Shell命令</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell('am start -p com.tencent.mm');</span><br></pre></td></tr></tbody></table></figure>

<p>启动微信，这里使用了Shell命令中的am命令，shell即Unix Shell，是在类Unix系统提供的一系列命令。<br>在Auto.js大致等同于用adb执行命令”adb shell”，有两种执行shell命令的方式：</p>
<ul>
<li>shell函数：一次性执行单条命令。<br>  一般格式shell(cmd[, root])，[root]{Boolean} 表示是否以root权限运行，默认为false</li>
<li>Shell对象：一般用于需要执行多条命令的情况，这时Shell对象效率更高。（因为每次运行shell函数都会打开一个单独的shell进程，而Shell对象自始至终使用同一个shell进程）<br>  一般格式new Shell(root)、Shell.exec(cmd)、Shell.exit()等，详见官方文档</li>
<li>Shell之am命令：Activity Manager<br>  am命令即Activity Manager命令，用于管理应用程序活动、服务等。<br>  以下命令均以”am “开头，例如shell(‘am start -p com.tencent.mm’);</li>
<li>start [options] intent：启动 intent 指定的 Activity<br>  option常用参数（可以不填）：参见官方文档；<br>  intent常用参数：<ul>
<li>a action</li>
<li>n component，指定组件名称，如“com.example.app/.ExampleActivity”，注意，这里的component参数是上面的startActivity所没有的，这个参数的获取来自于“隐式启动”应用中”cmp”的值</li>
<li>c category</li>
<li>f flags</li>
<li>t Mime_type<br>  d data_uri</li>
</ul>
</li>
</ul>
<p>举个例子：</p>
<p>在“隐式启动”应用中，得到的intent信息如下：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Intent {</span><br><span class="line">act=DELIVERY</span><br><span class="line">flg=<span class="number">0x14000040</span></span><br><span class="line">cmp=com.netease.buff/.entry.SplashActivity</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>故对应的Shell命令如下</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell(<span class="string">'am start -a DELIVERY -f 0x14000040 -n com.netease.buff/.entry.SplashActivity'</span>);</span><br></pre></td></tr></tbody></table></figure>

<p>法一转换为法二<br>另外，可以用法一中的option来构造一个Intent，并转换为对应的shell的intent命令的参数——app.intentToShell(options)，示例</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">shell("am start " + app.intentToShell({</span><br><span class="line">packageName: “org.autojs.autojs”,</span><br><span class="line">className: “org.autojs.autojs.ui.settings.SettingsActivity_”</span><br><span class="line">}), true);</span><br></pre></td></tr></tbody></table></figure>




<h2 id="微信意图"><a href="#微信意图" class="headerlink" title="微信意图"></a>微信意图</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//跳转扫一扫</span></span><br><span class="line">context.startActivity(app.intent({</span><br><span class="line">    <span class="attr">action</span>: <span class="string">"VIEW"</span>,</span><br><span class="line">    <span class="attr">className</span>:<span class="string">"com.tencent.mm.ui.LauncherUI"</span>,</span><br><span class="line">    <span class="attr">packageName</span>:<span class="string">"com.tencent.mm"</span>,</span><br><span class="line">    <span class="attr">extras</span>: {</span><br><span class="line">        <span class="string">"LauncherUI.From.Scaner.Shortcut"</span>: <span class="literal">true</span></span><br><span class="line">    }</span><br><span class="line">}).setFlags(<span class="number">335544320</span>));</span><br></pre></td></tr></tbody></table></figure>
<h2 id="支付宝意图"><a href="#支付宝意图" class="headerlink" title="支付宝意图"></a>支付宝意图</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//跳转支付宝页面</span></span><br><span class="line">app.startActivity({</span><br><span class="line">    <span class="attr">packageName</span>: <span class="string">'com.eg.android.AlipayGphone'</span>,</span><br><span class="line">    <span class="attr">action</span>: <span class="string">"VIEW"</span>,</span><br><span class="line">    <span class="attr">data</span>:<span class="string">"alipays://platformapi/startapp?saId=20000167"</span>,</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 小程序</span></span><br><span class="line"><span class="comment"> * 修改上面的saId即可</span></span><br><span class="line"><span class="comment"> * 60000002 蚂蚁森林</span></span><br><span class="line"><span class="comment"> * 20000008 跳转支付宝登录界面</span></span><br><span class="line"><span class="comment"> * 20000141 跳转修改名字</span></span><br><span class="line"><span class="comment"> * 20000031 跳转修改头像</span></span><br><span class="line"><span class="comment"> * 20000116 跳转支付宝付款</span></span><br><span class="line"><span class="comment"> * 60000006 附近优惠</span></span><br><span class="line"><span class="comment"> * 60000012 中小学</span></span><br><span class="line"><span class="comment"> * 60000023 蚂蚁保险</span></span><br><span class="line"><span class="comment"> * 60000024 彩票游戏,不对所有用户开放</span></span><br><span class="line"><span class="comment"> * 60000029 口碑排行榜</span></span><br><span class="line"><span class="comment"> * 60000032 添加第一张证件 各类证件齐管理</span></span><br><span class="line"><span class="comment"> * 60000033 in贴纸商城</span></span><br><span class="line"><span class="comment"> * 60000039 超值抢购</span></span><br><span class="line"><span class="comment"> * 60000040 未来酒店</span></span><br><span class="line"><span class="comment"> * 60000044 权益区 无法加载</span></span><br><span class="line"><span class="comment"> * 60000047 校园头条 无法加载,可能缺少参数</span></span><br><span class="line"><span class="comment"> * 60000052 手机通讯录备份 未对所有用户开放</span></span><br><span class="line"><span class="comment"> * 60000057 阿里宝卡</span></span><br><span class="line"><span class="comment"> * 60000071 天天有料</span></span><br><span class="line"><span class="comment"> * 60000076 VIP预约服务 无法加载,可能我不是VIP的原因</span></span><br><span class="line"><span class="comment"> * 60000077 优酷会员首页</span></span><br><span class="line"><span class="comment"> * 60000081 商家服务</span></span><br><span class="line"><span class="comment"> * 60000091 花呗</span></span><br><span class="line"><span class="comment"> * 60000103 支付周奖励金列表页</span></span><br><span class="line"><span class="comment"> * 60000105 我的银行卡 管理页</span></span><br><span class="line"><span class="comment"> * 60000120 福员外 不知道干嘛的</span></span><br><span class="line"><span class="comment"> * 60000125 租房</span></span><br><span class="line"><span class="comment"> * 60000126 余额宝</span></span><br><span class="line"><span class="comment"> * 60000130 淘票票</span></span><br><span class="line"><span class="comment"> * 60000134 外币兑换 服务正在升级</span></span><br><span class="line"><span class="comment"> * 60000135 飞猪汽车票</span></span><br><span class="line"><span class="comment"> * 60000145 阿里巴巴认证中心</span></span><br><span class="line"><span class="comment"> * 60000146 寄快递</span></span><br><span class="line"><span class="comment"> * 60000148 财富号</span></span><br><span class="line"><span class="comment"> * 60000150 我的口碑</span></span><br><span class="line"><span class="comment"> * 60000153 注销账号 注销支付宝账号用的</span></span><br><span class="line"><span class="comment"> * 60000154 AA收款</span></span><br><span class="line"><span class="comment"> * 60000155 共享单车</span></span><br><span class="line"><span class="comment"> * 60000156 支付宝红包~这个应该也是缺少参数</span></span><br><span class="line"><span class="comment"> * 60000160 稳健收益  应该是理财类的东西 </span></span><br><span class="line"><span class="comment"> * 60000161 蚂蚁会员周周乐</span></span><br><span class="line"><span class="comment"> * 60000162 彩虹星愿 应该是教育孩子的</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>







<h1 id="Rhino引擎"><a href="#Rhino引擎" class="headerlink" title="Rhino引擎"></a>Rhino引擎</h1><p><a target="_blank" rel="noopener" href="https://pro.autojs.org/docs/#/zh-cn/?id=%e7%bb%bc%e8%bf%b0">官方文档</a></p>
<p><a target="_blank" rel="noopener" href="https://www.yuque.com/yashujs/bfug6u/ogik4f">史上最全的autojs代码仓库</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/kangour/autojs_sdk">autojs代码：</a><br><a target="_blank" rel="noopener" href="https://www.yuque.com/yashujs/bfug6u">牙叔教程</a><br><a target="_blank" rel="noopener" href="https://www.yuque.com/yashujs/bfug6u/un3rk3#mVgln">autojs非常见函数</a><br><a target="_blank" rel="noopener" href="https://www.yuque.com/yashujs/bfug6u/ittz45">autojs-修改java代码-为我所用</a><br>Appium 和 Airtest 编写的自动化脚本都依赖于 PC 端运行，没有办法直接运行在移动端；无障碍服务需要单独创建一个 Android 项目，没有完整的使用文档，使用起来有一定的门槛</p>
<p>AutoJS 它通过编写 JavaScript 脚本，结合系统的「 无障碍服务 」对 App 进行自动化操作<br>脚本文件体积小，可以打包成 APK 直接安装<br>拥有丰富的 UI 组件用于构建 GUI 界面<br>非 Root 设备也能完成自动化操作，可以摆脱 PC 直接运行<br>提供多种元素定位方式，可以适配各种机型<br>官方文档非常详细，学习成本低</p>
<p>Auto.JS作为一款基于JavaScript语言的一款脚本，基本语法和结构可通过学习JavaScript来了解。要知道，安卓的app界面就是由一堆控件组成的，这些父子控件相互嵌套，组成了我们熟悉的app界面，因此，你要执行自动化操作，那么最常用的就是先精确的找到这个控件(唯一性)，再来说下一步对其进行操作，而我个人认为Auto.JS之所以方便好用，最大的一点就是查找你想要操作的控件(包括但不限于点击、设置文本等)时特别方便明了，一眼就能看懂并能迅速定位。因为Auto.JS是基于JavaScript的语言，因此基本的语法结构、很多两者通用的函数等都是可以在JavaScript里面找到，如常见的“.replace()”“.indexof()”“.test()”等这些都在JavaScript网站上有相关的用法说明</p>
<h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><h3 id="vscode插件"><a href="#vscode插件" class="headerlink" title="vscode插件"></a>vscode插件</h3><p>Auto.js-VSCodeExt</p>
<p>Auto.js-VSCodeExt-Fixed<br>对插件 Auto.js-VSCodeExt 进行了部分优化</p>
<p>Autojs Clipboard<br>同步手机剪贴板到电脑剪贴板</p>
<p>然后，使用 VS Code 快捷键「 Ctrl/Command + Shift + P 」，选择「 Auto.js:Start Server 」开启 AutoJS 服务</p>
<p>在同一wifi下无法连接，手机开热点给电脑，即可连接</p>
<h3 id="Auto-js-Pro-Ext-1-4"><a href="#Auto-js-Pro-Ext-1-4" class="headerlink" title="Auto.js-Pro-Ext 1.4"></a>Auto.js-Pro-Ext 1.4</h3><p>开启代码提示</p>
<p>进入以下文件夹：C:\Users\用户名.vscode\extensions\hyb1996.auto-js-pro-ext-1.3.2\assets\project-templates\v8-default<br>拷贝这两个文件到你的项目目录：node_modules,tsconfig.json</p>
<h3 id="scrcpy投屏"><a href="#scrcpy投屏" class="headerlink" title="scrcpy投屏"></a>scrcpy投屏</h3><p><a target="_blank" rel="noopener" href="https://github.com/Genymobile/scrcpy">Github地址</a></p>
<p>手机数据线连接电脑后，开启usb调试，自动连接</p>
<p>鼠标右键是返回</p>
<p>要想卸载scrcpy,先在目录下进入cmd,输入adb kill-server,再删除整个scrcpy文件即可</p>
<p>adb功能异常，重启adb<br>（1）把adb服务杀死：adb kill-server<br>（2）重启adb服务：adb reconnect</p>
<h3 id="结合webditor"><a href="#结合webditor" class="headerlink" title="结合webditor"></a>结合webditor</h3><p>autojs本身就有布局分析，但不一定所有手机都能用，使用weditor进行布局分析</p>
<p><a target="_blank" rel="noopener" href="https://github.com/openatx/weditor">weditor 地址</a></p>
<p>先把weditor安装好并运行起来。然后：</p>
<p>.设备通过USB线连接电脑。<br>在cmd命令行中输入adb tcpip 5555<br>拔掉数据线<br>在cmd命令行中输入adb connect 192.168.1.5(设备在局域网中的ip)<br>在weditor 网页中输入手机的ip并且点击Connect连接</p>
<p>连接成功后，点击“Dump Hierarchy” 获取最新的界面。这里以微信为例，然后我们会看到布局分析，点击我们需要操作的控件，可以获取到resourceId、className、text等信息，然后我们运用autojs进行操作。 </p>
<h2 id="shell命令"><a href="#shell命令" class="headerlink" title="shell命令"></a>shell命令</h2><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">点击 input tap X Y</span><br><span class="line">长按250ms input swipe X1 Y1 X1 Y1 250</span><br><span class="line">划屏250ms input swipe X1 Y1 X2 Y2 250</span><br><span class="line">输入文本 input text 文本</span><br><span class="line"></span><br><span class="line">②</span><br><span class="line">安装apk pm install &lt;apk位置&gt;</span><br><span class="line">卸载apk pm uninstall &lt;包名&gt;</span><br><span class="line">隐藏应用pm hide &lt;包名&gt;</span><br><span class="line">显示应用pm unhide	&lt;包名&gt;</span><br><span class="line">停止应用 am force-stop 包名</span><br><span class="line"></span><br><span class="line">③</span><br><span class="line">am start -n 包名/包名＋类名（-n 类名,-a action,-d date,-m MIME-TYPE,-c category,-e 扩展数据,等）</span><br><span class="line">(这个是可玩性最强的，可以设置在打开应用时运行该命令来达到跳广告，其他还有很多，我也正在研究中)</span><br><span class="line">跳广告例子：打开优酷时触发(当然也可以用活动触发，但是得找到这个活动)</span><br><span class="line">am start -n com.youku.phone/com.youku.phone.com.youku.HomePageEntry</span><br><span class="line">就可以跳广告</span><br><span class="line">注：应用包名可以用 【酷安】 的应用管理找或者用其他的都可以</span><br><span class="line">活动名称可以用 【开发者助手】 来找</span><br><span class="line"></span><br><span class="line">④</span><br><span class="line">打开网址(默认浏览器) am start -a android.intent.action.VIEW -d 网址</span><br><span class="line">微信打开网址</span><br><span class="line">am start -n com.tencent.mm/com.tencent.mm.plugin.webview.ui.tools.WebViewUI -d 网址</span><br><span class="line"></span><br><span class="line">⑤</span><br><span class="line">打开桌面图标(比如桌面的快捷方式、小程序等)</span><br><span class="line">am start "intent:@" (@是/data/data/com.miui.home/databases/launcher5x6.db里的图标对应的intent值</span><br><span class="line"></span><br><span class="line">⑥</span><br><span class="line">关机 shutdown</span><br><span class="line">重启 reboot</span><br></pre></td></tr></tbody></table></figure>
<h2 id="opencv-autojs常用命令"><a href="#opencv-autojs常用命令" class="headerlink" title="opencv-autojs常用命令"></a>opencv-autojs常用命令</h2><p><a target="_blank" rel="noopener" href="https://www.yuque.com/yashujs/bfug6u/yur8h8">https://www.yuque.com/yashujs/bfug6u/yur8h8</a></p>
<h2 id="小技巧"><a href="#小技巧" class="headerlink" title="小技巧"></a>小技巧</h2><h3 id="autojs提取软件自带例子"><a href="#autojs提取软件自带例子" class="headerlink" title="autojs提取软件自带例子"></a>autojs提取软件自带例子</h3><p>通过mt管理器点击autojspro的安装包，然后点击查看，依次打开assets/sample/中文，这就是例子文件。<br>然后长按文件夹解压到任意目录</p>
<p>如果没有mt管理器，可以直接将autojspro.apk的后缀改成.zip,当成压缩包来提取文件。</p>
<p>快捷打开无障碍，长按两个音量键三秒</p>
<p>如何打开控制台<br>依次点击 帮助—–切换开发者工具——console</p>
<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>查找控件存不存在使用exists ()。一般情况下Autojs生成的代码是：if (text(“刷视频赚”).exists()) {}，不建议这样写，有很多时候找不到或者是有多个文字一样的内容故：let earnVideo= className(“android.widget.TextView”).text(“刷视频赚”).findOnce();这样写准确率更高。</p>
<p>为什么有时候launchApp(‘应用名’);会失效<br>第一,这是因为你手机存在同名软件.找不到你想要的app，要使用launch(‘应用包名’)。第二,是因为你没有给软件(后台弹出界面)权限</p>
<p>如果有界面，那么监听通知需要放在线程里。<br>webview 注入js的js文件需要改后缀，如果还是js,会被加密导致无法使用<br>webview 内页面引用静态文件可以使用相对路径<br>如果多次调用 even.on，event.emit 会触发多次。可以用 even.removeAllListeners进行清除。<br>console.show 调用时范围只是当前线程。<br>不要在UI线程内死循环，要重新开启一个线程，不然会卡死<br>无障碍服务权限申请可以使用auto,直接跳转到设置页。<br>通知使用服务第一次调用后会提示一次之后，如果没有给予权限。大概率不再弹窗，并且不会报错。如果一直没有给权限，而且无法弹窗需要引导用户手动开启，并重启脚本。</p>
<h3 id="支付宝-微信-其他软件"><a href="#支付宝-微信-其他软件" class="headerlink" title="支付宝/微信/其他软件"></a>支付宝/微信/其他软件</h3><p>在使用autojs时，遇到支付宝和微信以及一些安全意识较强的平台，很难获取到其页面的控件，无论你是使用autojs自带的控件分析<br>或是Android studio的uiautomatorviewer.bat来分析它们的页面控件，都会分析到。但是你在获取的时侯就会发现根本获取不到，</p>
<p>原因<br>支付宝和微信都把它们的控件藏起来了，可能是封装成某个类型，那个类型的输出就是空行。</p>
<p>我的方法是获取其控件后在其末尾加了个string，使得整个内容强转成string。</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> meId2 = id(<span class="string">"XXX"</span>).find()+<span class="string">""</span>;<span class="comment">//找到id为XXX的控件，然后加上空字符串</span></span><br><span class="line"><span class="comment">//整个类型现在变成string，现在就可以用字符串截取的方式来获取控件的信息了。</span></span><br></pre></td></tr></tbody></table></figure>

<p>//pro9基本无法使用，低版本可以<br>while(!click(“智慧广工商”));</p>
<p>click(“智慧广工商”)</p>
<h2 id="http-put"><a href="#http-put" class="headerlink" title="http put"></a>http put</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">http</span><br><span class="line">  .request(url, {</span><br><span class="line">    <span class="attr">method</span>: <span class="string">"PUT"</span>,</span><br><span class="line">    <span class="attr">body</span>: <span class="built_in">JSON</span>.stringify({</span><br><span class="line">      <span class="attr">access_token</span>: access_token,</span><br><span class="line">      <span class="attr">content</span>: android.util.Base64.encodeToString(files.readBytes(path), <span class="number">2</span>),</span><br><span class="line">      <span class="attr">sha</span>: fileinfo.sha,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">"更新文件"</span>,</span><br><span class="line">    }),</span><br><span class="line">    <span class="attr">headers</span>: {</span><br><span class="line">      <span class="string">"Content-Type"</span>: <span class="string">"application/json;charset=UTF-8"</span>,</span><br><span class="line">    },</span><br><span class="line">  })</span><br><span class="line">  .body.json();</span><br></pre></td></tr></tbody></table></figure>


<h2 id="事件与监听-Events"><a href="#事件与监听-Events" class="headerlink" title="事件与监听 - Events"></a>事件与监听 - Events</h2><h2 id="控制台-Console"><a href="#控制台-Console" class="headerlink" title="控制台 - Console"></a>控制台 - Console</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 新线程中启动控制台</span></span><br><span class="line">threads.start(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">    <span class="keyword">if</span> (isShowConsole) {</span><br><span class="line">        <span class="built_in">console</span>.show();</span><br><span class="line">    }</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line"><span class="comment">//显示控制台</span></span><br><span class="line"><span class="built_in">console</span>.show();</span><br><span class="line"><span class="built_in">console</span>.verbose(<span class="string">"这是灰色"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"这是黑色"</span>);</span><br><span class="line"><span class="built_in">console</span>.info(<span class="string">"这是红色"</span>);</span><br><span class="line"><span class="built_in">console</span>.warn(<span class="string">"这是蓝色"</span>);</span><br><span class="line"><span class="built_in">console</span>.error(<span class="string">"这是绿色=_="</span>);</span><br><span class="line"><span class="built_in">console</span>.trace(<span class="string">"打印日志行数"</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.setSize(<span class="number">1000</span>, <span class="number">1000</span>);<span class="comment">//调整大小</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.setPosition(<span class="number">0</span>, <span class="number">500</span>); <span class="comment">//调整位置</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.hide();   <span class="comment">//隐藏</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 保存日志</span></span><br><span class="line"><span class="built_in">console</span>.setGlobalLogConfig({</span><br><span class="line">    <span class="attr">file</span>: <span class="string">"/sdcard/脚本/log.txt"</span></span><br><span class="line">});</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.time(<span class="string">"保存截图的时间"</span>);</span><br><span class="line">images.save(img, <span class="string">"/sdcard/3.png"</span>);</span><br><span class="line"><span class="built_in">console</span>.timeEnd(<span class="string">"保存截图的时间"</span>);</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<h2 id="本地储存-Storages"><a href="#本地储存-Storages" class="headerlink" title="本地储存 - Storages"></a>本地储存 - Storages</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 保存数组和对象</span></span><br><span class="line"><span class="keyword">var</span> storage = storages.create(<span class="string">"Auto.js例子:复杂数据"</span>);</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">var</span> obj = {</span><br><span class="line">    <span class="attr">name</span>: <span class="string">"Auto.js"</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">"www.autojs.org"</span></span><br><span class="line">};</span><br><span class="line"><span class="comment">//保存</span></span><br><span class="line">storage.put(<span class="string">"arr"</span>, arr);</span><br><span class="line">storage.put(<span class="string">"obj"</span>, obj);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.show();</span><br><span class="line"><span class="comment">//取出</span></span><br><span class="line">log(<span class="string">"arr = "</span>, storage.get(<span class="string">"arr"</span>));</span><br><span class="line">log(<span class="string">"obj = "</span>, storage.get(<span class="string">"obj"</span>));</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<h2 id="图片与颜色"><a href="#图片与颜色" class="headerlink" title="图片与颜色"></a>图片与颜色</h2><p><a target="_blank" rel="noopener" href="https://www.yuque.com/yashujs/bfug6u/gws4dp">autojs之内存泄露</a><br><a target="_blank" rel="noopener" href="https://gitee.com/yiszza/ScriptGraphicHelper#https://gitee.com/yiszza/ScriptGraphicHelper/releases">图色助手下载</a><br><a target="_blank" rel="noopener" href="https://www.sioe.cn/yingyong/yanse-rgb-16/">RGB颜色值与十六进制颜色码转换工具</a></p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 彩图转灰度图</span></span><br><span class="line">images.cvtColor(img, <span class="string">"RGBA2GRAY"</span>);</span><br></pre></td></tr></tbody></table></figure>
<p><strong>2. 及时回收图片</strong></p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">events.on(<span class="string">"exit"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">  <span class="keyword">if</span> (bigImg &amp;&amp; !bigImg.isRecycled()) {</span><br><span class="line">    bigImg.recycle();</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">if</span> (smallImg &amp;&amp; !smallImg.isRecycled()) {</span><br><span class="line">    smallImg.recycle();</span><br><span class="line">  }</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>
<h2 id="dex"><a href="#dex" class="headerlink" title="dex"></a>dex</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 加载目标dex文件，加载成功后将可以使用该dex文件的类。</span></span><br><span class="line">runtime.loadDex(filePath);</span><br><span class="line"></span><br><span class="line"><span class="comment">// package com.keke;      </span></span><br><span class="line"><span class="comment">// public class YaShu {}</span></span><br><span class="line">importClass(com.keke.YaShu);  <span class="comment">//导入类</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="多线程-Threads"><a href="#多线程-Threads" class="headerlink" title="多线程 - Threads"></a>多线程 - Threads</h2><p>threads.start(action)<br>    启动一个新线程并执行action。返回 {Thread}<br>    action {Function} 要在新线程执行的函数</p>
<h2 id="悬浮窗-Floaty"><a href="#悬浮窗-Floaty" class="headerlink" title="悬浮窗 - Floaty"></a>悬浮窗 - Floaty</h2><h3 id="FloatyWindow对象"><a href="#FloatyWindow对象" class="headerlink" title="FloatyWindow对象"></a>FloatyWindow对象</h3><p><strong>floaty.window(layout)</strong><br>    layout {xml} | {View} 悬浮窗界面的XML或者View<br>    指定悬浮窗的布局，创建并显示一个悬浮窗，返回一个FloatyWindow对象。</p>
<p><strong>方法</strong><br>    window.setAdjustEnabled(enabled)  是否启用悬浮窗调整(大小、位置)<br>    window.setPosition(x, y)   设置悬浮窗位置。<br>    window.getX()   返回悬浮窗位置的X坐标。<br>    window.getY()<br>    window.setSize(width, height)   设置悬浮窗宽高。<br>    window.getWidth()    返回悬浮窗宽度。<br>    window.getHeight()<br>    window.close()    关闭悬浮窗。如果悬浮窗已经是关闭状态，则此函数将不执行任何操作。被关闭后的悬浮窗不能再显示。<br>    window.exitOnClose()   使悬浮窗被关闭时自动结束脚本运行。</p>
<h3 id="FloatyRawWindow对象"><a href="#FloatyRawWindow对象" class="headerlink" title="FloatyRawWindow对象"></a>FloatyRawWindow对象</h3><p><strong>floaty.rawWindow(layout)</strong><br>    layout {xml} | {View} 悬浮窗界面的XML或者View<br>    指定悬浮窗的布局，创建并显示一个原始悬浮窗，返回一个FloatyRawWindow对象。</p>
<pre><code>与floaty.window()函数不同的是，该悬浮窗不会增加任何额外设施（例如调整大小、位置按钮），您可以根据自己需要编写任何布局。
</code></pre>
<p><strong>方法</strong><br>    window.setTouchable(touchable)<br>    window.setPosition(x, y)<br>    window.getX()<br>    window.getY()<br>    window.setSize(width, height)<br>    window.getWidth()<br>    window.getHeight()<br>    window.close()<br>    window.exitOnClose()</p>
<h2 id="对话框-Dialogs"><a href="#对话框-Dialogs" class="headerlink" title="对话框 - Dialogs"></a>对话框 - Dialogs</h2><p>dialogs.alert(title[, content, callback])</p>
<p>dialogs.confirm(title[, content, callback])<br>dialogs.rawInput(title[, prefill, callback])<br>dialogs.input(title[, prefill, callback])<br>dialogs.prompt(title[, prefill, callback])</p>
<p>dialogs.select(title, items, callback)<br>    显示一个带有选项列表的对话框<br>    title {string} 对话框的标题。<br>    items {Array} 对话框的选项列表，是一个字符串数组。<br>    callback {Function} 回调函数，可选。当用户点击确定时被调用,一般用于ui模式。</p>
<p>dialogs.singleChoice(title, items[, index, callback])<br>dialogs.multiChoice(title, items[, indices, callback])<br>dialog.setDefaultDialogType(type)<br>dialogs.build(properties)</p>
<h2 id="ui"><a href="#ui" class="headerlink" title="ui"></a>ui</h2><h3 id="视图-View"><a href="#视图-View" class="headerlink" title="视图: View"></a>视图: View</h3><h3 id="视图属性"><a href="#视图属性" class="headerlink" title="视图属性"></a>视图属性</h3><p>w  View的宽度，是属性width的缩写形式。可以设置的值为*, auto和具体数值。<br>h  View的高度，是属性height的缩写形式。可以设置的值为*, auto和具体数值。<br>id   在代码中可以通过一个View的id来获取到这个View，并对他进行操作(设置点击动作、设置属性、获取属性等)<br>gravity  View的”重力”。用于决定View的内容相对于View的位置，可以设置的值为:<br>    left 靠左<br>    right 靠右<br>    top 靠顶部<br>    bottom 靠底部<br>    center 居中<br>    center_vertical 垂直居中<br>    center_horizontal 水平居中<br>layout_gravity  View在布局中的”重力”，用于决定View本身在他的父布局的位置，可以设置的值和gravity属性相同。</p>
<p>bg  View的背景。其值可以是一个链接或路径指向的图片，或者RGB格式的颜色，或者其他背景。<br>alpha  View的透明度，其值是一个0~1之间的小数，0表示完全透明，1表示完全不透明。<br>foreground  View的前景。前景即在一个View的内容上显示的内容，可能会覆盖掉View本身的内容。其值和属性bg的值类似。<br>minHeight  View的最小高度。<br>minWidth<br>visibility  View的可见性，<br><strong>style</strong>  设置View的样式。<br>rotation  View的旋转角度。通过该属性可以让这个View顺时针旋转一定的角度。<br>transformPivotX<br>transformPivotY<br>margin<br>marginLeft<br>marginRight<br>marginTop<br>marginBottom<br>padding<br>paddingLeft<br>paddingRight<br>paddingTop<br>paddingBottom</p>
<h3 id="对视图的操作"><a href="#对视图的操作" class="headerlink" title="对视图的操作"></a>对视图的操作</h3><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取视图对象，通过视图view的id</span></span><br><span class="line">ui.[id]</span><br><span class="line">ui.findView(<span class="string">'id'</span>)</span><br><span class="line">$ui.findView(<span class="string">'id'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>ui.[id].getText()     //获取到这个按钮控件的文本内容<br>.setText()<br>.setDataSource(数组)    //获取数组元素</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 对控件设置监听</span></span><br><span class="line">ui.fab.setOnClickListener(</span><br><span class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">view</span>)</span>{</span><br><span class="line">    toastLog(<span class="string">'你点击了fab'</span>)</span><br><span class="line">  }</span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure>

<h3 id="控件"><a href="#控件" class="headerlink" title="控件"></a>控件</h3><p>文本控件: text<br>    text<br>    textColor<br>    textSize<br>    textStyle<br>    lines<br>    maxLines<br>    typeface<br>    ellipsize<br>    ems<br>    autoLink<br>按钮控件: button<br>输入框控件: input<br>    hint<br>    textColorHint<br>    textSizeHint<br>    inputType<br>    password<br>    numeric<br>    phoneNumber<br>    digit<br>    singleLine<br>图片控件: img<br>    src<br>    tint<br>    scaleType<br>    radius<br>    radiusTopLeft<br>    radiusTopRight<br>    radiusBottomLeft<br>    radiusBottomRight<br>    borderWidth<br>    borderColor<br>    circle<br>垂直布局: vertical<br>layout_weight<br>水平布局: horizontal<br>layout_weight<br>线性布局: linear<br>帧布局: frame<br>相对布局: relative<br>勾选框控件: checkbox<br>选择框控件: radio<br>选择框布局: radiogroup<br>开关控件: Switch<br>checked<br>text<br>进度条控件: progressbar<br>拖动条控件: seekbar<br>下来菜单控件: spinner<br>时间选择控件: timepicker<br>日期选择控件: datepicker<br>浮动按钮控件: fab<br>标题栏控件: toolbar<br>卡片: card</p>
<h3 id="在ui使用webview"><a href="#在ui使用webview" class="headerlink" title="在ui使用webview"></a>在ui使用webview</h3><p>一个ui界面再调用另一个ui，把另一个ui封装成函数再调用，不需要另开一个线程</p>
<p>在ui使用webview</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"ui"</span>;</span><br><span class="line">ui.layout(</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">vertical</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"btn"</span>&gt;</span>点击打开网页<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">webview</span> <span class="attr">id</span>=<span class="string">"web"</span>&gt;</span><span class="tag">&lt;/<span class="name">webview</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">vertical</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line">ui.btn.click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">  ui.web.loadUrl(<span class="string">"https://www.baidu.com"</span>);</span><br><span class="line">});</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>


<h2 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h2><p><a target="_blank" rel="noopener" href="https://www.yuque.com/yashujs/bfug6u/mv8e02">https://www.yuque.com/yashujs/bfug6u/mv8e02</a></p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">      <span class="comment">// 字段映射</span></span><br><span class="line">      <span class="keyword">let</span> fieldMapping = {</span><br><span class="line">          <span class="string">"id"</span>: <span class="string">"int"</span>,</span><br><span class="line">          <span class="string">"desc"</span>: <span class="string">"String"</span>,</span><br><span class="line">      }</span><br><span class="line">      <span class="comment">// 表名</span></span><br><span class="line">      <span class="keyword">let</span> table = <span class="string">"record"</span>;</span><br><span class="line">      <span class="comment">// 建表</span></span><br><span class="line">      <span class="keyword">let</span> SQL = <span class="string">"CREATE TABLE IF NOT EXISTS "</span> + table+<span class="string">" ("</span></span><br><span class="line">          + <span class="string">"id INTEGER PRIMARY KEY AUTOINCREMENT,"</span></span><br><span class="line">          + <span class="string">"desc VARCHAR(255)"</span></span><br><span class="line">          + <span class="string">")"</span>;</span><br><span class="line">      <span class="comment">// 数据库名</span></span><br><span class="line">      <span class="keyword">let</span> db = <span class="string">"xianyu"</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">let</span> dbUtils = <span class="keyword">new</span> DbUtils(db, SQL, fieldMapping);</span><br><span class="line">      <span class="comment">// 创建数据库和表</span></span><br><span class="line">      dbUtils.updateDatabase();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 清表</span></span><br><span class="line">dbUtils.deleteRows(table, <span class="literal">null</span>, <span class="literal">null</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 数据查询</span></span><br><span class="line">      <span class="keyword">let</span> existStatus = dbUtils.isExistRow(<span class="string">"SELECT * FROM  "</span> + table + <span class="string">"  WHERE desc = ?"</span>, [text]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 增加数据</span></span><br><span class="line">dbUtils.addRow(table, { <span class="attr">desc</span>: text });</span><br></pre></td></tr></tbody></table></figure>







<h1 id="用MCV框架实现界面切换"><a href="#用MCV框架实现界面切换" class="headerlink" title="用MCV框架实现界面切换"></a>用MCV框架实现界面切换</h1><p>● M即model模型是指模型表示业务规则<br>● V即View视图是指用户看到并与之交互的界面<br>● C即controller控制器是指控制器接受用户的输入并调用模型和视图去完成用户的需求</p>
<h2 id="main-js"><a href="#main-js" class="headerlink" title="main.js"></a>main.js</h2><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"ui"</span>;</span><br><span class="line"><span class="built_in">require</span>(<span class="string">"./controller"</span>).init();</span><br></pre></td></tr></tbody></table></figure>

<h2 id="model-js"><a href="#model-js" class="headerlink" title="model.js"></a>model.js</h2><p>数据模型和业务逻辑;</p>
<p>验证登录</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> UserModel = <span class="function"><span class="keyword">function</span> (<span class="params">username, password</span>) </span>{</span><br><span class="line">  <span class="built_in">this</span>.username = username;</span><br><span class="line">  <span class="built_in">this</span>.password = password;</span><br><span class="line">  <span class="built_in">this</span>.vip = <span class="literal">false</span>;</span><br><span class="line">  <span class="built_in">this</span>.login = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.username === <span class="string">"admin"</span> &amp;&amp; <span class="built_in">this</span>.password === <span class="string">"123"</span>) {</span><br><span class="line">      <span class="built_in">this</span>.vip = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">this</span>.username === <span class="string">"user"</span> &amp;&amp; <span class="built_in">this</span>.password === <span class="string">"123"</span>) {</span><br><span class="line">      <span class="built_in">this</span>.vip = <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    }</span><br><span class="line">  };</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = {</span><br><span class="line">  <span class="attr">UserModel</span>: UserModel,</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>

<h2 id="controller-js"><a href="#controller-js" class="headerlink" title="controller.js"></a>controller.js</h2><p>用来调度View层和Model层, 用来将不同的View和不同的Model组织在一起，顺便替双方传递消息;</p>
<p>把登录的数据交给model处理, 显示对应的界面</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> view = <span class="built_in">require</span>(<span class="string">"./view"</span>);</span><br><span class="line"><span class="keyword">let</span> model = <span class="built_in">require</span>(<span class="string">"./model"</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = {</span><br><span class="line">  init,</span><br><span class="line">};</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">init</span>(<span class="params"></span>) </span>{</span><br><span class="line">  loadLoginPage();</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadLoginPage</span>(<span class="params"></span>) </span>{</span><br><span class="line">  ui.layout(view.LoginPage);</span><br><span class="line">  loginPageAction();</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadHomePage</span>(<span class="params">user</span>) </span>{</span><br><span class="line">  ui.layout(view.HomePage);</span><br><span class="line">  user.vip &amp;&amp; ui.vipComponentParent.addView(ui.inflate(view.VipComponent));</span><br><span class="line">  homePageAction(user);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loginPageAction</span>(<span class="params"></span>) </span>{</span><br><span class="line">  ui.login.click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">    <span class="keyword">let</span> username = ui.username.text();</span><br><span class="line">    <span class="keyword">let</span> password = ui.password.text();</span><br><span class="line">    <span class="keyword">if</span> (!username) {</span><br><span class="line">      toastLog(<span class="string">"username is empty"</span>);</span><br><span class="line">      ui.username.setError(<span class="string">"username is empty"</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span> (!password) {</span><br><span class="line">      toastLog(<span class="string">"password is empty"</span>);</span><br><span class="line">      ui.password.setError(<span class="string">"password is empty"</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">let</span> user = <span class="keyword">new</span> model.UserModel(username, password);</span><br><span class="line">    <span class="keyword">let</span> loginResult = user.login();</span><br><span class="line">    <span class="keyword">if</span> (loginResult) {</span><br><span class="line">      loadHomePage(user);</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">      toastLog(<span class="string">"login failed"</span>);</span><br><span class="line">    }</span><br><span class="line">  });</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">homePageAction</span>(<span class="params">user</span>) </span>{</span><br><span class="line">  ui.username.text(user.username);</span><br><span class="line">  ui.logout.click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">    loadLoginPage();</span><br><span class="line">  });</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="view-js"><a href="#view-js" class="headerlink" title="view.js"></a>view.js</h2><p>未登录页面和登录页面的xml文件</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> LoginPage = (</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">vertical</span> <span class="attr">padding</span>=<span class="string">"30"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">horizontal</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">text</span> <span class="attr">text</span>=<span class="string">"username"</span> <span class="attr">textSize</span>=<span class="string">"30sp"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"username"</span> <span class="attr">w</span>=<span class="string">"*"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">horizontal</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">horizontal</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">text</span> <span class="attr">text</span>=<span class="string">"password"</span> <span class="attr">textSize</span>=<span class="string">"30sp"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"password"</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">w</span>=<span class="string">"*"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">horizontal</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"login"</span>&gt;</span>login<span class="tag">&lt;/<span class="name">button</span>&gt;</span>;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">vertical</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">let</span> HomePage = (</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">vertical</span> <span class="attr">padding</span>=<span class="string">"30"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">text</span>=<span class="string">"homepage"</span> <span class="attr">w</span>=<span class="string">"*"</span> <span class="attr">gravity</span>=<span class="string">"center"</span> <span class="attr">textStyle</span>=<span class="string">"bold"</span> <span class="attr">textSize</span>=<span class="string">"40sp"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">horizontal</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">text</span> <span class="attr">text</span>=<span class="string">"username: "</span> <span class="attr">textSize</span>=<span class="string">"30sp"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">text</span> <span class="attr">id</span>=<span class="string">"username"</span> <span class="attr">textSize</span>=<span class="string">"30sp"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">linear</span> <span class="attr">id</span>=<span class="string">"vipComponentParent"</span>&gt;</span><span class="tag">&lt;/<span class="name">linear</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">horizontal</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"logout"</span>&gt;</span>logout<span class="tag">&lt;/<span class="name">button</span>&gt;</span>;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">vertical</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">let</span> VipComponent = (</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">vertical</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">text</span>=<span class="string">" vip"</span> <span class="attr">textColor</span>=<span class="string">"#ff5722"</span> <span class="attr">w</span>=<span class="string">"*"</span> <span class="attr">textStyle</span>=<span class="string">"bold"</span> <span class="attr">textSize</span>=<span class="string">"30sp"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">vertical</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"><span class="built_in">module</span>.exports = {</span><br><span class="line">  <span class="attr">LoginPage</span>: LoginPage,</span><br><span class="line">  <span class="attr">HomePage</span>: HomePage,</span><br><span class="line">  <span class="attr">VipComponent</span>: VipComponent,</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>


<h1 id="进程与线程"><a href="#进程与线程" class="headerlink" title="进程与线程"></a>进程与线程</h1><p>多线程属于同一个进程，同一个进程，申请一次截图权限就可以<br>脚本引擎 - Engines模块，启动的脚本属于不同的进程</p>
<p>2个线程找图做任务，captureScreen 截图给不同的变量，为啥会有一个提示图片被回收？<br>给变量了，只是内存地址被引用。可以用clone方法处理</p>
<h1 id="画布"><a href="#画布" class="headerlink" title="画布"></a>画布</h1><p>所有的学习笔记，开源项目，还有博客均已经在GitHub开源，链接地址：<a target="_blank" rel="noopener" href="https://github.com/yangchong211/YCBlogs">https://github.com/yangchong211/YCBlogs</a><br>关于案例已经开源，开源地址：<a target="_blank" rel="noopener" href="https://github.com/yangchong211">https://github.com/yangchong211</a></p>
<h2 id="1-Paint画笔介绍"><a href="#1-Paint画笔介绍" class="headerlink" title="1.Paint画笔介绍"></a>1.Paint画笔介绍</h2><p>Paint即画笔，在绘图过程中起到了极其重要的作用，画笔主要保存了颜色， 样式等绘制信息，指定了如何绘制文本和图形，画笔对象有很多设置方法，大体上可以分为两类，一类与图形绘制相关，一类与文本绘制相关。</p>
<h3 id="1-1-图形绘制"><a href="#1-1-图形绘制" class="headerlink" title="1.1 图形绘制"></a>1.1 图形绘制</h3><p>常用的方法有这些</p>
<ul>
<li>setARGB(int a,int r,int g,int b);<br>设置绘制的颜色，a代表透明度，r，g，b代表颜色值。 </li>
<li>setAlpha(int a);<br>设置绘制图形的透明度。</li>
<li>setColor(int color);<br>设置绘制的颜色，使用颜色值来表示，该颜色值包括透明度和RGB颜色。 </li>
<li>setAntiAlias(boolean aa);<br>设置是否使用抗锯齿功能，会消耗较大资源，绘制图形速度会变慢。 </li>
<li>setDither(boolean dither);<br>设定是否使用图像抖动处理，会使绘制出来的图片颜色更加平滑和饱满，图像更加清晰 </li>
<li>setFilterBitmap(boolean filter);<br>如果该项设置为true，则图像在动画进行中会滤掉对Bitmap图像的优化操作，加快显示速度，本设置项依赖于dither和xfermode的设置 </li>
<li>setMaskFilter(MaskFilter maskfilter);<br>设置MaskFilter，可以用不同的MaskFilter实现滤镜的效果，如滤化，立体等 </li>
<li>setColorFilter(ColorFilter colorfilter);<br>设置颜色过滤器，可以在绘制颜色时实现不用颜色的变换效果 </li>
<li>setPathEffect(PathEffect effect);<br>设置绘制路径的效果，如点画线等 </li>
<li>setShader(Shader shader);<br>设置图像效果，使用Shader可以绘制出各种渐变效果 </li>
<li>setShadowLayer(float radius ,float dx,float dy,int color);<br>在图形下面设置阴影层，产生阴影效果，radius为阴影的角度，dx和dy为阴影在x轴和y轴上的距离，color为阴影的颜色 </li>
<li>setStyle(Paint.Style style);<br>设置画笔的样式，为FILL，FILL_AND_STROKE，或STROKE </li>
<li>setStrokeCap(Paint.Cap cap);<br>当画笔样式为STROKE或FILL_AND_STROKE时，设置笔刷的图形样式，如圆形样式  Cap.ROUND,或方形样式Cap.SQUARE </li>
<li>setSrokeJoin(Paint.Join join);<br>设置绘制时各图形的结合方式，如平滑效果等 </li>
<li>setStrokeWidth(float width);<br>当画笔样式为STROKE或FILL_AND_STROKE时，设置笔刷的粗细度 </li>
<li>setXfermode(Xfermode xfermode);<br>设置图形重叠时的处理方式，如合并，取交集或并集，经常用来制作橡皮的擦除效果 <h3 id="1-2-文本绘制"><a href="#1-2-文本绘制" class="headerlink" title="1.2 文本绘制"></a>1.2 文本绘制</h3></li>
</ul>
<p>常用的方法有这些</p>
<ul>
<li>setFakeBoldText(boolean fakeBoldText);<br>模拟实现粗体文字，设置在小字体上效果会非常差 </li>
<li>setSubpixelText(boolean subpixelText);<br>设置该项为true，将有助于文本在LCD屏幕上的显示效果 </li>
<li>setTextAlign(Paint.Align align);<br>设置绘制文字的对齐方向 </li>
<li>setTextScaleX(float scaleX);<br>设置绘制文字x轴的缩放比例，可以实现文字的拉伸的效果 </li>
<li>setTextSize(float textSize);<br>设置绘制文字的字号大小 </li>
<li>setTextSkewX(float skewX);<br>设置斜体文字，skewX为倾斜弧度 </li>
<li>setTypeface(Typeface typeface);<br>设置Typeface对象，即字体风格，包括粗体，斜体以及衬线体，非衬线体等 </li>
<li>setUnderlineText(boolean underlineText);<br>设置带有下划线的文字效果 </li>
<li>setStrikeThruText(boolean strikeThruText);<br>设置带有删除线的效果 <h2 id="2-Canvas画布介绍"><a href="#2-Canvas画布介绍" class="headerlink" title="2.Canvas画布介绍"></a>2.Canvas画布介绍</h2></li>
</ul>
<p>当我们调整好画笔之后，现在需要绘制到画布上，这就得用Canvas类了。在android中既然把Canvas当做画布，那么就可以在画布上绘制我们想要的任何东西。除了在画布上绘制之外，还需要设置一些关于画布的属性，比如，画布的颜色、尺寸等。</p>
<h3 id="2-1-设置属性"><a href="#2-1-设置属性" class="headerlink" title="2.1 设置属性"></a>2.1 设置属性</h3><p>一般属性有：</p>
<ul>
<li>Canvas(Bitmap bitmap): 以bitmap对象创建一个画布，则将内容都绘制在bitmap上，因此bitmap不得为null。</li>
<li>Canvas(GL gl): 在绘制3D效果时使用，与OpenGL相关。</li>
<li>isOpaque(boolean isOpaque)：检测是否支持透明。</li>
<li>setViewport(int left, int top, int right, int bottom, int clipflag):  设置画布中显示窗口。</li>
<li>drawColor(int color): 设置Canvas的背景颜色。</li>
<li>setBitmap(Bitmap mBitmap):  设置具体画布，画的内容，保存为一个Bitmap。</li>
<li>clipRect(float left, float top, float right, float bottom): 设置显示区域，即设置裁剪区。</li>
<li>translate(float x, float  y): 平移画布。</li>
<li>rotate(float degree, float px, float py):  旋转画布 。</li>
<li>skew(float sx, float sy):  设置偏移量。 </li>
<li>save(): 将Canvas当前状态保存在堆栈，save之后可以调用Canvas的平移、旋转、错切、剪裁等操作。</li>
<li>restore(): 恢复为之前堆栈保存的Canvas状态，防止save后对Canvas执行的操作对后续的绘制有影响。restore和save要配对使用，restore可以比save少，但不能比save多，否则会引发error。save和restore之间，往往夹杂的是对Canvas的特殊操作。</li>
<li>save(int num)：将Canvas当前状态保存在堆栈，并予以编号int</li>
<li>restoreToCount(int num)：恢复为之前堆栈保存的编号为int的Canvas状态</li>
<li>concat(Matrix matrix)：画布关联矩阵，画出来的内容按矩阵改变，而不是画布改变。</li>
<li>Drawable.draw(Canvas canvas)：将Drawable画到Canvas中<br>注：这种方式画Drawable怎么设置透明度呢？((BitmapDrawable)Drawable).getPaint().setAlpha(mBgAlpha);<h3 id="2-2-画图【重点】"><a href="#2-2-画图【重点】" class="headerlink" title="2.2 画图【重点】"></a>2.2 画图【重点】</h3></li>
</ul>
<p>画图部分</p>
<ul>
<li> canvas.drawPaint(Paint paint)<br>将画笔设置的颜色和透明度铺满画布</li>
<li>drawRect(RectF rect, Paint paint)<br>绘制矩形，参数一为RectF一个区域 </li>
<li>drawRect(float left, float top, float right, float bottom, Paint paint)<br>绘制矩形，left:矩形left的x坐标，top:矩形top的y坐标，right:矩形right的x坐标，bottom:矩形bottom的y坐标</li>
<li>drawRoundRect(RectF rect, float rx, float ry, Paint paint)<br>绘制圆角矩形， rx:x方向的圆角半径，ry:y方向的圆角半径</li>
<li>drawRoundRect(float left, float top, float right, float bottom, float rx, float ry, Paint paint)        </li>
<li>drawPath(Path path, Paint paint)<br>绘制一个路径，参数一为Path路径对象</li>
<li>drawBitmap(Bitmap bitmap, Rect src, Rect dst, Paint paint)<br>贴图，参数一就是我们常规的Bitmap对象，参数二是源区域(这里是bitmap)，参数三是目标区域(应该在canvas的位置和大小)，参数四是Paint画刷对象，因为用到了缩放和拉伸的可能，当原始Rect不等于目标Rect时性能将会有大幅损失。</li>
<li>drawBitmap (Bitmap bitmap, float left, float top, Paint paint)</li>
<li>drawLine(float startX, float startY, float stopX, float stopY, Paintpaint)<br>画线，参数一起始点的x轴位置，参数二起始点的y轴位置，参数三终点的x轴水平位置，参数四y轴垂直位置，最后一个参数为Paint 画刷对象。 </li>
<li>drawPoint(float x, float y, Paint paint)<br>画点，参数一水平x轴，参数二垂直y轴，第三个参数为Paint对象。</li>
<li>drawText(String text, float x, floaty, Paint paint)<br>渲染文本，Canvas类除了上面的还可以描绘文字，参数一是String类型的文本，参数二文字左侧到x轴距离，参数三文字BaseLine到y轴距离，参数四是Paint对象。</li>
<li>drawOval(RectF oval, Paint paint)<br>绘制椭圆，参数一是扫描区域，参数二为paint对象</li>
<li>drawOval(float left, float top, float right, float bottom, Paint paint）</li>
<li>drawCircle(float cx, float cy, float radius,Paint paint)<br>绘制圆，参数一是中心点的x轴，参数二是中心点的y轴，参数三是半径，参数四是paint对象；</li>
<li>drawArc(RectF oval, float startAngle, float sweepAngle, boolean useCenter, Paint paint)<br>画弧，参数一是RectF对象，指定圆弧的外轮廓矩形区域，参数二是起始角(度)在电弧的开始，参数三扫描角(度)开始顺时针测量的，参数四是如果这是真的话,包括椭圆中心的电弧,并关闭它,如果它是假这将是一个弧线,参数五是Paint对象；<h3 id="2-3-Canvas对象的获取方式"><a href="#2-3-Canvas对象的获取方式" class="headerlink" title="2.3 Canvas对象的获取方式"></a>2.3 Canvas对象的获取方式</h3></li>
</ul>
<p>2.3.1 Canvas对象的获取方式有两种：<br>第一种通过重写View.onDraw方法，View中的Canvas对象会被当做参数传递过来，操作这个Canvas，效果会直接反应在View中。<br>第二种通过new创建一个Canvas对象<br>代码如下所示<br>@Override<br>protected void onDraw(Canvas canvas) {<br>    super.onDraw(canvas);<br>}</p>
<p>Canvas canvas = new Canvas();</p>
<h3 id="2-4-Canvas的作用"><a href="#2-4-Canvas的作用" class="headerlink" title="2.4 Canvas的作用"></a>2.4 Canvas的作用</h3><p>Canvas可以绘制的对象有：弧线(arcs)、填充颜色(argb和color)、Bitmap、圆(circle和oval)、点(point)、线(line)、矩形(Rect)、图片(Picture)、圆角矩形(RoundRect)、文本(text)、顶点(Vertices)、路径(path)。</p>
<h3 id="2-5-Canvas绘制圆和椭圆"><a href="#2-5-Canvas绘制圆和椭圆" class="headerlink" title="2.5 Canvas绘制圆和椭圆"></a>2.5 Canvas绘制圆和椭圆</h3><p>绘制圆<br>private Paint paint = new Paint();</p>
<p>@Override<br>protected void onDraw(Canvas canvas) {<br>    super.onDraw(canvas);<br>    paint.setAntiAlias(true);<br>    paint.setColor(Color.BLUE);<br>    paint.setStyle(Paint.Style.FILL);<br>    canvas.drawCircle(200,200,100 , paint);<br>}</p>
<h3 id="2-6-Canvas绘制矩形、圆角矩形"><a href="#2-6-Canvas绘制矩形、圆角矩形" class="headerlink" title="2.6 Canvas绘制矩形、圆角矩形"></a>2.6 Canvas绘制矩形、圆角矩形</h3><p>如下所示<br>image<br>private Paint paint = new Paint();</p>
<p>@Override<br>protected void onDraw(Canvas canvas) {<br>    super.onDraw(canvas);<br>    paint.setAntiAlias(true);<br>    paint.setColor(Color.RED);<br>    paint.setStyle(Paint.Style.FILL);<br>    canvas.drawRect(100, 100, 200, 200, paint);<br>    if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) {<br>        canvas.drawRoundRect(400, 100, 600, 300, 30, 30, paint);<br>    }<br>    paint.setStyle(Paint.Style.STROKE);<br>    paint.setStrokeWidth(20);<br>    canvas.drawRect(100, 400, 300, 600, paint);<br>}</p>
<h3 id="2-7-Canvas绘制文字"><a href="#2-7-Canvas绘制文字" class="headerlink" title="2.7 Canvas绘制文字"></a>2.7 Canvas绘制文字</h3><p>Canvas绘制文字<br>image<br>private Paint paint = new Paint();</p>
<p>@SuppressLint(“DrawAllocation”)<br>@Override<br>protected void onDraw(Canvas canvas) {<br>    super.onDraw(canvas);<br>    paint.setAntiAlias(true);<br>    paint.setColor(Color.RED);<br>    paint.setTextSize(100);<br>    canvas.drawText(“潇湘剑雨”, 100, 100, paint);<br>}</p>
<h3 id="2-8-Canvas绘制弧形、封闭弧形"><a href="#2-8-Canvas绘制弧形、封闭弧形" class="headerlink" title="2.8 Canvas绘制弧形、封闭弧形"></a>2.8 Canvas绘制弧形、封闭弧形</h3><p>绘制弧形、封闭弧形<br>image<br>private Paint paint = new Paint();</p>
<p>@SuppressLint(“DrawAllocation”)<br>@Override<br>protected void onDraw(Canvas canvas) {<br>    super.onDraw(canvas);<br>    paint.setAntiAlias(true);<br>    paint.setColor(Color.RED);<br>    RectF rel = new RectF(50, 50, 150, 150);<br>    //实心圆弧<br>    canvas.drawArc(rel, 0, 135, false, paint);<br>    //实心圆弧 将圆心包含在内<br>    RectF rel2 = new RectF(50, 200, 150, 300);<br>    canvas.drawArc(rel2, 0, 135, true, paint);<br>    //设置空心Style<br>    paint.setStyle(Paint.Style.STROKE);<br>    paint.setStrokeWidth(20);<br>    RectF rel3 = new RectF(50, 350, 150, 450);<br>    canvas.drawArc(rel3, 0, 270, false, paint);<br>    RectF rel4 = new RectF(50, 250, 150, 600);<br>    canvas.drawArc(rel4, 0, 270, true, paint);<br>}</p>
<h3 id="2-9-Canvas绘制Path路径"><a href="#2-9-Canvas绘制Path路径" class="headerlink" title="2.9 Canvas绘制Path路径"></a>2.9 Canvas绘制Path路径</h3><p>Canvas绘制Path路径<br>image<br>private Paint paint = new Paint();<br>@SuppressLint(“DrawAllocation”)<br>@Override<br>protected void onDraw(Canvas canvas) {<br>    super.onDraw(canvas);<br>    Path angle = new Path();<br>    angle.moveTo(250, 0);<br>    angle.lineTo(0, 500);<br>    angle.lineTo(100, 300);<br>    angle.lineTo(200, 350);<br>    angle.lineTo(500, 500);<br>    angle.close();<br>    canvas.drawPath(angle, paint);<br>}</p>
<h2 id="3-Matrix变换矩阵介绍【Canvas位置转换】"><a href="#3-Matrix变换矩阵介绍【Canvas位置转换】" class="headerlink" title="3.Matrix变换矩阵介绍【Canvas位置转换】"></a>3.Matrix变换矩阵介绍【Canvas位置转换】</h2><p>思考：如果要画一个仪表盘(数字围绕显示在一个圆圈中)，或者类似钟表指针样的控件，如何实现？<br>Android还提供了一些对Canvas位置转换的方法：rorate、scale、translate、skew(扭曲)等，而且它允许你通过获得它的转换矩阵对象(getMatrix方法)直接操作它。这些操作就像是虽然你的笔还是原来的地方画，但是画纸旋转或者移动了，所以你画的东西的方位就产生变化。为了方便一些转换操作，Canvas还提供了保存和回滚属性的方法(save和restore)，比如你可以先保存目前画纸的位置(save)，然后旋转90度，向下移动100像素后画一些图形，画完后调用restore方法返回到刚才保存的位置。<br>3.1 translate平移</p>
<p>3.2 rorate旋转</p>
<p>rorate旋转<br>image<br>private Paint mPaint = new Paint();</p>
<p>@SuppressLint(“DrawAllocation”)<br>@Override<br>protected void onDraw(Canvas canvas) {<br>    super.onDraw(canvas);<br>    canvas.drawColor(Color.BLUE);<br>    mPaint.setColor(Color.RED);<br>    canvas.drawRect(new Rect(0, 0, 800, 800), mPaint);<br>    canvas.save();<br>    mPaint.setColor(Color.GREEN);<br>    canvas.rotate(45,400,400);<br>    canvas.drawRect(new Rect(0, 0, 800, 800), mPaint);<br>    canvas.restore();<br>}<br>源代码有两个可以使用的方法：<br>/**  </p>
<ul>
<li>Preconcat the current matrix with the specified rotation.  </li>
<li>@param degrees The amount to rotate, in degrees  </li>
<li>/<br>public native void rotate(float degrees);<br>/**  </li>
<li>Preconcat the current matrix with the specified rotation.   </li>
<li>@param degrees The amount to rotate, in degrees  </li>
<li>@param px The x-coord for the pivot point (unchanged by the rotation)  </li>
<li>@param py The y-coord for the pivot point (unchanged by the rotation)  </li>
<li>/<br>public final void rotate(float degrees, float px, float py) {<br>  translate(px, py);<br>  rotate(degrees);<br>  translate(-px, -py);<br>}  </li>
</ul>
<p>3.3 scale缩放</p>
<p>scale缩放<br>image<br>private Paint mPaint = new Paint();</p>
<p>@SuppressLint(“DrawAllocation”)<br>@Override<br>protected void onDraw(Canvas canvas) {<br>    super.onDraw(canvas);<br>    canvas.drawColor(Color.YELLOW);<br>    mPaint.setColor(Color.RED);<br>    canvas.drawRect(new Rect(0, 0, 800, 800), mPaint);<br>    // 保存画布状态<br>    canvas.save();<br>    canvas.scale(0.5f, 0.5f);<br>    mPaint.setColor(Color.GREEN);<br>    canvas.drawRect(new Rect(0, 0, 800, 800), mPaint);<br>    // 画布状态回滚<br>    canvas.restore();<br>    canvas.scale(0.5f, 0.5f, 400, 400);<br>    mPaint.setColor(Color.BLUE);<br>    canvas.drawRect(new Rect(0, 0, 800, 800), mPaint);<br>}<br>源码如下所示<br>/**  </p>
<ul>
<li>Preconcat the current matrix with the specified scale.   </li>
<li>@param sx The amount to scale in X  </li>
<li>@param sy The amount to scale in Y  </li>
<li>/<br>public native void scale(float sx, float sy);  </li>
</ul>
<p>/**  </p>
<ul>
<li>Preconcat the current matrix with the specified scale.  </li>
<li>@param sx The amount to scale in X  </li>
<li>@param sy The amount to scale in Y  </li>
<li>@param px The x-coord for the pivot point (unchanged by the scale)  </li>
<li>@param py The y-coord for the pivot point (unchanged by the scale)  </li>
<li>/<br>public final void scale(float sx, float sy, float px, float py) {<br>  translate(px, py);<br>  scale(sx, sy);<br>  translate(-px, -py);<br>}  </li>
</ul>
<p>3.4 skew扭曲</p>
<p>4.RectF介绍</p>
<p>4.1 Rect简单属性</p>
<p>这是一个我们常用的一个“绘画相关的工具类”，常用语描述长方形/正方形，他只有4个属性<br>public int left;<br>public int top;<br>public int right;<br>public int bottom;<br>其中常用的构造方法如下所示<br>public Rect(int left, int top, int right, int bottom) {<br>    this.left = left;<br>    this.top = top;<br>    this.right = right;<br>    this.bottom = bottom;<br>}</p>
<p>public Rect(Rect r) {<br>    if (r == null) {<br>        left = top = right = bottom = 0;<br>    } else {<br>        left = r.left;<br>        top = r.top;<br>        right = r.right;<br>        bottom = r.bottom;<br>    }<br>}<br>这4个属性描述着这一个“方块”，但是这有一个知识点需要理清楚，先看这张图<br>image<br>4.2 Rect父类的实现</p>
<p>实现了Parcelable 所以需要实现一堆Object的方法，诸如equals，toString等等，来简单看一看<br>对于equals方法，首先先对传来的对象进行判空，类型判断，再强转成Rect对象，最后还是一个个去比对那4个属性。<br>@Override<br>public boolean equals(Object o) {<br>    if (this == o) return true;<br>    if (o == null || getClass() != o.getClass()) return false;</p>
<pre><code>Rect r = (Rect) o;
return left == r.left &amp;&amp; top == r.top &amp;&amp; right == r.right &amp;&amp; bottom == r.bottom;
</code></pre>
<p>}</p>
<p>@Override<br>public int hashCode() {<br>    int result = left;<br>    result = 31 * result + top;<br>    result = 31 * result + right;<br>    result = 31 * result + bottom;<br>    return result;<br>}</p>
<p>@Override<br>public String toString() {<br>    StringBuilder sb = new StringBuilder(32);<br>    sb.append(“Rect(“); sb.append(left); sb.append(“, “);<br>    sb.append(top); sb.append(“ - “); sb.append(right);<br>    sb.append(“, “); sb.append(bottom); sb.append(“)”);<br>    return sb.toString();<br>}<br>4.3 Rect常用的一些方法</p>
<p>获取“宽”<br>//文章开头说的公式在这里得到了应验<br>public final int width() {<br>    return right - left;<br>}<br>获取“高”<br>public final int height() {<br>    return bottom - top;<br>}<br>有效性的判断<br>//因为left是最左侧，right比left还小不就不成形了么？宽高同是如此<br>public final boolean isEmpty() {<br>    return left &gt;= right || top &gt;= bottom;<br>}<br>全部置0操作<br>public void setEmpty() {<br>    left = right = top = bottom = 0;<br>}<br>设置参数方法，和构造函数的区别仅在于不会创建新对象<br>public void set(int left, int top, int right, int bottom) {<br>    this.left = left;<br>    this.top = top;<br>    this.right = right;<br>    this.bottom = bottom;<br>}<br>5.关于使用到这几个属性的自定义View</p>
<p>上面比较详细介绍了Canvas，Paint，Matrix，RectF等等的属性，作用，常用方法，接下来就需要结合具体业务需求练手写一下小案例自定义控件呢<br>5.1 自定义轮播图圆点</p>
<p>5.1.1 需求介绍<br>绘制圆环，一个实心中心圆，还有一个外圆环<br>此控件可以设置宽度和高度，可以设置颜色<br>5.1.2 思路介绍<br>3.2.1 既然是绘制圆形，可以写一个继承View的自定义view<br>3.2.2 重写onDraw方法，获取控件宽高，然后比较宽高值，取小值的一半作为圆的半径<br>3.2.3 然后分别绘制选中状态和未选中状态的圆<br>3.2.4 创建画笔Paint，并且设置相关属性，比如画笔颜色，类型等<br>3.2.5 利用canvas绘制圆，然后再又用相同方法绘制外边缘<br>3.2.6 自定义一个是否选中状态的方法，传入布尔值是否选中，然后调用view中invalidate方法<br>5.1.3 代码介绍<br>具体代码如下所示：<br>/**</p>
<ul>
<li><pre></pre></li>
<li><pre><code>@author yangchong
</code></pre>
</li>
<li><pre><code>blog  : https://github.com/yangchong211
</code></pre>
</li>
<li><pre><code>time  : 2016/5/18
</code></pre>
</li>
<li><pre><code>desc  : 红点自定义控件
</code></pre>
</li>
<li><pre><code>revise: 建议设置红点宽高一样，否则是椭圆
</code></pre>
</li>
<li><p></p>
</li>
<li><p>/<br>public class DotView extends View {</p>
<p>  private boolean isInit = false;<br>  private boolean isSelected = false;<br>  private float mViewHeight;<br>  private float mViewWidth;<br>  private float mRadius;<br>  private Paint mPaintBg = new Paint();<br>  private int mBgUnselectedColor = Color.parseColor(“#1A000000”);<br>  private int mBgSelectedColor = Color.parseColor(“#FDE26E”);<br>  private static final float mArcWidth = 2.0f;</p>
<p>  public DotView(Context context) {</p>
<pre><code>  super(context);
</code></pre>
<p>  }</p>
<p>  public DotView(Context context, AttributeSet attrs) {</p>
<pre><code>  super(context, attrs);
</code></pre>
<p>  }</p>
<p>  public DotView(Context context, AttributeSet attrs, int defStyleAttr) {</p>
<pre><code>  super(context, attrs, defStyleAttr);
</code></pre>
<p>  }</p>
<p>  @Override<br>  protected void onDraw(Canvas canvas) {</p>
<pre><code>  super.onDraw(canvas);
  if (!isInit) {
      isInit = true;
      mViewHeight = getHeight();
      mViewWidth = getWidth();
      if (mViewHeight &gt;= mViewWidth) {
          mRadius = mViewWidth / 2.f;
      } else {
          mRadius = mViewHeight / 2.f;
      }
  }

  //是否选中
  if (isSelected){
      drawSelectedDot(canvas);
  } else{
      drawUnSelectedDot(canvas);
  }
</code></pre>
<p>  }</p>
<p>  /**</p>
<ul>
<li><p>绘制选中指示器红点</p>
</li>
<li><p>@param canvas                    canvas</p>
</li>
<li><p>/<br>private void drawSelectedDot(Canvas canvas) {<br>  //设置paint相关属性<br>  mPaintBg.setAntiAlias(true);<br>  mPaintBg.setColor(mBgSelectedColor);<br>  mPaintBg.setStyle(Style.FILL);</p>
<p>  //绘制圆<br>  canvas.drawCircle(mViewWidth / 2.f, mViewHeight / 2.f, mRadius - 8.f, mPaintBg);</p>
<p>  mPaintBg.setStyle(Style.STROKE);<br>  float offset = 1.f + mArcWidth;<br>  RectF oval = new RectF(mViewWidth / 2.f - mRadius + offset, mViewHeight / 2.f - mRadius + offset,</p>
<pre><code>      mViewWidth / 2.f + mRadius - offset, mViewHeight / 2.f + mRadius - offset);
</code></pre>
<p>  //绘制指定的弧线，该弧线将被缩放以适应指定的椭圆形。<br>  canvas.drawArc(oval, 0.f, 360.f, false, mPaintBg);<br>}</p>
</li>
</ul>
<p>  /**</p>
<ul>
<li>绘制未选中指示器红点</li>
<li>@param canvas                    canvas</li>
<li>/<br>private void drawUnSelectedDot(Canvas canvas) {<br>  mPaintBg.setAntiAlias(true);<br>  mPaintBg.setColor(mBgUnselectedColor);<br>  mPaintBg.setStyle(Style.FILL);<br>  canvas.drawCircle(mViewWidth / 2.f, mViewHeight / 2.f, mRadius - 8.f, mPaintBg);<br>}</li>
</ul>
<p>  /**</p>
<ul>
<li>设置是否选中</li>
<li>@param isSelected                isSelected</li>
<li>/<br>public void setIsSelected(boolean isSelected) {<br>  this.isSelected = isSelected;<br>  //使整个视图无效。如果视图是可见的，则{@link#onDraw(android.Graphics.Canvas)}将在将来的某个时候被调用。<br>  //调用该方法，会进行重新绘制，也就是调用onDraw方法<br>  this.invalidate();<br>}<br>}</li>
</ul>
</li>
</ul>
<p>5.2 自定义圆环百分比进度条</p>
<p>5.2.1 需求分析<br>1.业务需求：可以设置圆角，可以设置圆形，如果是圆角则必须设置半径，默认圆角半径为10dp<br>2.如果设置了圆形，则即使设置圆角也无效；如果设置非圆形，则圆角生效，同时需要判断圆角半径是否大于控件宽高，处理边界逻辑<br>3.当设置圆形的时候，即使设置宽高不一样，那么取宽高中的最小值的一半为圆形半径<br>5.2.2 代码介绍<br>代码如下所示<br>public class ARoundImageView extends AppCompatImageView {</p>
<pre><code>/*
 *   Paint：画笔
 *   Canvas：画布
 *   Matrix：变换矩阵
 *
 *   业务需求：可以设置圆角，可以设置圆形，如果是圆角则必须设置半径，默认圆角半径为10dp
 */
/**
 * 圆形模式
 */
private static final int MODE_CIRCLE = 1;
/**
 * 普通模式
 */
private static final int MODE_NONE = 0;
/**
 * 圆角模式
 */
private static final int MODE_ROUND = 2;
/**
 * 圆角半径
 */
private int currRound = dp2px(10);
/**
 * 画笔
 */
private Paint mPaint;
/**
 * 默认是普通模式
 */
private int currMode = 0;

public ARoundImageView(Context context) {
    this(context,null);
}

public ARoundImageView(Context context, AttributeSet attrs) {
    this(context, attrs, 0);
}

public ARoundImageView(Context context, AttributeSet attrs, int defStyleAttr) {
    super(context, attrs, defStyleAttr);
    obtainStyledAttrs(context, attrs, defStyleAttr);
    initViews();
}

private void obtainStyledAttrs(Context context, AttributeSet attrs, int defStyleAttr) {
    TypedArray a = context.obtainStyledAttributes(attrs, R.styleable.ARoundImageView, defStyleAttr, 0);
    currMode = a.hasValue(R.styleable.ARoundImageView_type) ? a.getInt(R.styleable.ARoundImageView_type, MODE_NONE) : MODE_NONE;
    currRound = a.hasValue(R.styleable.ARoundImageView_radius) ? a.getDimensionPixelSize(R.styleable.ARoundImageView_radius, currRound) : currRound;
    a.recycle();
}

private void initViews() {
    //ANTI_ALIAS_FLAG 用于绘制时抗锯齿
    mPaint = new Paint(Paint.ANTI_ALIAS_FLAG | Paint.DITHER_FLAG);
}


/**
 * 当模式为圆形模式的时候，我们强制让宽高一致
 */
@Override
protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
    if (currMode == MODE_CIRCLE) {
        super.onMeasure(widthMeasureSpec, heightMeasureSpec);
        int result = Math.min(getMeasuredHeight(), getMeasuredWidth());
        // 此方法必须由{@link#onMeasure(int，int)}调用，以存储已测量的宽度和测量的高度。
        // 如果不这样做，将在测量时触发异常。
        setMeasuredDimension(result, result);
    } else {
        super.onMeasure(widthMeasureSpec, heightMeasureSpec);
    }
}

@SuppressLint("DrawAllocation")
@Override
protected void onDraw(Canvas canvas) {
    //获取ImageView图片资源
    Drawable mDrawable = getDrawable();
    //获取Matrix对象
    Matrix mDrawMatrix = getImageMatrix();
    if (mDrawable == null) {
        return;
    }
    if (mDrawable.getIntrinsicWidth() == 0 || mDrawable.getIntrinsicHeight() == 0) {
        return;
    }
    if (mDrawMatrix == null &amp;&amp; getPaddingTop() == 0 &amp;&amp; getPaddingLeft() == 0) {
        mDrawable.draw(canvas);
    } else {
        final int saveCount = canvas.getSaveCount();
        canvas.save();
        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.JELLY_BEAN) {
            if (getCropToPadding()) {
                final int scrollX = getScrollX();
                final int scrollY = getScrollY();
                canvas.clipRect(scrollX + getPaddingLeft(), scrollY + getPaddingTop(),
                        scrollX + getRight() - getLeft() - getPaddingRight(),
                        scrollY + getBottom() - getTop() - getPaddingBottom());
            }
        }
        canvas.translate(getPaddingLeft(), getPaddingTop());
        switch (currMode){
            case MODE_CIRCLE:
                Bitmap bitmap1 = drawable2Bitmap(mDrawable);
                mPaint.setShader(new BitmapShader(bitmap1, Shader.TileMode.CLAMP, Shader.TileMode.CLAMP));
                canvas.drawCircle(getWidth() / 2, getHeight() / 2, getWidth() / 2, mPaint);
                break;
            case MODE_ROUND:
                Bitmap bitmap2 = drawable2Bitmap(mDrawable);
                mPaint.setShader(new BitmapShader(bitmap2, Shader.TileMode.CLAMP, Shader.TileMode.CLAMP));
                canvas.drawRoundRect(new RectF(getPaddingLeft(), getPaddingTop(),
                                getWidth() - getPaddingRight(), getHeight() - getPaddingBottom()),
                        currRound, currRound, mPaint);
                break;
            case MODE_NONE:
            default:
                if (mDrawMatrix != null) {
                    canvas.concat(mDrawMatrix);
                }
                mDrawable.draw(canvas);
                break;
        }
        canvas.restoreToCount(saveCount);
    }
}

/**
 * drawable转换成bitmap
 */
private Bitmap drawable2Bitmap(Drawable drawable) {
    if (drawable == null) {
        return null;
    }
    Bitmap bitmap = Bitmap.createBitmap(getWidth(), getHeight(), Bitmap.Config.ARGB_8888);
    Canvas canvas = new Canvas(bitmap);
    //根据传递的scaleType获取matrix对象，设置给bitmap
    Matrix matrix = getImageMatrix();
    if (matrix != null) {
        canvas.concat(matrix);
    }
    drawable.draw(canvas);
    return bitmap;
}

private int dp2px(float value) {
    return (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP,
            value, getResources().getDisplayMetrics());
}
</code></pre>
<p>}</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://wenkex.gitee.io">wenke</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://wenkex.gitee.io/2022/010827358.html">https://wenkex.gitee.io/2022/010827358.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://wenkex.gitee.io" target="_blank">wenke</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/autojs/">autojs</a></div><div class="post_share"><div class="social-share" data-image="https://gitee.com/wenkex/blogimage/raw/master/infinity-3610308.jpg" data-sites="wechat,qq,facebook,twitter,weibo"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/010834543.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://gitee.com/wenkex/blogimage/raw/master/infinity-3610308.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">python基础</div></div></a></div><div class="next-post pull-right"><a href="/2022/010839456.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://gitee.com/wenkex/blogimage/raw/master/infinity-3610308.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">鸿蒙开发</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://gitee.com/wenkex/blogimage/raw/master/favicon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">wenke</div><div class="author-info__description">专注于编程,分享生活,分享知识</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">35</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">31</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/wenkexia"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/wenkexia" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/1184664659@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title=""><i class="fa fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">备用网址:https://wenkex.gitee.io (速度更快)</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#autojspro"><span class="toc-number">1.</span> <span class="toc-text">autojspro</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E6%8E%A7%E4%BB%B6"><span class="toc-number">2.</span> <span class="toc-text">基于控件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A7%E4%BB%B6%E5%B1%9E%E6%80%A7"><span class="toc-number">2.1.</span> <span class="toc-text">控件属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UiSelector%E6%8E%A7%E4%BB%B6%E9%80%89%E6%8B%A9%E5%99%A8"><span class="toc-number">2.2.</span> <span class="toc-text">UiSelector控件选择器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#findOne-timeout"><span class="toc-number">2.2.1.</span> <span class="toc-text">.findOne(timeout)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#find"><span class="toc-number">2.2.2.</span> <span class="toc-text">.find()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#findOnce-i"><span class="toc-number">2.2.3.</span> <span class="toc-text">.findOnce(i)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96"><span class="toc-number">2.2.4.</span> <span class="toc-text">其他</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UiSelector-filter-f"><span class="toc-number">2.2.5.</span> <span class="toc-text">UiSelector.filter(f)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UiObject%E6%8E%A7%E4%BB%B6%E5%AF%B9%E8%B1%A1"><span class="toc-number">2.3.</span> <span class="toc-text">UiObject控件对象</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#bounds-%E5%9D%90%E6%A0%87"><span class="toc-number">2.3.1.</span> <span class="toc-text">bounds()坐标</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E6%8E%A7%E4%BB%B6%E5%B1%9E%E6%80%A7%E7%A1%AE%E5%AE%9A%E6%8E%A7%E4%BB%B6"><span class="toc-number">2.4.</span> <span class="toc-text">基于控件属性确定控件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E6%8E%A7%E4%BB%B6%E7%88%B6%E5%AD%90%E5%85%B3%E7%B3%BB%E7%A1%AE%E5%AE%9A%E6%8E%A7%E4%BB%B6"><span class="toc-number">2.5.</span> <span class="toc-text">基于控件父子关系确定控件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BB%91%E5%8A%A8"><span class="toc-number">2.6.</span> <span class="toc-text">滑动</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BB%91%E5%8A%A8-1"><span class="toc-number">2.7.</span> <span class="toc-text">滑动</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E5%9D%90%E6%A0%87"><span class="toc-number">3.</span> <span class="toc-text">基于坐标</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E7%BD%AE"><span class="toc-number">3.1.</span> <span class="toc-text">前置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gestures"><span class="toc-number">3.2.</span> <span class="toc-text">gestures</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%8F%E5%B9%95%E7%BC%A9%E6%94%BE"><span class="toc-number">3.3.</span> <span class="toc-text">屏幕缩放</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Autojs-%E6%9C%AC%E5%9C%B0%E9%AA%8C%E8%AF%81%EF%BC%88%E4%B8%80%E6%9C%BA%E4%B8%80%E7%A0%81%EF%BC%89"><span class="toc-number">4.</span> <span class="toc-text">Autojs 本地验证（一机一码）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E4%B8%80%E6%9C%BA%E4%B8%80%E7%A0%81%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86"><span class="toc-number">4.1.</span> <span class="toc-text">1、一机一码的实现原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E4%B8%80%E6%9C%BA%E4%B8%80%E7%A0%81UI%E7%95%8C%E9%9D%A2%E7%9A%84%E5%BC%80%E5%8F%91"><span class="toc-number">4.2.</span> <span class="toc-text">2、一机一码UI界面的开发</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E6%B3%A8%E5%86%8C%E6%9C%BAUI%E7%95%8C%E9%9D%A2%E7%9A%84%E5%BC%80%E5%8F%91"><span class="toc-number">4.3.</span> <span class="toc-text">3、注册机UI界面的开发</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E8%8E%B7%E5%8F%96%E6%89%8B%E6%9C%BA%E5%94%AF%E4%B8%80%E6%A0%87%E8%AF%86"><span class="toc-number">4.4.</span> <span class="toc-text">4、获取手机唯一标识</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81%E5%AE%8C%E6%88%90%E7%AC%AC%E4%B8%80%E4%B8%AA%E8%84%9A%E6%9C%AC%E6%B3%A8%E5%86%8C%E6%9C%BA%E9%AA%8C%E8%AF%81"><span class="toc-number">4.5.</span> <span class="toc-text">5、完成第一个脚本注册机验证</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E3%80%81%E5%AF%B9%E6%89%8B%E6%9C%BA%E5%94%AF%E4%B8%80%E6%A0%87%E8%AF%86%E7%AC%A6%E8%BF%9B%E8%A1%8C%E5%8A%A0%E5%AF%86"><span class="toc-number">4.6.</span> <span class="toc-text">6、对手机唯一标识符进行加密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7%E3%80%81%E5%A2%9E%E5%8A%A0%E6%97%B6%E9%97%B4%E9%AA%8C%E8%AF%81"><span class="toc-number">4.7.</span> <span class="toc-text">7、增加时间验证</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8%E3%80%81%E5%A2%9E%E5%8A%A0%E6%97%B6%E9%97%B4%E9%AA%8C%E8%AF%81%EF%BC%88%E4%BA%8C%EF%BC%89"><span class="toc-number">4.8.</span> <span class="toc-text">8、增加时间验证（二）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9%E3%80%81%E5%BC%80%E5%8F%91%E6%97%A5%E5%8D%A1%E3%80%81%E6%9C%88%E5%8D%A1%E3%80%81%E5%B9%B4%E5%8D%A1%E5%8A%9F%E8%83%BD"><span class="toc-number">4.9.</span> <span class="toc-text">9、开发日卡、月卡、年卡功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10%E3%80%81%E6%BF%80%E6%B4%BB%E7%A0%81%E9%99%90%E5%88%B6%E8%84%9A%E6%9C%AC%E8%BF%90%E8%A1%8C"><span class="toc-number">4.10.</span> <span class="toc-text">10、激活码限制脚本运行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11%E3%80%81%E4%BF%9D%E5%AD%98%E6%BF%80%E6%B4%BB%E7%8A%B6%E6%80%81%E5%88%B0%E6%9C%AC%E5%9C%B0"><span class="toc-number">4.11.</span> <span class="toc-text">11、保存激活状态到本地</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12%E3%80%81%E8%A7%A3%E5%86%B3%E6%97%B6%E9%97%B4%E9%AA%8C%E8%AF%81bug%E6%96%B9%E6%B3%95"><span class="toc-number">4.12.</span> <span class="toc-text">12、解决时间验证bug方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13%E3%80%81%E5%AE%8C%E5%96%84%E6%BF%80%E6%B4%BB%E7%A0%81%E4%BA%A4%E4%BA%92%E9%80%BB%E8%BE%91"><span class="toc-number">4.13.</span> <span class="toc-text">13、完善激活码交互逻辑</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14%E3%80%81%E5%B0%81%E8%A3%85%E9%AA%8C%E8%AF%81%E6%BF%80%E6%B4%BB%E7%A0%81%E5%87%BD%E6%95%B0-%E4%B8%80"><span class="toc-number">4.14.</span> <span class="toc-text">14、封装验证激活码函数(一)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15%E3%80%81%E5%B0%81%E8%A3%85%E9%AA%8C%E8%AF%81%E6%BF%80%E6%B4%BB%E7%A0%81%E5%87%BD%E6%95%B0-%E4%BA%8C"><span class="toc-number">4.15.</span> <span class="toc-text">15、封装验证激活码函数(二)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16%E3%80%81%E5%B0%81%E8%A3%85%E6%B3%A8%E5%86%8C%E6%9C%BA%E5%8A%A0%E5%AF%86%E5%87%BD%E6%95%B0"><span class="toc-number">4.16.</span> <span class="toc-text">16、封装注册机加密函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17%E3%80%81%E5%8D%87%E7%BA%A7%E5%8A%A0%E5%AF%86%E5%A4%8D%E6%9D%82%E5%BA%A6%EF%BC%88%E4%B8%80%EF%BC%89"><span class="toc-number">4.17.</span> <span class="toc-text">17、升级加密复杂度（一）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18%E3%80%81%E5%8D%87%E7%BA%A7%E5%8A%A0%E5%AF%86%E5%A4%8D%E6%9D%82%E5%BA%A6%EF%BC%88%E4%BA%8C%EF%BC%89"><span class="toc-number">4.18.</span> <span class="toc-text">18、升级加密复杂度（二）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19%E3%80%81%E5%A2%9E%E5%8A%A0%E8%BF%90%E8%A1%8C%E8%84%9A%E6%9C%AC%E6%97%B6%E7%9A%84%E9%AA%8C%E8%AF%81%E6%96%B9%E6%B3%95"><span class="toc-number">4.19.</span> <span class="toc-text">19、增加运行脚本时的验证方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#20%E3%80%81%E7%BB%99%E8%84%9A%E6%9C%AC%E6%B7%BB%E5%8A%A0%E4%B8%80%E6%9C%BA%E4%B8%80%E7%A0%81%E5%8A%9F%E8%83%BD%EF%BC%88%E4%B8%80%EF%BC%89"><span class="toc-number">4.20.</span> <span class="toc-text">20、给脚本添加一机一码功能（一）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#21%E3%80%81%E7%BB%99%E8%84%9A%E6%9C%AC%E6%B7%BB%E5%8A%A0%E4%B8%80%E6%9C%BA%E4%B8%80%E7%A0%81%E5%8A%9F%E8%83%BD%EF%BC%88%E4%BA%8C%EF%BC%89"><span class="toc-number">4.21.</span> <span class="toc-text">21、给脚本添加一机一码功能（二）</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%86%99%E6%B8%B8%E6%88%8F%E8%84%9A%E6%9C%AC"><span class="toc-number">5.</span> <span class="toc-text">如何写游戏脚本</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A6%E6%91%B8%E6%A8%A1%E6%8B%9F"><span class="toc-number">5.1.</span> <span class="toc-text">触摸模拟</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#colors"><span class="toc-number">5.2.</span> <span class="toc-text">colors</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#images"><span class="toc-number">5.3.</span> <span class="toc-text">images</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E7%BB%93%E6%9E%84%E7%AE%A1%E7%90%86"><span class="toc-number">5.4.</span> <span class="toc-text">脚本结构管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Module"><span class="toc-number">5.4.1.</span> <span class="toc-text">Module</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Threads"><span class="toc-number">5.4.2.</span> <span class="toc-text">Threads</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%A4%E4%BA%92%E7%95%8C%E9%9D%A2"><span class="toc-number">5.5.</span> <span class="toc-text">交互界面</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Events%E3%80%81Dialogs%E3%80%81Console"><span class="toc-number">5.5.1.</span> <span class="toc-text">Events、Dialogs、Console</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Floaty%E3%80%81UI"><span class="toc-number">5.5.2.</span> <span class="toc-text">Floaty、UI</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%99%E4%B8%80%E4%B8%AA%E6%B3%A8%E5%86%8C%E6%9C%BA"><span class="toc-number">6.</span> <span class="toc-text">写一个注册机</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD%E5%B0%81%E8%A3%85"><span class="toc-number">7.</span> <span class="toc-text">常用功能封装</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E4%BA%91%E6%96%87%E4%BB%B6"><span class="toc-number">7.1.</span> <span class="toc-text">调用云文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B0%83%E8%B5%B7apk%E5%AE%89%E8%A3%85"><span class="toc-number">7.2.</span> <span class="toc-text">调起apk安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%9A%82%E8%9A%81%E6%A3%AE%E6%9E%97"><span class="toc-number">7.3.</span> <span class="toc-text">蚂蚁森林</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9A%B4%E5%8A%9B%E7%82%B9%E5%87%BB%E8%83%BD%E9%87%8F%E7%90%83"><span class="toc-number">7.3.1.</span> <span class="toc-text">暴力点击能量球</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96json"><span class="toc-number">7.4.</span> <span class="toc-text">读取json</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E8%AE%BE%E5%A4%87%E5%94%AF%E4%B8%80%E6%A0%87%E8%AF%86"><span class="toc-number">7.5.</span> <span class="toc-text">获取设备唯一标识</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%BA%E5%88%B6%E7%BB%93%E6%9D%9Fapp%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="toc-number">7.6.</span> <span class="toc-text">强制结束app进程的功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%90%E5%8F%96%E6%96%87%E6%9C%AC%E4%B8%AD%E7%9A%84%E6%95%B0%E5%AD%97%E7%9A%84%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">7.7.</span> <span class="toc-text">提取文本中的数字的正则表达式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E5%8D%93%E6%97%A0%E9%9A%9C%E7%A2%8D"><span class="toc-number">7.8.</span> <span class="toc-text">安卓无障碍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E7%BB%AD%E6%8C%89%E4%B8%A4%E6%AC%A1%E8%BF%94%E5%9B%9E%E9%94%AE%E9%80%80%E5%87%BA"><span class="toc-number">7.9.</span> <span class="toc-text">连续按两次返回键退出</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%8F%90%E7%A4%BA"><span class="toc-number">7.10.</span> <span class="toc-text">信息提示</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%88%AA%E5%9B%BE%E7%9B%B8%E5%85%B3"><span class="toc-number">7.11.</span> <span class="toc-text">截图相关</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8A%E4%B8%8B%E6%BB%91%E5%8A%A8%E7%BF%BB%E9%A1%B5"><span class="toc-number">7.12.</span> <span class="toc-text">上下滑动翻页</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%87%8D%E5%A4%8D%E6%89%A7%E8%A1%8C%E5%87%A0%E6%AC%A1"><span class="toc-number">7.13.</span> <span class="toc-text">重复执行几次</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%BB%91%E5%B1%8F%E8%B7%91%E8%84%9A%E6%9C%AC-%E7%9C%81%E7%94%B5"><span class="toc-number">7.14.</span> <span class="toc-text">黑屏跑脚本(省电)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E9%94%AE%E5%90%AF%E5%8A%A8%E6%97%A0%E9%9A%9C%E7%A2%8D"><span class="toc-number">7.15.</span> <span class="toc-text">一键启动无障碍</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Bmob-%E5%90%8E%E7%AB%AF%E4%BA%91"><span class="toc-number">8.</span> <span class="toc-text">Bmob 后端云</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%82%B9%E5%87%BB%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%9A"><span class="toc-number">9.</span> <span class="toc-text">点击的方法：</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A7%E4%BB%B6%E7%82%B9%E5%87%BB"><span class="toc-number">9.1.</span> <span class="toc-text">控件点击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%82%E7%BA%A7%E7%BB%93%E6%9E%84"><span class="toc-number">9.2.</span> <span class="toc-text">层级结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%86%E5%9B%BE%E7%82%B9%E5%87%BB"><span class="toc-number">9.3.</span> <span class="toc-text">识图点击</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E5%87%BD%E6%95%B0"><span class="toc-number">9.3.1.</span> <span class="toc-text">核心函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E7%9A%84MatchingResult%E5%AF%B9%E8%B1%A1"><span class="toc-number">9.3.2.</span> <span class="toc-text">返回的MatchingResult对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#base64%E7%BC%96%E7%A0%81%E8%BD%AC%E6%8D%A2"><span class="toc-number">9.3.3.</span> <span class="toc-text">base64编码转换</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Base64"><span class="toc-number">9.3.3.1.</span> <span class="toc-text">Base64</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bytes"><span class="toc-number">9.3.3.2.</span> <span class="toc-text">bytes</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90"><span class="toc-number">9.3.4.</span> <span class="toc-text">例子</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8C%BA%E5%9F%9F%E6%89%BE%E8%89%B2%E7%82%B9%E5%87%BB"><span class="toc-number">9.4.</span> <span class="toc-text">区域找色点击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E7%82%B9%E6%89%BE%E8%89%B2%E7%82%B9%E5%87%BB"><span class="toc-number">9.5.</span> <span class="toc-text">多点找色点击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ocr%E7%82%B9%E5%87%BB"><span class="toc-number">9.6.</span> <span class="toc-text">ocr点击</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%99%BE%E5%BA%A6ocr"><span class="toc-number">9.6.1.</span> <span class="toc-text">百度ocr</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%A9%E7%84%B6ocr"><span class="toc-number">9.6.2.</span> <span class="toc-text">浩然ocr</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9D%90%E6%A0%87%E7%82%B9%E5%87%BB"><span class="toc-number">9.7.</span> <span class="toc-text">坐标点击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BD%AE%E5%BB%93%E8%AF%86%E5%88%AB"><span class="toc-number">9.8.</span> <span class="toc-text">轮廓识别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E7%82%B9%E5%87%BB%E5%AD%97%E7%AC%A6"><span class="toc-number">9.9.</span> <span class="toc-text">直接点击字符</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE"><span class="toc-number">10.</span> <span class="toc-text">意图</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Scheme"><span class="toc-number">10.1.</span> <span class="toc-text">Scheme</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#intent%E8%B7%B3%E8%BD%AC"><span class="toc-number">10.2.</span> <span class="toc-text">intent跳转</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8intent%E6%89%93%E5%BC%80%E6%96%B0%E6%B5%AA%E5%BE%AE%E5%8D%9A%E7%9A%84%E7%94%A8%E6%88%B7%E4%BB%BB%E5%8A%A1%E4%B8%AD%E5%BF%83scheme"><span class="toc-number">10.3.</span> <span class="toc-text">使用intent打开新浪微博的用户任务中心scheme</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#app-intent"><span class="toc-number">10.4.</span> <span class="toc-text">app.intent()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1-Service-%EF%BC%9A"><span class="toc-number">10.5.</span> <span class="toc-text">启动服务(Service)：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%A0%E9%80%92%E5%B9%BF%E6%92%AD%EF%BC%9A"><span class="toc-number">10.6.</span> <span class="toc-text">传递广播：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%B4%E8%BE%BE%E5%BA%94%E7%94%A8%E5%86%85%E7%9A%84%E6%9F%90%E4%B8%AA%E9%A1%B5%E9%9D%A2%E2%80%94%E2%80%94%E5%90%AF%E5%8A%A8Activity"><span class="toc-number">10.7.</span> <span class="toc-text">直达应用内的某个页面——启动Activity</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8app-startActivity"><span class="toc-number">10.7.1.</span> <span class="toc-text">用app.startActivity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8Shell%E5%91%BD%E4%BB%A4%EF%BC%88%E4%BC%BC%E4%B9%8E%E5%90%8E%E4%B8%80%E7%A7%8D%E6%9B%B4%E7%AE%80%E6%B4%81%E6%96%B9%E4%BE%BF%EF%BC%89"><span class="toc-number">10.7.2.</span> <span class="toc-text">用Shell命令（似乎后一种更简洁方便）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E6%84%8F%E5%9B%BE"><span class="toc-number">10.8.</span> <span class="toc-text">微信意图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%AF%E4%BB%98%E5%AE%9D%E6%84%8F%E5%9B%BE"><span class="toc-number">10.9.</span> <span class="toc-text">支付宝意图</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Rhino%E5%BC%95%E6%93%8E"><span class="toc-number">11.</span> <span class="toc-text">Rhino引擎</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-number">11.1.</span> <span class="toc-text">环境准备</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#vscode%E6%8F%92%E4%BB%B6"><span class="toc-number">11.1.1.</span> <span class="toc-text">vscode插件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Auto-js-Pro-Ext-1-4"><span class="toc-number">11.1.2.</span> <span class="toc-text">Auto.js-Pro-Ext 1.4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#scrcpy%E6%8A%95%E5%B1%8F"><span class="toc-number">11.1.3.</span> <span class="toc-text">scrcpy投屏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E5%90%88webditor"><span class="toc-number">11.1.4.</span> <span class="toc-text">结合webditor</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shell%E5%91%BD%E4%BB%A4"><span class="toc-number">11.2.</span> <span class="toc-text">shell命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#opencv-autojs%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">11.3.</span> <span class="toc-text">opencv-autojs常用命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E6%8A%80%E5%B7%A7"><span class="toc-number">11.4.</span> <span class="toc-text">小技巧</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#autojs%E6%8F%90%E5%8F%96%E8%BD%AF%E4%BB%B6%E8%87%AA%E5%B8%A6%E4%BE%8B%E5%AD%90"><span class="toc-number">11.4.1.</span> <span class="toc-text">autojs提取软件自带例子</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%AE%E9%A2%98"><span class="toc-number">11.5.</span> <span class="toc-text">问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%AF%E4%BB%98%E5%AE%9D-%E5%BE%AE%E4%BF%A1-%E5%85%B6%E4%BB%96%E8%BD%AF%E4%BB%B6"><span class="toc-number">11.5.1.</span> <span class="toc-text">支付宝&#x2F;微信&#x2F;其他软件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#http-put"><span class="toc-number">11.6.</span> <span class="toc-text">http put</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E4%B8%8E%E7%9B%91%E5%90%AC-Events"><span class="toc-number">11.7.</span> <span class="toc-text">事件与监听 - Events</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E5%8F%B0-Console"><span class="toc-number">11.8.</span> <span class="toc-text">控制台 - Console</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E5%82%A8%E5%AD%98-Storages"><span class="toc-number">11.9.</span> <span class="toc-text">本地储存 - Storages</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E4%B8%8E%E9%A2%9C%E8%89%B2"><span class="toc-number">11.10.</span> <span class="toc-text">图片与颜色</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dex"><span class="toc-number">11.11.</span> <span class="toc-text">dex</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E7%BA%BF%E7%A8%8B-Threads"><span class="toc-number">11.12.</span> <span class="toc-text">多线程 - Threads</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%82%AC%E6%B5%AE%E7%AA%97-Floaty"><span class="toc-number">11.13.</span> <span class="toc-text">悬浮窗 - Floaty</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#FloatyWindow%E5%AF%B9%E8%B1%A1"><span class="toc-number">11.13.1.</span> <span class="toc-text">FloatyWindow对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FloatyRawWindow%E5%AF%B9%E8%B1%A1"><span class="toc-number">11.13.2.</span> <span class="toc-text">FloatyRawWindow对象</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E8%AF%9D%E6%A1%86-Dialogs"><span class="toc-number">11.14.</span> <span class="toc-text">对话框 - Dialogs</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ui"><span class="toc-number">11.15.</span> <span class="toc-text">ui</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE-View"><span class="toc-number">11.15.1.</span> <span class="toc-text">视图: View</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E5%B1%9E%E6%80%A7"><span class="toc-number">11.15.2.</span> <span class="toc-text">视图属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E8%A7%86%E5%9B%BE%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="toc-number">11.15.3.</span> <span class="toc-text">对视图的操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A7%E4%BB%B6"><span class="toc-number">11.15.4.</span> <span class="toc-text">控件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8ui%E4%BD%BF%E7%94%A8webview"><span class="toc-number">11.15.5.</span> <span class="toc-text">在ui使用webview</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">11.16.</span> <span class="toc-text">数据库</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%94%A8MCV%E6%A1%86%E6%9E%B6%E5%AE%9E%E7%8E%B0%E7%95%8C%E9%9D%A2%E5%88%87%E6%8D%A2"><span class="toc-number">12.</span> <span class="toc-text">用MCV框架实现界面切换</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#main-js"><span class="toc-number">12.1.</span> <span class="toc-text">main.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#model-js"><span class="toc-number">12.2.</span> <span class="toc-text">model.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#controller-js"><span class="toc-number">12.3.</span> <span class="toc-text">controller.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#view-js"><span class="toc-number">12.4.</span> <span class="toc-text">view.js</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B"><span class="toc-number">13.</span> <span class="toc-text">进程与线程</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%94%BB%E5%B8%83"><span class="toc-number">14.</span> <span class="toc-text">画布</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Paint%E7%94%BB%E7%AC%94%E4%BB%8B%E7%BB%8D"><span class="toc-number">14.1.</span> <span class="toc-text">1.Paint画笔介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6"><span class="toc-number">14.1.1.</span> <span class="toc-text">1.1 图形绘制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E6%96%87%E6%9C%AC%E7%BB%98%E5%88%B6"><span class="toc-number">14.1.2.</span> <span class="toc-text">1.2 文本绘制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Canvas%E7%94%BB%E5%B8%83%E4%BB%8B%E7%BB%8D"><span class="toc-number">14.2.</span> <span class="toc-text">2.Canvas画布介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E8%AE%BE%E7%BD%AE%E5%B1%9E%E6%80%A7"><span class="toc-number">14.2.1.</span> <span class="toc-text">2.1 设置属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E7%94%BB%E5%9B%BE%E3%80%90%E9%87%8D%E7%82%B9%E3%80%91"><span class="toc-number">14.2.2.</span> <span class="toc-text">2.2 画图【重点】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-Canvas%E5%AF%B9%E8%B1%A1%E7%9A%84%E8%8E%B7%E5%8F%96%E6%96%B9%E5%BC%8F"><span class="toc-number">14.2.3.</span> <span class="toc-text">2.3 Canvas对象的获取方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-Canvas%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">14.2.4.</span> <span class="toc-text">2.4 Canvas的作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-Canvas%E7%BB%98%E5%88%B6%E5%9C%86%E5%92%8C%E6%A4%AD%E5%9C%86"><span class="toc-number">14.2.5.</span> <span class="toc-text">2.5 Canvas绘制圆和椭圆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-Canvas%E7%BB%98%E5%88%B6%E7%9F%A9%E5%BD%A2%E3%80%81%E5%9C%86%E8%A7%92%E7%9F%A9%E5%BD%A2"><span class="toc-number">14.2.6.</span> <span class="toc-text">2.6 Canvas绘制矩形、圆角矩形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-Canvas%E7%BB%98%E5%88%B6%E6%96%87%E5%AD%97"><span class="toc-number">14.2.7.</span> <span class="toc-text">2.7 Canvas绘制文字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-8-Canvas%E7%BB%98%E5%88%B6%E5%BC%A7%E5%BD%A2%E3%80%81%E5%B0%81%E9%97%AD%E5%BC%A7%E5%BD%A2"><span class="toc-number">14.2.8.</span> <span class="toc-text">2.8 Canvas绘制弧形、封闭弧形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-9-Canvas%E7%BB%98%E5%88%B6Path%E8%B7%AF%E5%BE%84"><span class="toc-number">14.2.9.</span> <span class="toc-text">2.9 Canvas绘制Path路径</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Matrix%E5%8F%98%E6%8D%A2%E7%9F%A9%E9%98%B5%E4%BB%8B%E7%BB%8D%E3%80%90Canvas%E4%BD%8D%E7%BD%AE%E8%BD%AC%E6%8D%A2%E3%80%91"><span class="toc-number">14.3.</span> <span class="toc-text">3.Matrix变换矩阵介绍【Canvas位置转换】</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/081920764.html" title="nodejs学习">nodejs学习</a><time datetime="2022-08-19T07:39:35.000Z" title="发表于 2022-08-19 15:39:35">2022-08-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/062453983.html" title="题目集合">题目集合</a><time datetime="2022-06-24T00:00:27.000Z" title="发表于 2022-06-24 08:00:27">2022-06-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/051717870.html" title="计算机原理">计算机原理</a><time datetime="2022-05-17T03:07:09.000Z" title="发表于 2022-05-17 11:07:09">2022-05-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/050513105.html" title="正则表达式学习">正则表达式学习</a><time datetime="2022-05-05T00:53:39.000Z" title="发表于 2022-05-05 08:53:39">2022-05-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/042334747.html" title="数据库-SQLite">数据库-SQLite</a><time datetime="2022-04-23T08:35:42.000Z" title="发表于 2022-04-23 16:35:42">2022-04-23</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By wenke</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://butterfly.js.org/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'BbuBjGh9to6TtPug5KeFflx1-gzGzoHsz',
      appKey: '73XAE3zu9AokVhAvE61OP01g',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: true
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="true" data-text="虾,科,ke,xia" data-fontsize="15px" data-random="true" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e&&e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this);</script></body></html>