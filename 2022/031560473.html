<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>flask学习笔记 | wenke</title><meta name="keywords" content="flask"><meta name="author" content="wenke"><meta name="copyright" content="wenke"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="参考文章https:&#x2F;&#x2F;www.w3cschool.cn&#x2F;flask&#x2F; flask中文文档 https:&#x2F;&#x2F;www.imooc.com&#x2F;wiki&#x2F;flasklesson&#x2F;flaskormoverview.html https:&#x2F;&#x2F;www.w3cschool.cn&#x2F;flask&#x2F;flask-kbid3h91.html 知了传课 步骤https:&#x2F;&#x2F;blog.csdn.net&#x2F;asd529735325&#x2F;">
<meta property="og:type" content="article">
<meta property="og:title" content="flask学习笔记">
<meta property="og:url" content="https://wenkex.gitee.io/2022/031560473.html">
<meta property="og:site_name" content="wenke">
<meta property="og:description" content="参考文章https:&#x2F;&#x2F;www.w3cschool.cn&#x2F;flask&#x2F; flask中文文档 https:&#x2F;&#x2F;www.imooc.com&#x2F;wiki&#x2F;flasklesson&#x2F;flaskormoverview.html https:&#x2F;&#x2F;www.w3cschool.cn&#x2F;flask&#x2F;flask-kbid3h91.html 知了传课 步骤https:&#x2F;&#x2F;blog.csdn.net&#x2F;asd529735325&#x2F;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/wenkex/blogimage/raw/master/infinity-3610308.jpg">
<meta property="article:published_time" content="2022-03-15T12:00:45.000Z">
<meta property="article:modified_time" content="2022-03-15T12:00:45.000Z">
<meta property="article:author" content="wenke">
<meta property="article:tag" content="flask">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/wenkex/blogimage/raw/master/infinity-3610308.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://wenkex.gitee.io/2022/031560473"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?d103aef22d2746c3d56e2dae461c4699";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="stylesheet" href="/wenke" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"距离上次更新已经过了","messageNext":"天， 文章内容可能已过期，请留意"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":1000,"languages":{"author":"作者: wenke","link":"链接: ","source":"来源: wenke","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'flask学习笔记',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-03-15 20:00:45'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.0.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="wenke" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://gitee.com/wenkex/blogimage/raw/master/favicon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">35</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">31</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">13</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-book-open"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/box/"><i class="fa-fw fas fa-tags"></i><span> 聚合</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-heart"></i><span> 相册</span></a></div><div class="menus_item"><a class="site-page" href="/contact/"><i class="fa-fw fas fa-list"></i><span> 留言板</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://gitee.com/wenkex/blogimage/raw/master/infinity-3610308.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">wenke</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-book-open"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/box/"><i class="fa-fw fas fa-tags"></i><span> 聚合</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-heart"></i><span> 相册</span></a></div><div class="menus_item"><a class="site-page" href="/contact/"><i class="fa-fw fas fa-list"></i><span> 留言板</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">flask学习笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-03-15T12:00:45.000Z" title="发表于 2022-03-15 20:00:45">2022-03-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-03-15T12:00:45.000Z" title="更新于 2022-03-15 20:00:45">2022-03-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/python/">python</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">9.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>35分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="flask学习笔记"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><p><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/flask/">https://www.w3cschool.cn/flask/</a></p>
<p><a target="_blank" rel="noopener" href="https://dormousehole.readthedocs.io/en/latest/index.html">flask中文文档</a></p>
<p><a target="_blank" rel="noopener" href="https://www.imooc.com/wiki/flasklesson/flaskormoverview.html">https://www.imooc.com/wiki/flasklesson/flaskormoverview.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/flask/flask-kbid3h91.html">https://www.w3cschool.cn/flask/flask-kbid3h91.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.zlkt.net/book/detail/10">知了传课</a></p>
<h1 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/asd529735325/article/details/103011940">https://blog.csdn.net/asd529735325/article/details/103011940</a></p>
<h1 id="web前置"><a href="#web前置" class="headerlink" title="web前置"></a>web前置</h1><h2 id="MVC模式"><a href="#MVC模式" class="headerlink" title="MVC模式"></a>MVC模式</h2><p>M是指业务模型，V是指用户界面，C则是控制器，使用MVC的目的是将M和V的实现代码分离，从而使同一个程序可以使用不同的表现形式<br>model：模型<br>view：视图<br>controler:控制器</p>
<h2 id="WSGI-Python-Web-Server-Gateway-Interface"><a href="#WSGI-Python-Web-Server-Gateway-Interface" class="headerlink" title="WSGI(Python Web Server Gateway Interface)"></a>WSGI(Python Web Server Gateway Interface)</h2><p>指定了web服务器和Python web应用或web框架之间的标准接口，以提高web应用在一系列web服务器间的移植性</p>
<h2 id="HTTP协议"><a href="#HTTP协议" class="headerlink" title="HTTP协议"></a>HTTP协议</h2><p>超文本传输协议（HTTP）<br>因为我们在网页上看到的内容通常是浏览器执行 HTML （超文本标记语言）得到的结果，而 HTTP 就是传输 HTML 数据的协议。HTTP 和其他很多应用级协议一样是构建在 TCP（传输控制协议）之上的，它利用了 TCP 提供的可靠的传输服务实现了 Web 应用中的数据交换。 关于 HTTP 的详细信息以及目前的发展状况，大家可以阅读<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2016/08/http.html">《HTTP 协议入门》</a>、<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2012/05/internet_protocol_suite_part_i.html">《互联网协议入门》</a>、<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2014/09/illustration-ssl.html">《图解 HTTPS 协议》</a>等文章进行了解。</p>
<h3 id="reques请求"><a href="#reques请求" class="headerlink" title="reques请求"></a>reques请求</h3><p>请求头（headers）<br>请求头由若干键值对构成，包含了浏览器、编码方式、首选语言、缓存策略等信息；</p>
<p>请求体（request body）</p>
<h4 id="请求行"><a href="#请求行" class="headerlink" title="请求行"></a>请求行</h4><p>请求方法有8种：<br>GET（完整请求一个资源）、<br>POST（提交表单）<br>PUT（上传文件）<br>DELETE（删除）、</p>
<h3 id="repose响应"><a href="#repose响应" class="headerlink" title="repose响应"></a>repose响应</h3><p>响应行包含了协议版本和响应状态码</p>
<p>响应头<br>响应头与 HTTP 请求中的请求头类似，同样由头部字段名、冒号、空格和值组成<br>响应头中包含了一系列服务器的信息，以及服务器对请求的响应。</p>
<p>响应体<br>HTTP 响应中同样使用空行来表示响应头结束。响应体则是服务器根据客户端的请求返回给客户端的具体数据。可能是 HTML 页面，也有可能是JSON或二进制数据等</p>
<h1 id="flask"><a href="#flask" class="headerlink" title="flask"></a>flask</h1><p>安装<code>pip install flask</code></p>
<h2 id="flask应用"><a href="#flask应用" class="headerlink" title="flask应用"></a>flask应用</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入Flask模块</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"></span><br><span class="line"><span class="comment">#创建Flask实例对象，这是一个WSGI应用程序。</span></span><br><span class="line"><span class="comment"># 使用当前模块（__name __）的名称作为参数。</span></span><br><span class="line"><span class="comment">#作用一，寻找模板时以当前文件为参考</span></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># route装饰器将url绑定一个函数</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/'</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello_world</span>():</span></span><br><span class="line">   <span class="keyword">return</span> <span class="string">'Hello World'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">   app.run(debug = <span class="literal">True</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>Flask类的run()方法在本地开发服务器上运行应用程序。</p>
<p>app.run(host, port, debug, options)<br>    host要监听的主机名。 默认为127.0.0.1（localhost）。设置为“0.0.0.0”以使服务器在外部可用<br>    port默认值为5000<br>    debug默认为false。 如果设置为true，则提供调试信息<br>    options要转发到底层的Werkzeug服务器。</p>
<h2 id="app-route-路由"><a href="#app-route-路由" class="headerlink" title="@app.route()路由"></a>@app.route()路由</h2><p>使用@app.route()装饰器，并传入URL规则作为参数，将函数绑定到URL，这个过程便将一个视图函数注册为路由</p>
<h3 id="变量规则"><a href="#变量规则" class="headerlink" title="变量规则"></a>变量规则</h3><p>通过把 URL 的一部分标记为 <code>&lt;variable_name&gt;</code> 就可以在 URL 中添加变量。标记的 部分会作为关键字参数传递给函数。通过使用 <code>&lt;converter:variable_name&gt;</code> ，可以 选择性的加上一个转换器，为变量指定规则。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># app.py</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/hello/&lt;name&gt;'</span></span>)   </span><span class="comment">#路由</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello_name</span>(<span class="params">name</span>):</span>         <span class="comment">#视图函数</span></span><br><span class="line">   <span class="keyword">return</span> <span class="string">'Hello %s!'</span> % name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#调试模式,如果代码更改，服务器将自行重新加载。会在终端提示错误</span></span><br><span class="line">app.run(host=<span class="string">"127.0.0.1"</span>,post=<span class="string">''</span>,debug = <span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>还可以使用转换器构建规则<br>  <code>@app.route('/blog/&lt;int:postID&gt;')</code><br>  int    接受正整数<br>  float    接受正浮点数<br>  path    类似 string ，但可以包含斜杠<br>  uuid    接受 UUID 字符串<br>  string    （缺省值） 接受任何不包含斜杠的文本</p>
<h3 id="唯一的URL-重定向行为"><a href="#唯一的URL-重定向行为" class="headerlink" title="唯一的URL/重定向行为"></a>唯一的URL/重定向行为</h3><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/user/'</span></span>) </span></span><br></pre></td></tr></tbody></table></figure>
<p>尾部有/，无论请求的Url是否带有/，都可以执行视图函数，访问一个没有斜杠结尾的 URL 时 Flask 会自动进行重定向，帮你在尾部加上一个斜杠。</p>
<p>尾部没有/，如果访问这个 URL 时添加了尾部斜杠就会得到一个 404 错误。这样可以保持 URL 唯一，并帮助 搜索引擎避免重复索引同一页面。</p>
<h3 id="URL-构建"><a href="#URL-构建" class="headerlink" title="URL 构建"></a>URL 构建</h3><p><strong>url_for()函数</strong>用于构建指定函数的 URL。</p>
<p>  接受函数的名称作为第一个参数，<br>  任意个关键字参数，每个参数对应于URL的变量部分。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, redirect, url_for</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/admin'</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello_admin</span>():</span></span><br><span class="line">   <span class="keyword">return</span> <span class="string">'Hello Admin'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/user/&lt;name&gt;'</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello_user</span>(<span class="params">name</span>):</span></span><br><span class="line">   <span class="keyword">if</span> name ==<span class="string">'admin'</span>:</span><br><span class="line">    <span class="comment"># 如果匹配，则使用url_for()将应用程序重定向到hello_admin()函数</span></span><br><span class="line">      <span class="keyword">return</span> redirect(url_for(<span class="string">'hello_admin'</span>))</span><br><span class="line">   <span class="keyword">else</span>:</span><br><span class="line">      <span class="keyword">return</span> redirect(url_for(<span class="string">'hello_guest'</span>, guest = name))</span><br></pre></td></tr></tbody></table></figure>

<p>为什么不在把 URL 写死在模板中，而要使用反转函数 url_for() 动态构建？</p>
<p>1.URL反转：根据视图函数名称得到当前所指向的url,函数名一般很少更改，当更改url时就不用改全部辣</p>
<p>2.url_for() 函数最简单的用法是以视图函数名作为参数，返回对应的url，还可以用作加载静态文件，如在模版中加载css静态文件.<code>&lt;link rel="stylesheet" href="{{url_for('static',filename='css/index.css')}}"&gt;</code></p>
<h3 id="页面跳转和重定向："><a href="#页面跳转和重定向：" class="headerlink" title="页面跳转和重定向："></a>页面跳转和重定向：</h3><p>redirect 是重定向函数，输入一个URL后，自动跳转到另一个URL所在的地址 </p>
<ul>
<li><p>永久性重定向：http的状态码是301，多用于旧网址被废弃了要转到一个新的网址确保用户的访问，最经典的就是京东网站，你输入<a target="_blank" rel="noopener" href="http://www.jingdong.com的时候,会被重定向到www.jd.com,因为jingdong.com这个网址已经被废弃了,被改成jd.com,所以这种情况下应该用永久重定向./">www.jingdong.com的时候，会被重定向到www.jd.com，因为jingdong.com这个网址已经被废弃了，被改成jd.com，所以这种情况下应该用永久重定向。</a></p>
</li>
<li><p>暂时性重定向：http的状态码是302，表示页面的暂时性跳转。比如访问一个需要权限的网址，如果当前用户没有登录，应该重定向到登录页面，这种情况下，应该用暂时性重定向。</p>
</li>
</ul>
<p>在flask中，重定向是通过flask.redirect(location,code=302)这个函数来实现的，location表示需要重定向到的URL，应该配合之前讲的url_for()函数来使用，code表示采用哪个重定向，默认是302也即暂时性重定向，可以修改成301来实现永久性重定向。</p>
<p>以下来看一个例子，关于在flask中怎么使用重定向：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,url_for,redirect</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.debug = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/login/'</span>,methods=[<span class="string">'GET'</span>,<span class="string">'POST'</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'login page'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/profile/'</span>,methods=[<span class="string">'GET'</span>,<span class="string">'POST'</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">profile</span>():</span></span><br><span class="line">    name = request.args.get(<span class="string">'name'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> name:</span><br><span class="line">    <span class="comment"># 如果没有name，说明没有登录，重定向到登录页面</span></span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">'login'</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> name</span><br></pre></td></tr></tbody></table></figure>
<h3 id="HTTP-方法"><a href="#HTTP-方法" class="headerlink" title="HTTP 方法"></a>HTTP 方法</h3><p>Web 应用使用不同的 HTTP 方法处理 URL 。 缺省情况下，一个路由只回应 GET 请求。 可以使用 route() 装饰器的 methods 参数来处理不同的 HTTP 方法:</p>
<p>1.从服务器获取数据一般用Get请求<br>2.把数据发送给服务器用Post请求</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/login'</span>, methods=[<span class="string">'GET'</span>, <span class="string">'POST'</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span>():</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">'POST'</span>:</span><br><span class="line">        <span class="keyword">return</span> do_the_login()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> show_the_login_form()</span><br></pre></td></tr></tbody></table></figure>
<p>如果当前使用了 GET 方法， Flask 会自动添加 HEAD 方法支持，并且同时还会 按照 HTTP RFC 来处理 HEAD 请求。同样， OPTIONS 也会自动实现。</p>
<h2 id="Jinja模板"><a href="#Jinja模板" class="headerlink" title="Jinja模板"></a>Jinja模板</h2><p>视图函数只负责业务逻辑和数据处理(业务逻辑方面)<br>而模板则取到视图函数的数据结果进行展示(视图展示方面)</p>
<p>在项目下创建 templates 文件夹，用于存放所有html模板文件</p>
<h3 id="Flask渲染Jinja模板"><a href="#Flask渲染Jinja模板" class="headerlink" title="Flask渲染Jinja模板"></a>Flask渲染Jinja模板</h3><p>当访问/about/的时候，about()函数会在当前目录下的templates文件夹下寻找about.html模板文件。如果想更改模板文件地址，应该在创建app的时候，给Flask传递一个关键字参数template_folder，指定具体的路径，再看以下例子：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,render_template</span><br><span class="line"><span class="comment">#在C盘的templates文件夹中寻找模板文件。</span></span><br><span class="line">app = Flask(__name__,template_folder=<span class="string">r'C:\templates'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/about/'</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">about</span>():</span></span><br><span class="line">  <span class="comment">#要渲染一个模板，通过render_template方法即可</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'about.html'</span>)```</span><br></pre></td></tr></tbody></table></figure>
<h3 id="静态文件的配置"><a href="#静态文件的配置" class="headerlink" title="静态文件的配置"></a>静态文件的配置</h3><p>Web应用中会出现大量的静态文件来使得网页更加生动美观。类似于CSS样式文件、JavaScript脚本文件、图片文件、字体文件等静态资源。在Jinja中加载静态文件非常简单，只需要通过url_for全局函数就可以实现，看以下代码：</p>
<p><code>&lt;link href="{{ url_for('static',filename='about.css') }}"&gt;</code><br>url_for函数默认会在项目根目录下的static文件夹中寻找about.css文件，如果找到了，会生成一个相对于项目根目录下的/static/about.css路径。当然我们也可以把静态文件不放在static文件夹中，此时就需要具体指定了，看以下代码：</p>
<p><code>app = Flask(__name__,static_folder='C:\static')</code><br>那么访问静态文件的时候，将会到/static这个文件夹下寻找。</p>
<h3 id="模板变量"><a href="#模板变量" class="headerlink" title="模板变量"></a>模板变量</h3><p> 如果想要传递变量到模板中，那么可以把变量定义成字典，然后在<code>render_template</code>中，通过关键字参数的方式传递过去。<code>render_template('',**context)</code>。<br>代码中传入字符串，列表，字典到模板中</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/'</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="comment"># 往模板中传入的数据</span></span><br><span class="line">    my_str = <span class="string">'Hello Word'</span></span><br><span class="line">    my_int = <span class="number">10</span></span><br><span class="line">    my_array = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line">    my_dict = {</span><br><span class="line">        <span class="string">'name'</span>: <span class="string">'xiaoming'</span>,</span><br><span class="line">        <span class="string">'age'</span>: <span class="number">18</span></span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'hello.html'</span>,</span><br><span class="line">                           my_str=my_str,</span><br><span class="line">                           my_int=my_int,</span><br><span class="line">                           my_array=my_array,</span><br><span class="line">                           my_dict=my_dict</span><br><span class="line">                           )</span><br></pre></td></tr></tbody></table></figure>

<p>模板中代码</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  我的模板html内容</span><br><span class="line">  <span class="tag">&lt;<span class="name">br</span> /&gt;</span>{{ my_str }}</span><br><span class="line">  <span class="tag">&lt;<span class="name">br</span> /&gt;</span>{{ my_int }}</span><br><span class="line">  <span class="tag">&lt;<span class="name">br</span> /&gt;</span>{{ my_array }}</span><br><span class="line">  <span class="tag">&lt;<span class="name">br</span> /&gt;</span>{{ my_dict }}</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>



<h3 id="Jinja2模版概述"><a href="#Jinja2模版概述" class="headerlink" title="Jinja2模版概述"></a>Jinja2模版概述</h3><figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">1. <span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">2. <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">3.    <span class="tag">&lt;<span class="name">title</span>&gt;</span>My Webpage<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">4. <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">5. <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">6.     <span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"navigation"</span>&gt;</span></span><br><span class="line">7.     {% for item in navigation %}</span><br><span class="line">8.         <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"{{ item.href }}"</span>&gt;</span>{{ item.caption }}<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">9.     {% endfor %}</span><br><span class="line">10.    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">11.</span><br><span class="line">12.    {{ a_variable }}</span><br><span class="line">13.    {{ user.name }}</span><br><span class="line">14.    {{ user['name'] }}</span><br><span class="line">15.</span><br><span class="line">16.    {# a comment #}</span><br><span class="line">17. <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">18.<span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>以上示例有需要进行解释：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> 第12~14行的{{ ... }}：用来装载一个变量，模板渲染的时候，会把这个变量代表的值替换掉。并且可以间接访问一个变量的属性或者一个字典的key。关于点.号访问和[]中括号访问，没有任何区别，都可以访问属性和字典的值。</span><br><span class="line">  第7~9行的{% ... %}：用来装载一个控制语句，以上装载的是for循环，</span><br><span class="line">  第14行的{# ... #}：用来装载一个注释，模板渲染的时候会忽视这中间的值。</span><br><span class="line"></span><br><span class="line">二、属性访问规则：</span><br><span class="line">比如在模板中有一个变量这样使用：foo.bar，那么在Jinja2中是这样进行访问的：</span><br><span class="line"></span><br><span class="line">先去查找foo的bar这个属性，也即通过getattr(foo,'bar')。</span><br><span class="line">如果没有，就去通过foo.__getitem__('bar')的方式进行查找。</span><br><span class="line">如果以上两种方式都没有找到，返回一个undefined。</span><br><span class="line">在模板中有一个变量这样使用：foo['bar']，那么在Jinja2中是这样进行访问：</span><br><span class="line"></span><br><span class="line">通过foo.__getitem__('bar')的方式进行查找。</span><br><span class="line">如果没有，就通过getattr(foo,'bar')的方式进行查找。</span><br><span class="line">如果以上没有找到，则返回一个undefined。</span><br></pre></td></tr></tbody></table></figure>

<h3 id="模版过滤器"><a href="#模版过滤器" class="headerlink" title="模版过滤器"></a>模版过滤器</h3><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">Jinja2模版过滤器相当于是一个函数，把当前的变量传入到过滤器中，然后过滤器根据自己的功能，再返回相应的值，之后再将结果渲染到页面中。在html中使用，{{  }}</span><br><span class="line">过滤器是通过管道符号（|）进行使用的，例如：{{ name|length }}，将返回name的长度。</span><br><span class="line"></span><br><span class="line">Jinja2中内置了许多过滤器，在这里可以看到所有的过滤器，现对一些常用的过滤器进行讲解：</span><br><span class="line"></span><br><span class="line">abs(value)：返回一个数值的绝对值。 例如：-1|abs。</span><br><span class="line"></span><br><span class="line">default(value,default_value,boolean=false)：如果当前变量没有值，则会使用参数中的值来代替。name|default('xiaotuo')——如果name不存在，则会使用xiaotuo来替代。boolean=False默认是在只有这个变量为undefined的时候才会使用default中的值，如果想使用python的形式判断是否为false，则可以传递boolean=true。也可以使用or来替换。</span><br><span class="line"></span><br><span class="line">escape(value)或e：转义字符，会将&lt;、&gt;等符号转义成HTML中的符号。例如：content|escape或content|e。</span><br><span class="line"></span><br><span class="line">first(value)：返回一个序列的第一个元素。names|first。</span><br><span class="line"></span><br><span class="line">format(value,*arags,**kwargs)：格式化字符串。例如以下代码：</span><br><span class="line"></span><br><span class="line">`{{ "%s" - "%s"|format('Hello?',"Foo!") }}`</span><br><span class="line">将输出：Helloo? - Foo!</span><br><span class="line"></span><br><span class="line">last(value)：返回一个序列的最后一个元素。示例：names|last。</span><br><span class="line"></span><br><span class="line">length(value)：返回一个序列或者字典的长度。示例：names|length。</span><br><span class="line"></span><br><span class="line">join(value,d=u'')：将一个序列用d这个参数的值拼接成字符串。</span><br><span class="line"></span><br><span class="line">safe(value)：如果开启了全局转义，那么safe过滤器会将变量关掉转义。示例：content_html|safe。</span><br><span class="line"></span><br><span class="line">int(value)：将值转换为int类型。</span><br><span class="line"></span><br><span class="line">float(value)：将值转换为float类型。</span><br><span class="line"></span><br><span class="line">lower(value)：将字符串转换为小写。</span><br><span class="line"></span><br><span class="line">upper(value)：将字符串转换为小写。</span><br><span class="line"></span><br><span class="line">replace(value,old,new)： 替换将old替换为new的字符串。</span><br><span class="line"></span><br><span class="line">truncate(value,length=255,killwords=False)：截取length长度的字符串。</span><br><span class="line"></span><br><span class="line">striptags(value)：删除字符串中所有的HTML标签，如果出现多个空格，将替换成一个空格。</span><br><span class="line"></span><br><span class="line">trim：截取字符串前面和后面的空白字符。</span><br><span class="line"></span><br><span class="line">string(value)：将变量转换成字符串。</span><br><span class="line"></span><br><span class="line">wordcount(s)：计算一个长字符串中单词的个数。</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<h3 id="flask模版继承"><a href="#flask模版继承" class="headerlink" title="flask模版继承"></a>flask模版继承</h3><p>一个系统网站往往需要统一的结构，这样看起来比较“整洁”。<br>比如说，一个页面中都有标题、内容显示、底部等几个部分。如果在每一个网页中都进行这几部分的编写，那么这个网站将会有很多冗余部分，这时可以采用模板继承，即将相同的部分提取出来，形成一个base.html，具有这些相同部分的网页通过继承base.html来得到对应的模块。</p>
<p>基本模板直接在templates目录中，蓝图的模板将放置在与蓝图同名的目录中。例如：flaskr/templates/auth/register.html</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">{% extends "base.html" %}</span><br><span class="line"></span><br><span class="line">{% block 模板名称 %}</span><br><span class="line">    ....</span><br><span class="line">{% endblock %}</span><br></pre></td></tr></tbody></table></figure>


<p>base.html作为基类（父模块），index.html和product.html文件作为子类（子模块），子类去继承基类的基本内容。</p>
<p>base.html文件内容如下：</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>{% block title %}{% endblock %} -我的网站<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">{% block body %}</span><br><span class="line">    这是基类（base.html）中的内容</span><br><span class="line">{% endblock %}</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>子模版</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">{% extends "base.html" %}</span><br><span class="line"></span><br><span class="line">{% block title %}产品列表页{% endblock %}</span><br><span class="line"></span><br><span class="line">{% block body %}</span><br><span class="line"><span class="tag">&lt;<span class="name">h4</span>&gt;</span>这是产品列表页（product.html）的内容！<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">获取网页标题内容：<span class="tag">&lt;<span class="name">h4</span>&gt;</span>{{ self.title() }}<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">{% endblock %}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>




<h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><p><a target="_blank" rel="noopener" href="https://flask.palletsprojects.com/en/2.1.x/config/#configuration-basics">所有的内置配置项</a><br>在Flask项目中，有四种方式进行项目的配置：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过加载模块的方式进行配置</span></span><br><span class="line"><span class="comment"># 1. 通过模块字符串</span></span><br><span class="line">app.config.from_object(<span class="string">'settings'</span>)</span><br><span class="line"><span class="comment"># 2. 通过模块对象</span></span><br><span class="line"><span class="keyword">import</span> settings</span><br><span class="line">app.config.from_object(settings)</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过app.config对象来进行配置</span></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">'SECRET_KEY'</span>] = <span class="string">"xxx"</span></span><br></pre></td></tr></tbody></table></figure>



<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 因为app.config是flask.config.Config的实例，而Config类是继承自dict，因此可以通过update方法：</span></span><br><span class="line"></span><br><span class="line">app.config.update(</span><br><span class="line">   DEBUG=<span class="literal">True</span>,</span><br><span class="line">   SECRET_KEY=<span class="string">'...'</span></span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># app.config.from_pyfile()，该方法传入一个文件名，通常是以.py结尾的文件，但也不限于只使用.py后缀的文件：</span></span><br><span class="line">app.config.from_pyfile(<span class="string">'settings.py'</span>,silent=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># silent=True表示如果配置文件不存在的时候不抛出异常，默认是为False，会抛出异常。</span></span><br></pre></td></tr></tbody></table></figure>
<h2 id="蓝图技术"><a href="#蓝图技术" class="headerlink" title="蓝图技术"></a>蓝图技术</h2><p>蓝图技术(BluePrint )，可以帮助你实现flask应用的模块划分,一个模块拥有一个属于自己的文件目录，与之相关的代码都将写在这里</p>
<p>它是一个存储视图方法的集合，Flask 程序通过 Blueprint 来组织 URL 以及处理请求。</p>
<h3 id="功能式架构"><a href="#功能式架构" class="headerlink" title="功能式架构"></a>功能式架构</h3><p>按照 功能结构 组织。模板在一个文件夹中，静态文件在另外一个文件夹中，视图在第三个文件夹中。<br>如果应用的组件之间联系较为紧密，则建议使用功能式架构。<br>project/<br>  forms/<br>    myform.py<br>    …<br>  models/<br>    <strong>init</strong>.py<br>    mymodel.py<br>    …<br>  routes/<br>    <strong>init</strong>.py<br>    myroute.py<br>    …<br>  static/<br>    …<br>  services/<br>    <strong>init</strong>.py<br>    …<br>  templates/<br>    index.html<br>    …<br>  <strong>init</strong>.py<br>  config.py<br>  manage.py</p>
<p>forms(表单): 存放表单对象<br>models(模型): 存放数据模型，即库表在程序中的映射对象，以及对象之间的关系<br>routes(路由): 存放请求路由以及处理逻辑<br>static(静态文件): flask约定存放静态文件的目录<br>templates(模板): flask约定存放页面模板的目录<br>services(服务): 存放业务逻辑或者其他服务类功能<br>init.py: flask app初始化方法<br>config.py: 项目配置文件<br>manage.py: 启动一个开发服务器，但是不会在生产环境中用到</p>
<h3 id="分区式架构"><a href="#分区式架构" class="headerlink" title="分区式架构"></a>分区式架构</h3><p>基于应用的结构<br>如果应用是由独立的且仅仅共享模型和配置的各组件组成，建议选择分区式；<br>按照基于应用组织。同一个功能的模板，静态文件，视图都在一个文件夹内。<br>project/<br>  <strong>init</strong>.py<br>  db.py<br>  auth/<br>    <strong>init</strong>.py<br>    route.py<br>    models.py<br>    templates/<br>    static/<br>  blog/<br>    <strong>init</strong>.py<br>    route.py<br>    models.py<br>    templates/<br>    static/<br>…<br>每个目录都对应一个应用。Django 默认是使用这种方式来组织目录。当然这并不意味该方式是很好的，你需要按照项目来选择目录结构。某些时候，你将不得不使用一个混合模式。</p>
<h3 id="使用蓝图步骤"><a href="#使用蓝图步骤" class="headerlink" title="使用蓝图步骤"></a>使用蓝图步骤</h3><h4 id="1-创建一个蓝图对象"><a href="#1-创建一个蓝图对象" class="headerlink" title="1.创建一个蓝图对象"></a>1.创建一个蓝图对象</h4><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># user/__init__.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Blueprint</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个蓝图对象</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">参数1：蓝图名字</span></span><br><span class="line"><span class="string">2.模块名</span></span><br><span class="line"><span class="string">3.蓝图前缀</span></span><br><span class="line"><span class="string">4.template_folder :设置模板目录;蓝图对象默认的模板目录为系统的模版目录,如果存在同名模板文件,则系统会优先使用 系统的模版目录中的文件</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">bp = Blueprint(<span class="string">'user'</span>,__name__,url_prefix=<span class="string">'/user/'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@bp.route(<span class="params"><span class="string">'/'</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">"用户首页"</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@bp.route(<span class="params"><span class="string">'profile/'</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">profile</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">"个人简介"</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>




<h4 id="2-主程序上注册这个蓝图对象"><a href="#2-主程序上注册这个蓝图对象" class="headerlink" title="2.主程序上注册这个蓝图对象"></a>2.主程序上注册这个蓝图对象</h4><p>然后我们在主程序中，通过app.register_blueprint()方法将这个蓝图注册进url映射中，看下主app的实现：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">import</span> user</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.register_blueprint(user.bp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>,port=<span class="number">9000</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>以后访问/user/，/user/profile/，都是执行的user.py文件中的视图函数，这样就实现了项目的模块化。</p>
<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><h4 id="1-1-寻找静态文件："><a href="#1-1-寻找静态文件：" class="headerlink" title="1.1. 寻找静态文件："></a>1.1. 寻找静态文件：</h4><p>默认不设置任何静态文件路径，Jinja2会在项目的static文件夹中寻找静态文件。也可以设置其他的路径，在初始化蓝图的时候，Blueprint这个构造函数，有一个参数static_folder可以指定静态文件的路径，如：</p>
<p><code>bp = Blueprint('admin',__name__,url_prefix='/admin',static_folder='static')</code><br>static_folder可以是相对路径（相对蓝图文件所在的目录），也可以是绝对路径。在配置完蓝图后，还有一个需要注意的地方是如何在模板中引用静态文件。在模板中引用蓝图，应该要使用蓝图名+.+static来引用，如下所示：</p>
<p><code>  &lt;link href="{{ url_for('admin.static',filename='about.css') }}"&gt;</code></p>
<h4 id="1-2-寻找模板文件："><a href="#1-2-寻找模板文件：" class="headerlink" title="1.2. 寻找模板文件："></a>1.2. 寻找模板文件：</h4><p>跟静态文件一样，默认不设置任何模板文件的路径，将会在项目的templates中寻找模板文件。也可以设置其他的路径，在构造函数Blueprint中有一个template_folder参数可以设置模板的路径，如下所示：</p>
<p><code>bp = Blueprint('admin',__name__,url_prefix='/admin',template_folder='templates')</code><br>模板文件和静态文件有点区别，以上代码写完以后，如果你渲染一个模板return render_template(‘admin.html’)，Flask默认会去项目根目录下的templates文件夹中查找admin.html文件，如果找到了就直接返回，如果没有找到，才会去蓝图文件所在的目录下的templates文件夹中寻找。</p>
<h4 id="1-3-url-for生成url："><a href="#1-3-url-for生成url：" class="headerlink" title="1.3. url_for生成url："></a>1.3. url_for生成url：</h4><p>用url_for生成蓝图的url，使用的格式是：蓝图名称+.+视图函数名称。比如要获取admin这个蓝图下的index视图函数的url，应该采用以下方式：</p>
<p><code>url_for('admin.index')</code><br>其中这个蓝图名称是在创建蓝图的时候，传入的第一个参数。bp = Blueprint(‘admin’,<strong>name</strong>,url_prefix=’/admin’,template_folder=’templates’)</p>
<h3 id="组织扩展-Extensions"><a href="#组织扩展-Extensions" class="headerlink" title="组织扩展(Extensions)"></a>组织扩展(Extensions)</h3><p>一般推荐将所有扩展在app/extensions.py中进行实例化，如以下代码：</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## app/extensions.py</span></span><br><span class="line"><span class="keyword">from</span> flask_bootstrap <span class="keyword">import</span> Bootstrap</span><br><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line"><span class="keyword">from</span> flask_login <span class="keyword">import</span> LoginManager</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">bootstrap = Bootstrap()</span><br><span class="line">db = SQLAlchemy()</span><br><span class="line">login_manager = LoginManager()</span><br><span class="line">login_manager.login_view = <span class="string">'auth_bp.login'</span></span><br></pre></td></tr></tbody></table></figure>
<p>然后在实例化Flask时，进行绑定：</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## app/__init__.py</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> config <span class="keyword">import</span> config</span><br><span class="line"><span class="keyword">from</span> app.extensions <span class="keyword">import</span> bootstrap, db, login_manager</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_app</span>(<span class="params">config_name</span>):</span></span><br><span class="line">    app = Flask(__name__)</span><br><span class="line">    app.config.from_object(config[config_name])</span><br><span class="line">    config[config_name].init_app(app)</span><br><span class="line"></span><br><span class="line">    bootstrap.init_app(app)</span><br><span class="line">    db.init_app(app)</span><br><span class="line">    login_manager.init_app(app)</span><br><span class="line"></span><br><span class="line">    <span class="comment">## register blueprint</span></span><br><span class="line">    <span class="keyword">from</span> .main <span class="keyword">import</span> main_bp</span><br><span class="line">    app.register_blueprint(main_bp)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span> .auth <span class="keyword">import</span> auth_bp <span class="keyword">as</span> auth_blueprint</span><br><span class="line">    app.register_blueprint(auth_blueprint)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span> .api <span class="keyword">import</span> api_bp <span class="keyword">as</span> api_blueprint</span><br><span class="line">    app.register_blueprint(api_blueprint, url_prefix=<span class="string">'/api'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> app</span><br></pre></td></tr></tbody></table></figure>

<h3 id="子域名"><a href="#子域名" class="headerlink" title="子域名"></a>子域名</h3><p>子域名在许多网站中都用到了，比如一个网站叫做xxx.com，那么我们可以定义一个子域名cms.xxx.com来作为cms管理系统的网址，子域名的实现一般也是通过蓝图来实现，在之前章节中，我们创建蓝图的时候添加了一个url_prefix=/user作为url前缀，那样我们就可以通过/user/来访问user下的url。但使用子域名则不需要。另外，还需要配置SERVER_NAME，比如app.config[SERVER_NAME]=’example.com:9000’。并且在注册蓝图的时候，还需要添加一个subdomain的参数，这个参数就是子域名的名称，先来看一下蓝图的实现(admin.py)：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Blueprint</span><br><span class="line">bp = Blueprint(<span class="string">'admin'</span>,__name__,subdomain=<span class="string">'admin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@bp.route(<span class="params"><span class="string">'/'</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">admin</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'Admin Page'</span></span><br></pre></td></tr></tbody></table></figure>

<p>这个没有多大区别，接下来看主app的实现：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">import</span> admin</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置`SERVER_NAME`</span></span><br><span class="line">app.config[<span class="string">'SERVER_NAME'</span>] = <span class="string">'example.com:8000'</span></span><br><span class="line"><span class="comment"># 注册蓝图，指定了subdomain</span></span><br><span class="line">app.register_blueprint(admin.bp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>,port=<span class="number">8000</span>,debug=<span class="literal">True</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>写完以上两个文件后，还是不能正常的访问admin.example.com:8000这个子域名，因为我们没有在host文件中添加域名解析，你可以在最后添加一行127.0.0.1 admin.example.com，就可以访问到了。另外，子域名不能在127.0.0.1上出现，也不能在localhost上出现。</p>
<h2 id="request和reposr对象"><a href="#request和reposr对象" class="headerlink" title="request和reposr对象"></a>request和reposr对象</h2><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## request 封装了请求消息，可以获取请求的各种参数。</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment">## 定义处理路径 /login 的函数 login，装饰器 @app.route(’/login’, methods = [‘GET’]) 表示使用 GET 方法处理路径 /login 的请求。</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/login'</span>, methods = [<span class="string">'GET'</span>]</span>)</span></span><br><span class="line"><span class="comment">## 函数 login 返回一段用于登录的 HTML 表单，表单包括 2 个字段: name 和 password。在第 4 行，指定使用 POST 方法提交表单给服务端的 /check_login 页面。</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'''</span></span><br><span class="line"><span class="string">&lt;form action="/check_login" method="POST"&gt;</span></span><br><span class="line"><span class="string">  &lt;p&gt;&lt;input type="text" name="name"/&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">  &lt;p&gt;&lt;input type="password" name="password"/&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">  &lt;p&gt;&lt;input type="submit" value="submit"/&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 使用 POST 方法处理路径 /check_login 的请求。</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/check_login'</span>, methods = [<span class="string">'POST'</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_login</span>():</span></span><br><span class="line">    name = request.form[<span class="string">'name'</span>]</span><br><span class="line">    password = request.form[<span class="string">'password'</span>]</span><br><span class="line">    <span class="keyword">if</span> name == <span class="string">'guest'</span> <span class="keyword">and</span> password == <span class="string">'123'</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'Login succeed'</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'Login failed'</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>





<h2 id="setting-py"><a href="#setting-py" class="headerlink" title="setting.py"></a>setting.py</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#app.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> setting</span><br><span class="line">app.config.from_object(setting)   <span class="comment">#导入配置文件</span></span><br></pre></td></tr></tbody></table></figure>











<h2 id="一键安装依赖包"><a href="#一键安装依赖包" class="headerlink" title="一键安装依赖包"></a>一键安装依赖包</h2><p>##requirements.txt 用来记录项目所有的依赖包和版本号<br>pip freeze &gt; requirements.txt</p>
<p>##一次性安装 requirements.txt 里面所有的依赖包，<br>pip install -r requirements.txt</p>
<h2 id="abort函数返回异常"><a href="#abort函数返回异常" class="headerlink" title="abort函数返回异常"></a>abort函数返回异常</h2><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, make_response,json,request,render_template,abort</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/index'</span>,methods=[<span class="string">'GET'</span>,<span class="string">'POST'</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">  <span class="keyword">if</span> request.method == <span class="string">'GEt'</span>:</span><br><span class="line">      <span class="comment">##渲染模板</span></span><br><span class="line">      <span class="keyword">return</span> render_template(<span class="string">'index.html'</span>)</span><br><span class="line">  <span class="keyword">if</span>  request.method == <span class="string">'POST'</span>:</span><br><span class="line">      name = request.form.get(<span class="string">'name'</span>)</span><br><span class="line">      password  = request.form.get(<span class="string">'password'</span>)</span><br><span class="line">      <span class="keyword">if</span> name == <span class="string">'zhangsan'</span> <span class="keyword">and</span> password==<span class="string">'123'</span>:</span><br><span class="line">          <span class="keyword">return</span> <span class="string">'login success'</span></span><br><span class="line">      <span class="keyword">else</span>:</span><br><span class="line">          abort(<span class="number">404</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(debug = <span class="literal">True</span>)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="返回json数据给前端"><a href="#返回json数据给前端" class="headerlink" title="返回json数据给前端"></a>返回json数据给前端</h2><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, make_response,json</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/index'</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    data = {</span><br><span class="line">        <span class="string">'name'</span>:<span class="string">'张三'</span>    </span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> make_response(json.dumps(data,ensure_ascii=<span class="literal">False</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(debug = <span class="literal">True</span>) </span><br></pre></td></tr></tbody></table></figure>



<h1 id="Flask结合Bootstrap框架"><a href="#Flask结合Bootstrap框架" class="headerlink" title="Flask结合Bootstrap框架"></a>Flask结合Bootstrap框架</h1><p>pip install flask-bootstrap</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入bootstrap并进行初始化</span></span><br><span class="line"><span class="keyword">from</span> flask_bootstrap <span class="keyword">import</span> Bootstrap</span><br><span class="line">bootstrap=Bootstrap()</span><br></pre></td></tr></tbody></table></figure>


<h1 id="flask扩展"><a href="#flask扩展" class="headerlink" title="flask扩展"></a>flask扩展</h1><p>Flask扩展是一个Python模块，它向Flask应用程序添加了特定类型的支持。</p>
<p>Flask Extension Registry（Flask扩展注册表）是一个可用的扩展目录。</p>
<p>Flask常用扩展包：<br>Flask-SQLalchemy：操作数据库；</p>
<p>Flask-script：插入脚本；</p>
<p>Flask-migrate：管理迁移数据库；</p>
<p>Flask-Session：Session存储方式指定；</p>
<p>Flask-WTF：表单；</p>
<p>Flask-Mail：邮件；</p>
<p>Flask-Bable：提供国际化和本地化支持，翻译；</p>
<p>Flask-Login：认证用户状态；</p>
<p>Flask-OpenID：认证；</p>
<p>Flask-RESTful：开发REST API的工具；</p>
<p>Flask-Bootstrap：集成前端Twitter Bootstrap框架；</p>
<p>Flask-Moment：本地化日期和时间；</p>
<p>Flask-Admin：简单而可扩展的管理接口的框架</p>
<p>每种类型的扩展通常提供有关其用法的大量文档。</p>
<p>由于扩展是一个Python模块，因此需要导入它才能使用它。</p>
<p>Flask 的扩展通常命名为“ Flask-Foo ”或者“ Foo-Flask ” 。可以在 PyPI 搜索 标记为 <a target="_blank" rel="noopener" href="https://pypi.org/search/?c=Framework+::+Flask">Framework :: Flask</a> 扩展包。</p>
<h2 id="命令行控制启动"><a href="#命令行控制启动" class="headerlink" title="命令行控制启动"></a>命令行控制启动</h2><p>安装<br><code>pip install flask-script</code></p>
<p>使用</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入类库</span></span><br><span class="line"><span class="keyword">from</span> flask_script <span class="keyword">import</span> Manager</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"><span class="comment"># 创建对象</span></span><br><span class="line">manager = Manager(app)</span><br><span class="line"><span class="comment"># 启动程序</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	<span class="comment"># app.run()</span></span><br><span class="line">	<span class="comment"># 命令行控制启动</span></span><br><span class="line">	manager.run()</span><br></pre></td></tr></tbody></table></figure>
<p>参数：</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">启动：python manager.py runserver [-d] [-r]</span><br><span class="line">-? &amp; --help 查看帮助</span><br><span class="line">-d 			开启调试模式</span><br><span class="line">-r			修改文件自动加载</span><br><span class="line">-h --host	指定主机</span><br><span class="line">-p --port	指定端口</span><br><span class="line">--threaded	使用多线程	  </span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>


<h2 id="Flask-SQLAlchemy库"><a href="#Flask-SQLAlchemy库" class="headerlink" title="Flask-SQLAlchemy库"></a>Flask-SQLAlchemy库</h2><p><strong>SQLAlchemy</strong> 是 Python 中一个通过 ORM 操作数据库的框架。SQLAlchemy 对象关系映射器提供了一种方法，用于将用户定义的 Python 类与数据库表相关联，并将这些类实例与其对应表中的行相关联。SQLAlchemy 可以让开发者使用类和对象的方式操作数据库，从而从繁琐的 sql 语句中解脱出来。</p>
<p><strong>Flask-SQLAlchemy</strong>是对SQLAlchemy进行了一个简单的封装，使得我们在flask中使用sqlalchemy更加的简单。只能在flask中使用</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pip install  flask-sqlalchemy  # 安装</span><br><span class="line"><span class="meta">#</span><span class="bash">如果使用 mysql 数据库，还需要安装 mysqldb 驱动。</span></span><br><span class="line">pip install pymysql</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<h3 id="ORM-模型概念"><a href="#ORM-模型概念" class="headerlink" title="ORM 模型概念"></a>ORM 模型概念</h3><p>对象 - 关系映射 (Object Relation Mapping) 模型<br>ORM 模型定义了关系数据库和对象的映射关系，使得访问数据库的代码简单清晰、易于维护。</p>
<table>
<thead>
<tr>
<th align="center">关系数据库中的概念</th>
<th align="center">面向对象中的概念</th>
</tr>
</thead>
<tbody><tr>
<td align="center">表</td>
<td align="center">类</td>
</tr>
<tr>
<td align="center">表记录</td>
<td align="center">对象</td>
</tr>
<tr>
<td align="center">字段</td>
<td align="center">属性</td>
</tr>
</tbody></table>
<p>假设关系数据库中存在一张表 Students，包括 sno、name 和 age 等字段，使用如下 SQL 语句进行创建：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> students(</span><br><span class="line">    sno <span class="type">VARCHAR</span>(<span class="number">255</span>),</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">255</span>),</span><br><span class="line">    age <span class="type">INT</span></span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>在 ORM 模型中，存在一个类 Student 与关系数据库中的表 students 相对应，代码如下所示：</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#类Student映射表students</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, sno, name, age</span>):</span></span><br><span class="line">  <span class="comment"># 属性 sno、name 和 age映射字段 sno、name 和 age</span></span><br><span class="line">        self.sno = sno</span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line"></span><br><span class="line"><span class="comment">#对象tom映射表students中的一条记录 </span></span><br><span class="line">tom = Student(<span class="string">'1918001'</span>, <span class="string">'tom'</span>, <span class="number">12</span>)        </span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<h3 id="数据库连接配置"><a href="#数据库连接配置" class="headerlink" title="数据库连接配置"></a>数据库连接配置</h3><table>
<thead>
<tr>
<th>配置选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>SQLALCHEMY_DATABASE_URI</td>
<td>连接数据库。示例：mysql://username:password@host/post/db?charset=utf-8</td>
</tr>
<tr>
<td>SQLALCHEMY_BINDS</td>
<td>一个将会绑定多种数据库的字典。 更多详细信息请看官文 绑定多种数据库.</td>
</tr>
<tr>
<td>SQLALCHEMY_ECHO</td>
<td>调试设置为true</td>
</tr>
<tr>
<td>SQLALCHEMY_POOL_SIZE</td>
<td>数据库池的大小，默认值为5。</td>
</tr>
<tr>
<td>SQLALCHEMY_POOL_TIMEOUT</td>
<td>连接超时时间</td>
</tr>
<tr>
<td>SQLALCHEMY_POOL_RECYCLE</td>
<td>自动回收连接的秒数。</td>
</tr>
<tr>
<td>SQLALCHEMY_MAX_OVERFLOW</td>
<td>控制在连接池达到最大值后可以创建的连接数。当这些额外的连接回收到连接池后将会被断开和抛弃。</td>
</tr>
<tr>
<td>SQLALCHEMY_TRACK_MODIFICATIONS</td>
<td>如果设置成 True (默认情况)，Flask-SQLAlchemy 将会追踪对象的修改并且发送信号。这需要额外的内存， 如果不必要的可以禁用它。</td>
</tr>
</tbody></table>
<p>dialect+driver://username:password@host:port/database?charset=utf8</p>
<ul>
<li> dialect是数据库的实现，比如MySQL、PostgreSQL、SQLite，并且转换成小写</li>
<li> driver是Python对应的驱动，如果不指定，会选择默认的驱动，比如MySQL的默认驱动是MySQLdb</li>
<li> username是连接数据库的用户名</li>
<li> password是连接数据库的密码</li>
<li> host是连接数据库的域名</li>
<li> port是数据库监听的端口号</li>
<li> database是连接哪个数据库的名字。</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">@file: config.py</span></span><br><span class="line"><span class="string">@author: wenke</span></span><br><span class="line"><span class="string">@software: PyCharm</span></span><br><span class="line"><span class="string">@time: 2022/7/19 11:23</span></span><br><span class="line"><span class="string">@Description: 数据库连接配置</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">DIALCT = <span class="string">"mysql"</span></span><br><span class="line">DRIVER = <span class="string">"pymysql"</span></span><br><span class="line">USERNAME = <span class="string">"root"</span></span><br><span class="line">PASSWORD = <span class="string">"root"</span></span><br><span class="line">HOST = <span class="string">"127.0.0.1"</span></span><br><span class="line">PORT = <span class="string">"3306"</span></span><br><span class="line">DATABASE = <span class="string">"bookdb"</span></span><br><span class="line"><span class="comment"># 定义数据库连接字符串DB_URI</span></span><br><span class="line">DB_URI = <span class="string">"{}+{}://{}:{}@{}:{}/{}?charset=utf8"</span>.<span class="built_in">format</span>(DIALCT,DRIVER,USERNAME,PASSWORD,HOST,PORT,DATABASE)</span><br><span class="line"></span><br><span class="line">SQLALCHEMY_DATABASE_URI = DB_URI</span><br><span class="line">SQLALCHEMY_TRACK_MODIFICATIONS = <span class="literal">False</span></span><br><span class="line">SQLALCHEMY_ECHO = <span class="literal">True</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="model对象循环引用"><a href="#model对象循环引用" class="headerlink" title="model对象循环引用"></a>model对象循环引用</h3><p>循环引用这个问题出现的原因是</p>
<p>数据库脚本和主视图脚本不写在同一个脚本，数据库对象class一起写在同一个脚本下，主视图脚本调用<br>数据库脚本需要先定义db对象才能创建，因为要继承db.Model和使用db.Column等操作<br>db对象的定义在主视图脚本，因为需要传入的app在主视图脚本，但是主视图脚本在最开始就要导入数据库脚本<br>因此造成主视图脚本在启动一开始就需要数据库脚本，但是数据库脚本在一开始就需要主视图脚本，导致报错<br>解决方案</p>
<p>将db对象的定义单独放在一个脚本，并且先不指定app<br>数据库定义单独写一个脚本，其中调用db脚本中的空db对象，先保证语法正确，调用合法<br>在主视图函数中调用db和数据库对象，调用db.init_app(app)将app填充给空db<br>代码实现如下：分别创建db脚本exts.py，数据库脚本models.py，主视图脚本app.py</p>
<h3 id="创建db对象"><a href="#创建db对象" class="headerlink" title="创建db对象"></a>创建db对象</h3><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">@file: exts.py</span></span><br><span class="line"><span class="string">@author: wenke</span></span><br><span class="line"><span class="string">@software: PyCharm</span></span><br><span class="line"><span class="string">@time: 2022/7/19 11:34</span></span><br><span class="line"><span class="string">@Description:创建一个第三方文件，来放db对象,因为当db放在app.py时，from models import User,会从models模型中导入模型类User，</span></span><br><span class="line"><span class="string">但是在models模型又需要导入db,这就会导致循环引用，所以把db放在exts.py中</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line"></span><br><span class="line">db = SQLAlchemy()</span><br></pre></td></tr></tbody></table></figure>

<h3 id="创建ORM模型类-建表-，并映射"><a href="#创建ORM模型类-建表-，并映射" class="headerlink" title="创建ORM模型类(建表)，并映射"></a>创建ORM模型类(建表)，并映射</h3><p>在定义模型的时候，可以不写__tablename__，那么flask_sqlalchemy会默认将类名小写化，然后映射成表名。<br>并且如果这个模型的名字用到了多个单词并且使用了驼峰命名法，那么会在多个单词之间使用下划线来进行连接，但是不推荐使用。（增强代码可读性，提高团队合作效率）app.config[‘SQLALCHEMY_TRACK_MODIFICATIONS’] = False</p>
<p><strong>映射模型到数据库表</strong>：使用Flask-SQLAlchemy所有的类都是继承自db.Model，并且所有的Column和数据类型也都成为db的一个属性。但是有个好处是不用写表名了，</p>
<p>Flask-SQLAlchemy会自动将类名小写化，然后映射成表名。写完类模型后，要将模型映射到数据库的表中，使用以下代码创建所有的表：<code>db.create_all()</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">@file: models.py</span></span><br><span class="line"><span class="string">@author: wenke</span></span><br><span class="line"><span class="string">@software: PyCharm</span></span><br><span class="line"><span class="string">@time: 2022/7/19 11:28 </span></span><br><span class="line"><span class="string">@Description: 模型类</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> exts <span class="keyword">import</span> db</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params">db.Model</span>):</span></span><br><span class="line">  <span class="comment"># 表示将类 Student 映射到数据库中的表 students。</span></span><br><span class="line">    __tablename__ = <span class="string">'students'</span></span><br><span class="line">    <span class="comment"># 将属性映射到表的字段</span></span><br><span class="line">    sno = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    name = db.Column(db.String(<span class="number">255</span>))</span><br><span class="line">    age = db.Column(db.Integer)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span>(<span class="params">db.Model</span>):</span></span><br><span class="line">    __tablename__ = <span class="string">"user"</span></span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer, primary_key=<span class="literal">True</span>, autoincrement=<span class="literal">True</span>)</span><br><span class="line">    username = db.Column(db.String(<span class="number">200</span>),nullable=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserExtension</span>(<span class="params">db.Model</span>):</span></span><br><span class="line">    __tablename__ = <span class="string">"user_extension"</span></span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer, primary_key=<span class="literal">True</span>, autoincrement=<span class="literal">True</span>)</span><br><span class="line">    school = db.Column(db.String(<span class="number">100</span>))</span><br><span class="line">    user_id = db.Column(db.Integer,db.ForeignKey(<span class="string">"user.id"</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># db.backref</span></span><br><span class="line">    <span class="comment"># 1. 在反向引用的时候，如果需要传递一些其他的参数，那么就需要用到这个函数，否则不需要使用，只要在relationship的backref参数上，设置反向引用的名称就可以了。</span></span><br><span class="line">    <span class="comment"># 2. uselist=False：代表反向引用的时候，不是一个列表，而是一个对象。</span></span><br><span class="line">    user = db.relationship(<span class="string">"User"</span>,backref=db.backref(<span class="string">"extension"</span>,uselist=<span class="literal">False</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Article</span>(<span class="params">db.Model</span>):</span></span><br><span class="line">    __tablename__ = <span class="string">"article"</span></span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer,primary_key=<span class="literal">True</span>,autoincrement=<span class="literal">True</span>)</span><br><span class="line">    title = db.Column(db.String(<span class="number">200</span>),nullable=<span class="literal">False</span>)</span><br><span class="line">    content = db.Column(db.Text,nullable=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 外键：</span></span><br><span class="line">    <span class="comment"># 1. 外键的数据类型一定要看，所引用的字段的类型</span></span><br><span class="line">    <span class="comment"># 2. db.ForeignKey("表名.字段名 ")</span></span><br><span class="line">    <span class="comment"># 3. 外键是属于数据库层面的，不推荐直接在ORM中使用</span></span><br><span class="line">    author_id = db.Column(db.Integer,db.ForeignKey(<span class="string">"user.id"</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># relationship：</span></span><br><span class="line">    <span class="comment"># 1. 第一个参数是模型的名字，必须要和模型的名字保持一致</span></span><br><span class="line">    <span class="comment"># 2. backref（back reference）：代表反向引用，代表对方访问我的时候的字段名称</span></span><br><span class="line">    author = db.relationship(<span class="string">"User"</span>,backref=<span class="string">"articles"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将模型映射到数据库</span></span><br><span class="line"><span class="comment">#db.create_all()         # 创建数据库表</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#db.drop_all()    # 删除数据库表：</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<h3 id="主程序中使用"><a href="#主程序中使用" class="headerlink" title="主程序中使用"></a>主程序中使用</h3><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#app.py</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">import</span> config</span><br><span class="line"><span class="keyword">from</span> models <span class="keyword">import</span> Book, Author</span><br><span class="line"><span class="keyword">from</span> exts <span class="keyword">import</span> db</span><br><span class="line"></span><br><span class="line">app.config.from_object(config)  <span class="comment"># 导入数据库连接配置</span></span><br><span class="line">db.init_app(app)  <span class="comment"># 初始化db,把db对象放到app中</span></span><br><span class="line"><span class="comment"># app.app_context()上下文</span></span><br><span class="line"><span class="keyword">with</span> app.app_context():</span><br><span class="line">    db.drop_all()  <span class="comment"># 删除表</span></span><br><span class="line">    db.create_all()  <span class="comment"># 创建数据库表</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">"/otm"</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">one_to_many</span>():</span></span><br><span class="line">  <span class="comment"># 插入数据进Article表</span></span><br><span class="line">    article1 = Article(title=<span class="string">"111"</span>,content=<span class="string">"xxx"</span>)</span><br><span class="line">    article2 = Article(title=<span class="string">"222"</span>, content=<span class="string">"yyy"</span>)</span><br><span class="line">    <span class="comment"># 插入数据进User表</span></span><br><span class="line">    user = User(username=<span class="string">"zhiliao"</span>)</span><br><span class="line"></span><br><span class="line">    article1.author = user</span><br><span class="line">    article2.author = user</span><br><span class="line">    db.session.add(article1,article2)</span><br><span class="line">    db.session.commit()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(user.articles)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"one to many数据操作成功"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">"/oto"</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">one_to_one</span>():</span></span><br><span class="line">   <span class="comment"># 插入数据进User表</span></span><br><span class="line">    user = User(username=<span class="string">"zhiliao"</span>)</span><br><span class="line">     <span class="comment"># 插入数据进UserExtension表</span></span><br><span class="line">    extension = UserExtension(school=<span class="string">"清华大学"</span>)</span><br><span class="line"></span><br><span class="line">    user.extension = extension</span><br><span class="line">    db.session.add(user)</span><br><span class="line">    db.session.commit()</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"one to one"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">"/article"</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">article_view</span>():</span></span><br><span class="line">    <span class="comment"># 1. 添加数据进Article表</span></span><br><span class="line">    article = Article(title=<span class="string">"钢铁是怎样炼成的"</span>,content=<span class="string">"xxx"</span>)</span><br><span class="line">    db.session.add(article)</span><br><span class="line">    <span class="comment"># 做一个提交操作</span></span><br><span class="line">    db.session.commit()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 查询数据</span></span><br><span class="line">    <span class="comment"># filter_by：返回一个类列表的对象</span></span><br><span class="line">    article = Article.query.filter_by(<span class="built_in">id</span>=<span class="number">1</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span>(article.title)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 修改数据</span></span><br><span class="line">    article = Article.query.filter_by(<span class="built_in">id</span>=<span class="number">1</span>)[<span class="number">0</span>]</span><br><span class="line">    article.content = <span class="string">"yyy"</span></span><br><span class="line">    db.session.commit()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4. 删除数据</span></span><br><span class="line">    Article.query.filter_by(<span class="built_in">id</span>=<span class="number">1</span>).delete()</span><br><span class="line">    db.session.commit()</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"数据操作成功"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/'</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello_world</span>():</span></span><br><span class="line">    <span class="comment"># 写一个测试代码来验证是否连接成功</span></span><br><span class="line">    engine = db.get_engine()</span><br><span class="line">    <span class="keyword">with</span> engine.connect() <span class="keyword">as</span> conn:</span><br><span class="line">        result = conn.execute(<span class="string">"select 1"</span>)</span><br><span class="line">        <span class="built_in">print</span>(result.fetchone())</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'Hello World!'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run()</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>






<h2 id="flask-migrate-数据库迁移"><a href="#flask-migrate-数据库迁移" class="headerlink" title="flask-migrate(数据库迁移)"></a>flask-migrate(数据库迁移)</h2><p>flask-migrate是基于Alembic进行的一个封装，并集成到Flask中，而所有的迁移操作其实都是Alembic做的，在开发过程中，需要修改数据库模型，比如新增字段，修改字段类型，重命名等,而且还要在修改之后更新数据库。由于db.create_all()只能在表不存在时生效，所以必须删除原表，创建新表从头开始，但这样会丢失数据。更好的解决办法是使用数据库迁移框架，它可以追踪数据库模式的变化，然后把变动应用到数据库中。</p>
<p>多数情况下 Flask-Migrate <code>pip install flask-migrate</code>是会和命令行工具插件 Flask-Script<code>pip install Flask-Script</code> 和数据库插件 flask_sqlalchemy 一起使用的</p>
<h3 id="使用步骤"><a href="#使用步骤" class="headerlink" title="使用步骤"></a>使用步骤</h3><p><strong>linux下</strong><br>flask db init  #创建迁移仓库<br>flask db migrate  # 创建迁移脚本<br>flask db upgrade  #更新数据库</p>
<p><strong>window下</strong>需要重写迁移脚本文件<br>(1) 编写数据库迁移脚本manager.py<br>(2) 准备好数据模型<br>(3) 执行迁移命名<br>首先编写迁移脚本manager.py，这个是固定写法</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask_migrate <span class="keyword">import</span> Migrate, MigrateCommand</span><br><span class="line"><span class="keyword">from</span> flask_script <span class="keyword">import</span> Manager</span><br><span class="line"><span class="keyword">from</span> main <span class="keyword">import</span> app, db</span><br><span class="line"></span><br><span class="line">migrate = Migrate(app, db)  <span class="comment"># 指定迁移的app和db</span></span><br><span class="line">manager = Manager(app)</span><br><span class="line">manager.add_command(<span class="string">'db'</span>, MigrateCommand)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    manager.run()</span><br></pre></td></tr></tbody></table></figure>


<h3 id="创建迁移仓库和迁移脚本"><a href="#创建迁移仓库和迁移脚本" class="headerlink" title="创建迁移仓库和迁移脚本"></a>创建迁移仓库和迁移脚本</h3><p>数据库迁移时，初始化命令只需要执行一次，如果在一开始发现执行有问题，需要重新初始化，要先删除 migrations 目录才行。如果已经执行迁移命令，需要重新初始化，要先删除 migrations 目录和到数据库中删除 alembic_version 表。</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">第一次运行迁移需要执行init命令，会在目录下新生成migrations目录，在目录下versions子目录下的py脚本记录了每次迁移的变化，</span></span><br><span class="line"><span class="meta">#</span><span class="bash">migrations 里面有一个 versions 文件夹，这个文件夹用于存放迁移脚本，执行迁移命令后会自动生成迁移脚本保存在里面。</span></span><br><span class="line"><span class="meta">#</span><span class="bash">env.py 是迁移环境的相关信息。</span></span><br><span class="line">python manager.py db init    #创建迁移仓库</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">python manage.py db migrate -m "first commit"</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------</span><br><span class="line"><span class="meta">#</span><span class="bash">执行 upgrade 命令后，会在数据库中创建一张 alembic_version 表，这张表是 Alembic 自动创建的，里面保存的是当前数据库的版本 id ，alembic_version 表不能删除，删除后就不能继续执行数据库迁移操作了，除非重新初始化。</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 同时，执行 upgrade 命令后，会根据代码中定义的模型类创建对应的表，表的字段与模型类中定义的一致。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果数据库中有其他表(没有对应模型类的表)，会被删除。，数据库迁移时最好使用一个新的数据库(不要与其他项目用同一个数据库)，避免造成数据丢失。</span></span><br><span class="line">python manager.py db upgrade #更新数据库</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h3 id="回退数据库"><a href="#回退数据库" class="headerlink" title="回退数据库"></a>回退数据库</h3><p>回退数据库时，需要指定回退版本号，由于版本号是随机字符串，为避免出错，建议先使用python3 db_database.py db history命令查看历史版本的具体版本号，然后复制具体版本号执行回退。</p>
<p>python3 db_database.py db downgrade 版本号</p>
<h2 id="Flask-WTF表单验证"><a href="#Flask-WTF表单验证" class="headerlink" title="Flask-WTF表单验证"></a>Flask-WTF表单验证</h2><p>在 Web 页面中，表单是一种常见的元素，表单包含有多个字段，通常字段的取值需要在一定的范围内，例如：QQ 注册时，名称不可以为空，密码的长度至少是 8 个字符,将表单提交给服务端处理时，服务端需要验证表单中的字段的取值是否符合要求。<br>Flask-WTF是简化了WTForms操作的一个第三方库。WTForms表单的两个主要功能是验证用户提交数据的合法性以及渲染模板。当然还包括一些其他的功能：CSRF保护，文件上传等。安装Flask-WTF默认也会安装WTForms，因此使用以下命令来安装Flask-WTF:</p>
<p><code>pip install flask-wtf</code></p>
<h1 id="flask-email邮箱使用"><a href="#flask-email邮箱使用" class="headerlink" title="flask-email邮箱使用"></a>flask-email邮箱使用</h1><h1 id="登录注册模块"><a href="#登录注册模块" class="headerlink" title="登录注册模块"></a>登录注册模块</h1><h2 id="flask-login"><a href="#flask-login" class="headerlink" title="flask-login"></a>flask-login</h2><p>管理已登录用户的用户会话</p>
<h2 id="werkzeug"><a href="#werkzeug" class="headerlink" title="werkzeug"></a>werkzeug</h2><p>计算密码散列值并进行核对</p>
<h2 id="itsdangerous"><a href="#itsdangerous" class="headerlink" title="itsdangerous"></a>itsdangerous</h2><p>生成并核对加密安全令牌</p>
<h1 id="部署到云服务器"><a href="#部署到云服务器" class="headerlink" title="部署到云服务器"></a>部署到云服务器</h1><p> 在pycharm中项目虚拟环境的终端运行<code>pip freeze &gt;requirements.txt</code></p>
<h1 id="出错"><a href="#出错" class="headerlink" title="出错"></a>出错</h1><p>AttributeError: module ‘time‘ has no attribute ‘clock‘的解决方法</p>
<p>主要原因是因为python3.8之后不支持clock了, 需要替换成 time.pref_counter() 替换就可以了</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cpmpat.py文件：</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> win32 <span class="keyword">or</span> jython:</span><br><span class="line">    time_func = time.clock</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    time_func = time.time</span><br><span class="line"></span><br><span class="line"><span class="comment">#改为：</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> win32 <span class="keyword">or</span> jython:</span><br><span class="line">    time_func = time.perf_counter()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    time_func = time.time</span><br></pre></td></tr></tbody></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://wenkex.gitee.io">wenke</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://wenkex.gitee.io/2022/031560473.html">https://wenkex.gitee.io/2022/031560473.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://wenkex.gitee.io" target="_blank">wenke</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/flask/">flask</a></div><div class="post_share"><div class="social-share" data-image="https://gitee.com/wenkex/blogimage/raw/master/infinity-3610308.jpg" data-sites="wechat,qq,facebook,twitter,weibo"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/031717083.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://gitee.com/wenkex/blogimage/raw/master/infinity-3610308.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">python爬虫学习</div></div></a></div><div class="next-post pull-right"><a href="/2022/031551719.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://gitee.com/wenkex/blogimage/raw/master/infinity-3610308.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">matlab学习</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://gitee.com/wenkex/blogimage/raw/master/favicon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">wenke</div><div class="author-info__description">专注于编程,分享生活,分享知识</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">35</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">31</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">13</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/wenkexia"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/wenkexia" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/1184664659@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title=""><i class="fa fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">备用网址:https://wenkex.gitee.io (速度更快)</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"><span class="toc-number">1.</span> <span class="toc-text">参考文章</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4"><span class="toc-number">2.</span> <span class="toc-text">步骤</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web%E5%89%8D%E7%BD%AE"><span class="toc-number">3.</span> <span class="toc-text">web前置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MVC%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.1.</span> <span class="toc-text">MVC模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WSGI-Python-Web-Server-Gateway-Interface"><span class="toc-number">3.2.</span> <span class="toc-text">WSGI(Python Web Server Gateway Interface)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP%E5%8D%8F%E8%AE%AE"><span class="toc-number">3.3.</span> <span class="toc-text">HTTP协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#reques%E8%AF%B7%E6%B1%82"><span class="toc-number">3.3.1.</span> <span class="toc-text">reques请求</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E8%A1%8C"><span class="toc-number">3.3.1.1.</span> <span class="toc-text">请求行</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#repose%E5%93%8D%E5%BA%94"><span class="toc-number">3.3.2.</span> <span class="toc-text">repose响应</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#flask"><span class="toc-number">4.</span> <span class="toc-text">flask</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#flask%E5%BA%94%E7%94%A8"><span class="toc-number">4.1.</span> <span class="toc-text">flask应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#app-route-%E8%B7%AF%E7%94%B1"><span class="toc-number">4.2.</span> <span class="toc-text">@app.route()路由</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E8%A7%84%E5%88%99"><span class="toc-number">4.2.1.</span> <span class="toc-text">变量规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%94%AF%E4%B8%80%E7%9A%84URL-%E9%87%8D%E5%AE%9A%E5%90%91%E8%A1%8C%E4%B8%BA"><span class="toc-number">4.2.2.</span> <span class="toc-text">唯一的URL&#x2F;重定向行为</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#URL-%E6%9E%84%E5%BB%BA"><span class="toc-number">4.2.3.</span> <span class="toc-text">URL 构建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B5%E9%9D%A2%E8%B7%B3%E8%BD%AC%E5%92%8C%E9%87%8D%E5%AE%9A%E5%90%91%EF%BC%9A"><span class="toc-number">4.2.4.</span> <span class="toc-text">页面跳转和重定向：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP-%E6%96%B9%E6%B3%95"><span class="toc-number">4.2.5.</span> <span class="toc-text">HTTP 方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Jinja%E6%A8%A1%E6%9D%BF"><span class="toc-number">4.3.</span> <span class="toc-text">Jinja模板</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Flask%E6%B8%B2%E6%9F%93Jinja%E6%A8%A1%E6%9D%BF"><span class="toc-number">4.3.1.</span> <span class="toc-text">Flask渲染Jinja模板</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">4.3.2.</span> <span class="toc-text">静态文件的配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E5%8F%98%E9%87%8F"><span class="toc-number">4.3.3.</span> <span class="toc-text">模板变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jinja2%E6%A8%A1%E7%89%88%E6%A6%82%E8%BF%B0"><span class="toc-number">4.3.4.</span> <span class="toc-text">Jinja2模版概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E7%89%88%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-number">4.3.5.</span> <span class="toc-text">模版过滤器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#flask%E6%A8%A1%E7%89%88%E7%BB%A7%E6%89%BF"><span class="toc-number">4.3.6.</span> <span class="toc-text">flask模版继承</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">4.4.</span> <span class="toc-text">配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%93%9D%E5%9B%BE%E6%8A%80%E6%9C%AF"><span class="toc-number">4.5.</span> <span class="toc-text">蓝图技术</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E5%BC%8F%E6%9E%B6%E6%9E%84"><span class="toc-number">4.5.1.</span> <span class="toc-text">功能式架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%8C%BA%E5%BC%8F%E6%9E%B6%E6%9E%84"><span class="toc-number">4.5.2.</span> <span class="toc-text">分区式架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%93%9D%E5%9B%BE%E6%AD%A5%E9%AA%A4"><span class="toc-number">4.5.3.</span> <span class="toc-text">使用蓝图步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E8%93%9D%E5%9B%BE%E5%AF%B9%E8%B1%A1"><span class="toc-number">4.5.3.1.</span> <span class="toc-text">1.创建一个蓝图对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E4%B8%BB%E7%A8%8B%E5%BA%8F%E4%B8%8A%E6%B3%A8%E5%86%8C%E8%BF%99%E4%B8%AA%E8%93%9D%E5%9B%BE%E5%AF%B9%E8%B1%A1"><span class="toc-number">4.5.3.2.</span> <span class="toc-text">2.主程序上注册这个蓝图对象</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F"><span class="toc-number">4.5.4.</span> <span class="toc-text">注意</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-%E5%AF%BB%E6%89%BE%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%EF%BC%9A"><span class="toc-number">4.5.4.1.</span> <span class="toc-text">1.1. 寻找静态文件：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-%E5%AF%BB%E6%89%BE%E6%A8%A1%E6%9D%BF%E6%96%87%E4%BB%B6%EF%BC%9A"><span class="toc-number">4.5.4.2.</span> <span class="toc-text">1.2. 寻找模板文件：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-url-for%E7%94%9F%E6%88%90url%EF%BC%9A"><span class="toc-number">4.5.4.3.</span> <span class="toc-text">1.3. url_for生成url：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E7%BB%87%E6%89%A9%E5%B1%95-Extensions"><span class="toc-number">4.5.5.</span> <span class="toc-text">组织扩展(Extensions)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E5%9F%9F%E5%90%8D"><span class="toc-number">4.5.6.</span> <span class="toc-text">子域名</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#request%E5%92%8Creposr%E5%AF%B9%E8%B1%A1"><span class="toc-number">4.6.</span> <span class="toc-text">request和reposr对象</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#setting-py"><span class="toc-number">4.7.</span> <span class="toc-text">setting.py</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E9%94%AE%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96%E5%8C%85"><span class="toc-number">4.8.</span> <span class="toc-text">一键安装依赖包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#abort%E5%87%BD%E6%95%B0%E8%BF%94%E5%9B%9E%E5%BC%82%E5%B8%B8"><span class="toc-number">4.9.</span> <span class="toc-text">abort函数返回异常</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%94%E5%9B%9Ejson%E6%95%B0%E6%8D%AE%E7%BB%99%E5%89%8D%E7%AB%AF"><span class="toc-number">4.10.</span> <span class="toc-text">返回json数据给前端</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Flask%E7%BB%93%E5%90%88Bootstrap%E6%A1%86%E6%9E%B6"><span class="toc-number">5.</span> <span class="toc-text">Flask结合Bootstrap框架</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#flask%E6%89%A9%E5%B1%95"><span class="toc-number">6.</span> <span class="toc-text">flask扩展</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%8E%A7%E5%88%B6%E5%90%AF%E5%8A%A8"><span class="toc-number">6.1.</span> <span class="toc-text">命令行控制启动</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Flask-SQLAlchemy%E5%BA%93"><span class="toc-number">6.2.</span> <span class="toc-text">Flask-SQLAlchemy库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ORM-%E6%A8%A1%E5%9E%8B%E6%A6%82%E5%BF%B5"><span class="toc-number">6.2.1.</span> <span class="toc-text">ORM 模型概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E9%85%8D%E7%BD%AE"><span class="toc-number">6.2.2.</span> <span class="toc-text">数据库连接配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#model%E5%AF%B9%E8%B1%A1%E5%BE%AA%E7%8E%AF%E5%BC%95%E7%94%A8"><span class="toc-number">6.2.3.</span> <span class="toc-text">model对象循环引用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAdb%E5%AF%B9%E8%B1%A1"><span class="toc-number">6.2.4.</span> <span class="toc-text">创建db对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAORM%E6%A8%A1%E5%9E%8B%E7%B1%BB-%E5%BB%BA%E8%A1%A8-%EF%BC%8C%E5%B9%B6%E6%98%A0%E5%B0%84"><span class="toc-number">6.2.5.</span> <span class="toc-text">创建ORM模型类(建表)，并映射</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E7%A8%8B%E5%BA%8F%E4%B8%AD%E4%BD%BF%E7%94%A8"><span class="toc-number">6.2.6.</span> <span class="toc-text">主程序中使用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flask-migrate-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB"><span class="toc-number">6.3.</span> <span class="toc-text">flask-migrate(数据库迁移)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4"><span class="toc-number">6.3.1.</span> <span class="toc-text">使用步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%BF%81%E7%A7%BB%E4%BB%93%E5%BA%93%E5%92%8C%E8%BF%81%E7%A7%BB%E8%84%9A%E6%9C%AC"><span class="toc-number">6.3.2.</span> <span class="toc-text">创建迁移仓库和迁移脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9E%E9%80%80%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">6.3.3.</span> <span class="toc-text">回退数据库</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Flask-WTF%E8%A1%A8%E5%8D%95%E9%AA%8C%E8%AF%81"><span class="toc-number">6.4.</span> <span class="toc-text">Flask-WTF表单验证</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#flask-email%E9%82%AE%E7%AE%B1%E4%BD%BF%E7%94%A8"><span class="toc-number">7.</span> <span class="toc-text">flask-email邮箱使用</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C%E6%A8%A1%E5%9D%97"><span class="toc-number">8.</span> <span class="toc-text">登录注册模块</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#flask-login"><span class="toc-number">8.1.</span> <span class="toc-text">flask-login</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#werkzeug"><span class="toc-number">8.2.</span> <span class="toc-text">werkzeug</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#itsdangerous"><span class="toc-number">8.3.</span> <span class="toc-text">itsdangerous</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2%E5%88%B0%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">9.</span> <span class="toc-text">部署到云服务器</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%87%BA%E9%94%99"><span class="toc-number">10.</span> <span class="toc-text">出错</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/081920764.html" title="nodejs学习">nodejs学习</a><time datetime="2022-08-19T07:39:35.000Z" title="发表于 2022-08-19 15:39:35">2022-08-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/062453983.html" title="题目集合">题目集合</a><time datetime="2022-06-24T00:00:27.000Z" title="发表于 2022-06-24 08:00:27">2022-06-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/051717870.html" title="计算机原理">计算机原理</a><time datetime="2022-05-17T03:07:09.000Z" title="发表于 2022-05-17 11:07:09">2022-05-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/050513105.html" title="正则表达式学习">正则表达式学习</a><time datetime="2022-05-05T00:53:39.000Z" title="发表于 2022-05-05 08:53:39">2022-05-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/042334747.html" title="数据库-SQLite">数据库-SQLite</a><time datetime="2022-04-23T08:35:42.000Z" title="发表于 2022-04-23 16:35:42">2022-04-23</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By wenke</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://butterfly.js.org/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'BbuBjGh9to6TtPug5KeFflx1-gzGzoHsz',
      appKey: '73XAE3zu9AokVhAvE61OP01g',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: true
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="true" data-text="虾,科,ke,xia" data-fontsize="15px" data-random="true" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e&&e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this);</script></body></html>